<?xml version="1.0" encoding="UTF-8"?>
<!-- Do not edit this file with editors other than draw.io -->
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" style="background: transparent; background-color: transparent; color-scheme: light dark;" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="1333px" height="2372px" viewBox="-0.5 -0.5 1333 2372" content="&lt;mxfile host=&quot;app.diagrams.net&quot; agent=&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/137.0.0.0 Safari/537.36&quot; version=&quot;27.1.4&quot;&gt;&#10;  &lt;diagram name=&quot;Page-1&quot; id=&quot;MYQSJNCdZhOi3zPZW-Wj&quot;&gt;&#10;    &lt;mxGraphModel dx=&quot;1840&quot; dy=&quot;2056&quot; grid=&quot;1&quot; gridSize=&quot;10&quot; guides=&quot;1&quot; tooltips=&quot;1&quot; connect=&quot;1&quot; arrows=&quot;1&quot; fold=&quot;1&quot; page=&quot;1&quot; pageScale=&quot;1&quot; pageWidth=&quot;850&quot; pageHeight=&quot;1100&quot; math=&quot;0&quot; shadow=&quot;0&quot;&gt;&#10;      &lt;root&gt;&#10;        &lt;mxCell id=&quot;0&quot; /&gt;&#10;        &lt;mxCell id=&quot;1&quot; parent=&quot;0&quot; /&gt;&#10;        &lt;mxCell id=&quot;sD_lDuidbchsZRyquxOI-35&quot; value=&quot;&quot; style=&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;&quot; vertex=&quot;1&quot; parent=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;60&quot; y=&quot;1363.73&quot; width=&quot;790&quot; height=&quot;716.27&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-1&quot; value=&quot;&quot; style=&quot;shape=partialRectangle;whiteSpace=wrap;html=1;top=0;left=0;fillColor=none;dashed=1;dashPattern=8 8;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;143.75&quot; y=&quot;-290&quot; width=&quot;126.25&quot; height=&quot;870&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-2&quot; value=&quot;&quot; style=&quot;ellipse;whiteSpace=wrap;html=1;rotation=-90;shadow=0;fillColor=#dae8fc;strokeColor=#6c8ebf;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;339.17999999999995&quot; y=&quot;152&quot; width=&quot;280&quot; height=&quot;270.82&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-3&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 18px;&amp;quot;&amp;gt;shell.exe&amp;lt;/font&amp;gt;&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;116.61&quot; y=&quot;40&quot; width=&quot;110&quot; height=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-4&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 18px;&amp;quot;&amp;gt;kernel32.dll&amp;lt;/font&amp;gt;&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;116.61&quot; y=&quot;110&quot; width=&quot;110&quot; height=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-5&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 18px;&amp;quot;&amp;gt;ntdll.dll&amp;lt;/font&amp;gt;&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;116.61&quot; y=&quot;180&quot; width=&quot;110&quot; height=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-6&quot; value=&quot;&quot; style=&quot;endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;&quot; parent=&quot;1&quot; source=&quot;tEqawAXD5UkgbRX-SCwM-3&quot; target=&quot;tEqawAXD5UkgbRX-SCwM-4&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry width=&quot;50&quot; height=&quot;50&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;400&quot; y=&quot;250&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;450&quot; y=&quot;200&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-7&quot; value=&quot;&amp;lt;b&amp;gt;ReadProcessMemory&amp;lt;/b&amp;gt;&quot; style=&quot;edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-6&quot; vertex=&quot;1&quot; connectable=&quot;0&quot;&gt;&#10;          &lt;mxGeometry x=&quot;-0.1371&quot; y=&quot;-1&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint as=&quot;offset&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-8&quot; value=&quot;&quot; style=&quot;endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;&quot; parent=&quot;1&quot; source=&quot;tEqawAXD5UkgbRX-SCwM-4&quot; target=&quot;tEqawAXD5UkgbRX-SCwM-5&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry width=&quot;50&quot; height=&quot;50&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;400&quot; y=&quot;250&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;450&quot; y=&quot;200&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-9&quot; value=&quot;&amp;lt;b&amp;gt;NtReadVirtualMemory&amp;lt;/b&amp;gt;&quot; style=&quot;edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-8&quot; vertex=&quot;1&quot; connectable=&quot;0&quot;&gt;&#10;          &lt;mxGeometry x=&quot;-0.0871&quot; y=&quot;-2&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint as=&quot;offset&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-10&quot; value=&quot;&quot; style=&quot;shape=internalStorage;whiteSpace=wrap;html=1;backgroundOutline=1;align=center;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;116.61&quot; y=&quot;390&quot; width=&quot;110&quot; height=&quot;110&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-11&quot; value=&quot;&quot; style=&quot;endArrow=classic;html=1;rounded=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;&quot; parent=&quot;1&quot; source=&quot;tEqawAXD5UkgbRX-SCwM-5&quot; target=&quot;tEqawAXD5UkgbRX-SCwM-10&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry width=&quot;50&quot; height=&quot;50&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;118&quot; y=&quot;210&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;115&quot; y=&quot;261&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-12&quot; value=&quot;&amp;lt;b&amp;gt;Syscall&amp;lt;/b&amp;gt;&quot; style=&quot;edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-11&quot; vertex=&quot;1&quot; connectable=&quot;0&quot;&gt;&#10;          &lt;mxGeometry x=&quot;-0.6685&quot; y=&quot;2&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;-2&quot; y=&quot;110&quot; as=&quot;offset&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-13&quot; value=&quot;Pointers&amp;amp;nbsp;&amp;lt;br&amp;gt;to the&amp;amp;nbsp;&amp;lt;br&amp;gt;corresponding&amp;amp;nbsp;&amp;lt;br&amp;gt;kernel&amp;lt;br&amp;gt;function&quot; style=&quot;text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;126.61&quot; y=&quot;410&quot; width=&quot;102.5&quot; height=&quot;90&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-14&quot; value=&quot;&amp;lt;b&amp;gt;&amp;lt;font style=&amp;quot;font-size: 14px;&amp;quot;&amp;gt;Nt!NtReadVirtualMemory&amp;lt;/font&amp;gt;&amp;lt;/b&amp;gt;&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;84.92&quot; y=&quot;530&quot; width=&quot;173.39&quot; height=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-15&quot; value=&quot;&quot; style=&quot;endArrow=classic;html=1;rounded=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;&quot; parent=&quot;1&quot; source=&quot;tEqawAXD5UkgbRX-SCwM-10&quot; target=&quot;tEqawAXD5UkgbRX-SCwM-14&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry width=&quot;50&quot; height=&quot;50&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;120&quot; y=&quot;430&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;118&quot; y=&quot;480&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-16&quot; value=&quot;&quot; style=&quot;endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;rounded=0;&quot; parent=&quot;1&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry width=&quot;50&quot; height=&quot;50&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;38.33&quot; y=&quot;610&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;38&quot; y=&quot;-160&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-17&quot; value=&quot;&quot; style=&quot;endArrow=none;html=1;rounded=0;&quot; parent=&quot;1&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry width=&quot;50&quot; height=&quot;50&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;10&quot; y=&quot;370&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;270&quot; y=&quot;370&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-18&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 14px;&amp;quot;&amp;gt;&amp;lt;b&amp;gt;User-Mode&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&quot; style=&quot;rounded=1;whiteSpace=wrap;html=1;rotation=-90;fillColor=#d5e8d4;strokeColor=#82b366;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;-48.12&quot; y=&quot;58.12&quot; width=&quot;132.5&quot; height=&quot;26.25&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-19&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 14px;&amp;quot;&amp;gt;&amp;lt;b&amp;gt;Kernel-mode&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&quot; style=&quot;rounded=1;whiteSpace=wrap;html=1;rotation=-90;fillColor=#f8cecc;strokeColor=#b85450;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;-41.87&quot; y=&quot;451.88&quot; width=&quot;116.25&quot; height=&quot;22.5&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-20&quot; value=&quot;&amp;lt;b&amp;gt;Syscall Table&amp;lt;/b&amp;gt;&quot; style=&quot;text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;139.11&quot; y=&quot;390&quot; width=&quot;90&quot; height=&quot;20&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-21&quot; value=&quot;&quot; style=&quot;shape=image;verticalLabelPosition=bottom;labelBackgroundColor=default;verticalAlign=top;aspect=fixed;imageAspect=0;image=data:image/png,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;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;60.18&quot; y=&quot;280&quot; width=&quot;83.57&quot; height=&quot;60&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-22&quot; value=&quot;&amp;lt;b&amp;gt;&amp;lt;u&amp;gt;&amp;lt;font style=&amp;quot;font-size: 14px;&amp;quot;&amp;gt;Syscall stub&amp;lt;/font&amp;gt;&amp;lt;/u&amp;gt;&amp;lt;/b&amp;gt;&quot; style=&quot;text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;43.750000000000014&quot; y=&quot;250&quot; width=&quot;110&quot; height=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-23&quot; value=&quot;&amp;lt;b&amp;gt;Win32 API&amp;lt;/b&amp;gt;&quot; style=&quot;ellipse;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;40&quot; y=&quot;115&quot; width=&quot;70&quot; height=&quot;20&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-24&quot; value=&quot;&amp;lt;b&amp;gt;NT API&amp;lt;/b&amp;gt;&quot; style=&quot;ellipse;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;40&quot; y=&quot;180&quot; width=&quot;70&quot; height=&quot;20&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-25&quot; value=&quot;&amp;lt;b&amp;gt;Functions start with Nt or Zw&amp;lt;/b&amp;gt;&quot; style=&quot;text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;40&quot; y=&quot;220&quot; width=&quot;98.76&quot; height=&quot;10&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-26&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 15px;&amp;quot;&amp;gt;User App&amp;lt;/font&amp;gt;&quot; style=&quot;text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;126.61000000000001&quot; y=&quot;10&quot; width=&quot;90&quot; height=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-27&quot; value=&quot;&amp;lt;span style=&amp;quot;font-size: 18px;&amp;quot;&amp;gt;EDR / AV&amp;lt;/span&amp;gt;&quot; style=&quot;whiteSpace=wrap;html=1;rounded=1;arcSize=50;align=center;verticalAlign=middle;strokeWidth=1;autosize=1;spacing=4;treeFolding=1;treeMoving=1;newEdgeStyle={&amp;quot;edgeStyle&amp;quot;:&amp;quot;entityRelationEdgeStyle&amp;quot;,&amp;quot;startArrow&amp;quot;:&amp;quot;none&amp;quot;,&amp;quot;endArrow&amp;quot;:&amp;quot;none&amp;quot;,&amp;quot;segment&amp;quot;:10,&amp;quot;curved&amp;quot;:1,&amp;quot;sourcePerimeterSpacing&amp;quot;:0,&amp;quot;targetPerimeterSpacing&amp;quot;:0};fillColor=#dae8fc;strokeColor=#6c8ebf;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;419.18&quot; y=&quot;230&quot; width=&quot;120&quot; height=&quot;40&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-28&quot; value=&quot;&quot; style=&quot;edgeStyle=entityRelationEdgeStyle;startArrow=none;endArrow=none;segment=10;curved=1;sourcePerimeterSpacing=0;targetPerimeterSpacing=0;rounded=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;fillColor=#dae8fc;strokeColor=#6c8ebf;&quot; parent=&quot;1&quot; source=&quot;tEqawAXD5UkgbRX-SCwM-5&quot; target=&quot;tEqawAXD5UkgbRX-SCwM-27&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;230&quot; y=&quot;180&quot; as=&quot;sourcePoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-29&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 17px;&amp;quot;&amp;gt;Often Hooked&amp;lt;br&amp;gt;(inline hooking)&amp;lt;/font&amp;gt;&quot; style=&quot;edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-28&quot; vertex=&quot;1&quot; connectable=&quot;0&quot;&gt;&#10;          &lt;mxGeometry x=&quot;-0.1775&quot; y=&quot;3&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;1&quot; y=&quot;6&quot; as=&quot;offset&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-30&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 15px;&amp;quot;&amp;gt;mov ...&amp;lt;/font&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font style=&amp;quot;font-size: 15px;&amp;quot;&amp;gt;.&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font style=&amp;quot;font-size: 15px;&amp;quot;&amp;gt;.&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font style=&amp;quot;font-size: 15px;&amp;quot;&amp;gt;.&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font style=&amp;quot;font-size: 15px;&amp;quot;&amp;gt;ret&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&quot; style=&quot;shape=ext;double=1;whiteSpace=wrap;html=1;aspect=fixed;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;427.45&quot; y=&quot;310&quot; width=&quot;90&quot; height=&quot;90&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-31&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 16px;&amp;quot;&amp;gt;Custom syscall stub&amp;lt;/font&amp;gt;&quot; style=&quot;text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;387.45&quot; y=&quot;280&quot; width=&quot;170&quot; height=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-32&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 16px;&amp;quot;&amp;gt;&amp;lt;b&amp;gt;jmp edrFunc&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&quot; style=&quot;shape=ext;double=1;rounded=0;whiteSpace=wrap;html=1;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;245&quot; y=&quot;173.5&quot; width=&quot;120&quot; height=&quot;25&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-33&quot; value=&quot;&quot; style=&quot;image;aspect=fixed;html=1;points=[];align=center;fontSize=12;image=img/lib/azure2/other/Resource_Guard.svg;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;450.86&quot; y=&quot;152&quot; width=&quot;56.64&quot; height=&quot;68&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-34&quot; value=&quot;&quot; style=&quot;shape=image;html=1;verticalAlign=top;verticalLabelPosition=bottom;labelBackgroundColor=#ffffff;imageAspect=0;aspect=fixed;image=https://cdn1.iconfinder.com/data/icons/ninja-things-1/720/ninja-background-128.png&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;328.72&quot; y=&quot;507&quot; width=&quot;36.27906976744186&quot; height=&quot;36.27906976744186&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-35&quot; value=&quot;&quot; style=&quot;shape=flexArrow;endArrow=classic;html=1;rounded=0;endWidth=5.714285714285714;endSize=12.72857142857143;fillColor=#f8cecc;strokeColor=#b85450;&quot; parent=&quot;1&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry width=&quot;50&quot; height=&quot;50&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;480.58000000000004&quot; y=&quot;405&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;481&quot; y=&quot;499&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-36&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 18px;&amp;quot;&amp;gt;Solution&amp;lt;/font&amp;gt;&quot; style=&quot;edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-35&quot; vertex=&quot;1&quot; connectable=&quot;0&quot;&gt;&#10;          &lt;mxGeometry x=&quot;-0.4598&quot; y=&quot;-2&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;7&quot; y=&quot;10&quot; as=&quot;offset&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-37&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 21px;&amp;quot;&amp;gt;Unhooking ntdll.dll by restoring the .text section&amp;amp;nbsp;&amp;lt;/font&amp;gt;&quot; style=&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;375.46&quot; y=&quot;500&quot; width=&quot;302.55&quot; height=&quot;50.28&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-38&quot; value=&quot;&quot; style=&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;300&quot; y=&quot;560&quot; width=&quot;460&quot; height=&quot;360&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-39&quot; value=&quot;&quot; style=&quot;verticalLabelPosition=bottom;html=1;verticalAlign=top;align=center;strokeColor=none;fillColor=#00BEF2;shape=mxgraph.azure.vhd_data_disk;pointerEvents=1;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;313.65268121495706&quot; y=&quot;612&quot; width=&quot;35.231031422693725&quot; height=&quot;50&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-40&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 17px;&amp;quot;&amp;gt;1- Retreive a Clean ntdll.dll&amp;lt;/font&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font style=&amp;quot;font-size: 17px;&amp;quot;&amp;gt;&amp;amp;nbsp;file from Disk&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&quot; style=&quot;text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;rotation=0;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;322.2772377072325&quot; y=&quot;702&quot; width=&quot;230&quot; height=&quot;50&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-41&quot; value=&quot;&quot; style=&quot;endArrow=classic;html=1;rounded=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;entryPerimeter=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;exitPerimeter=0;&quot; parent=&quot;1&quot; source=&quot;tEqawAXD5UkgbRX-SCwM-39&quot; target=&quot;tEqawAXD5UkgbRX-SCwM-42&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry width=&quot;50&quot; height=&quot;50&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;280&quot; y=&quot;562&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;326.97470856359166&quot; y=&quot;512&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-42&quot; value=&quot;&quot; style=&quot;whiteSpace=wrap;html=1;shape=mxgraph.basic.document&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;383.3443588399016&quot; y=&quot;572&quot; width=&quot;93.94941712718328&quot; height=&quot;130&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-43&quot; value=&quot;&quot; style=&quot;endArrow=none;html=1;rounded=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;entryPerimeter=0;exitX=0;exitY=0.5;exitDx=0;exitDy=0;exitPerimeter=0;&quot; parent=&quot;1&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry width=&quot;50&quot; height=&quot;50&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;383.3443588399016&quot; y=&quot;662&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;477.2937759670849&quot; y=&quot;662&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-44&quot; value=&quot;&amp;lt;b&amp;gt;clean .text&amp;lt;/b&amp;gt;&amp;lt;div&amp;gt;&amp;lt;b&amp;gt;&amp;amp;nbsp;section&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&quot; style=&quot;text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;402.13424226533823&quot; y=&quot;662&quot; width=&quot;80&quot; height=&quot;40&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-45&quot; value=&quot;&quot; style=&quot;verticalLabelPosition=bottom;verticalAlign=top;html=1;shape=mxgraph.basic.tick&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;388.0418296962608&quot; y=&quot;672&quot; width=&quot;14.092412569077492&quot; height=&quot;20&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-46&quot; value=&quot;&quot; style=&quot;curved=1;endArrow=classic;html=1;rounded=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;entryPerimeter=0;&quot; parent=&quot;1&quot; target=&quot;tEqawAXD5UkgbRX-SCwM-50&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry width=&quot;50&quot; height=&quot;50&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;477.2937759670849&quot; y=&quot;642&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;561.8482513815497&quot; y=&quot;622&quot; as=&quot;targetPoint&quot; /&gt;&#10;            &lt;Array as=&quot;points&quot;&gt;&#10;              &lt;mxPoint x=&quot;524.2684845306765&quot; y=&quot;642&quot; /&gt;&#10;              &lt;mxPoint x=&quot;505.4786011052399&quot; y=&quot;612&quot; /&gt;&#10;              &lt;mxPoint x=&quot;552.4533096688315&quot; y=&quot;622&quot; /&gt;&#10;              &lt;mxPoint x=&quot;561.8482513815497&quot; y=&quot;602&quot; /&gt;&#10;              &lt;mxPoint x=&quot;599.4280182324231&quot; y=&quot;632&quot; /&gt;&#10;              &lt;mxPoint x=&quot;627.612843370578&quot; y=&quot;662&quot; /&gt;&#10;            &lt;/Array&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-47&quot; value=&quot;&amp;lt;div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&quot; style=&quot;edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-46&quot; vertex=&quot;1&quot; connectable=&quot;0&quot;&gt;&#10;          &lt;mxGeometry x=&quot;0.372&quot; y=&quot;-2&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;97&quot; y=&quot;23&quot; as=&quot;offset&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-48&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 15px;&amp;quot;&amp;gt;&amp;lt;b&amp;gt;2- Patch the .text section&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;div&amp;gt;&amp;lt;span style=&amp;quot;font-size: 15px;&amp;quot;&amp;gt;&amp;lt;b&amp;gt;and &amp;lt;u&amp;gt;restore the modified protections&amp;lt;/u&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;div&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&quot; style=&quot;edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-46&quot; vertex=&quot;1&quot; connectable=&quot;0&quot;&gt;&#10;          &lt;mxGeometry x=&quot;-0.1484&quot; y=&quot;3&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;81&quot; y=&quot;5&quot; as=&quot;offset&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-49&quot; value=&quot;&quot; style=&quot;sketch=0;pointerEvents=1;shadow=0;dashed=0;html=1;strokeColor=none;fillColor=#005F4B;labelPosition=center;verticalLabelPosition=bottom;verticalAlign=top;align=center;outlineConnect=0;shape=mxgraph.veeam2.ram;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;561.8482513815497&quot; y=&quot;762&quot; width=&quot;84.55447541446495&quot; height=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-50&quot; value=&quot;&quot; style=&quot;whiteSpace=wrap;html=1;shape=mxgraph.basic.document&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;599.4280182324231&quot; y=&quot;702&quot; width=&quot;28.184825138154984&quot; height=&quot;40&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-51&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 18px;&amp;quot;&amp;gt;&amp;lt;b&amp;gt;in-memory ntdll.dll&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&quot; style=&quot;text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;514.8735428179582&quot; y=&quot;732&quot; width=&quot;180&quot; height=&quot;40&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-52&quot; value=&quot;&quot; style=&quot;image;aspect=fixed;html=1;points=[];align=center;fontSize=12;image=img/lib/azure2/other/Resource_Guard.svg;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;442.87070953168495&quot; y=&quot;812&quot; width=&quot;48.26290801331692&quot; height=&quot;57.94275679564885&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-53&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 20px;&amp;quot;&amp;gt;EDR / AV&amp;lt;/font&amp;gt;&quot; style=&quot;text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;418.52841555403177&quot; y=&quot;880&quot; width=&quot;110&quot; height=&quot;40&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-54&quot; value=&quot;&quot; style=&quot;endArrow=classic;startArrow=classic;html=1;rounded=0;curved=1;&quot; parent=&quot;1&quot; target=&quot;tEqawAXD5UkgbRX-SCwM-49&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry width=&quot;50&quot; height=&quot;50&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;491.38618853616236&quot; y=&quot;852&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;538.3608970997541&quot; y=&quot;802&quot; as=&quot;targetPoint&quot; /&gt;&#10;            &lt;Array as=&quot;points&quot;&gt;&#10;              &lt;mxPoint x=&quot;580.6381348069865&quot; y=&quot;842&quot; /&gt;&#10;            &lt;/Array&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-55&quot; value=&quot;&quot; style=&quot;shape=image;html=1;verticalAlign=top;verticalLabelPosition=bottom;labelBackgroundColor=#ffffff;imageAspect=0;aspect=fixed;image=https://cdn1.iconfinder.com/data/icons/ninja-things-1/720/ninja-background-128.png&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;471.87&quot; y=&quot;-252.72&quot; width=&quot;43&quot; height=&quot;43&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-56&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 21px;&amp;quot;&amp;gt;Detecting hooked syscalls within ntdll.dll&amp;lt;/font&amp;gt;&quot; style=&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;517.4499999999999&quot; y=&quot;-256.36&quot; width=&quot;560&quot; height=&quot;50.28&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-57&quot; value=&quot;&quot; style=&quot;curved=1;endArrow=classic;html=1;rounded=0;entryX=-0.007;entryY=0.434;entryDx=0;entryDy=0;entryPerimeter=0;exitX=1;exitY=0;exitDx=0;exitDy=0;fillColor=#f8cecc;strokeColor=#b85450;&quot; parent=&quot;1&quot; source=&quot;tEqawAXD5UkgbRX-SCwM-5&quot; target=&quot;tEqawAXD5UkgbRX-SCwM-61&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry width=&quot;50&quot; height=&quot;50&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;229.11&quot; y=&quot;180&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;279.11&quot; y=&quot;130&quot; as=&quot;targetPoint&quot; /&gt;&#10;            &lt;Array as=&quot;points&quot;&gt;&#10;              &lt;mxPoint x=&quot;279.11&quot; y=&quot;180&quot; /&gt;&#10;              &lt;mxPoint x=&quot;290&quot; y=&quot;-160&quot; /&gt;&#10;            &lt;/Array&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-58&quot; value=&quot;&quot; style=&quot;shape=flexArrow;endArrow=classic;html=1;rounded=0;endWidth=5.714285714285714;endSize=12.72857142857143;fillColor=#f8cecc;strokeColor=#b85450;&quot; parent=&quot;1&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry width=&quot;50&quot; height=&quot;50&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;610.0000000000001&quot; y=&quot;250&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;743.6&quot; y=&quot;250&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-59&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 18px;&amp;quot;&amp;gt;Solution&amp;lt;/font&amp;gt;&quot; style=&quot;edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-58&quot; vertex=&quot;1&quot; connectable=&quot;0&quot;&gt;&#10;          &lt;mxGeometry x=&quot;-0.4598&quot; y=&quot;-2&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;17&quot; y=&quot;-2&quot; as=&quot;offset&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-60&quot; value=&quot;&quot; style=&quot;group&quot; parent=&quot;1&quot; vertex=&quot;1&quot; connectable=&quot;0&quot;&gt;&#10;          &lt;mxGeometry x=&quot;477.29&quot; y=&quot;-201.6&quot; width=&quot;602.71&quot; height=&quot;281.6&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-61&quot; value=&quot;&quot; style=&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-60&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry width=&quot;602.71&quot; height=&quot;281.6&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-62&quot; value=&quot;&quot; style=&quot;sketch=0;pointerEvents=1;shadow=0;dashed=0;html=1;strokeColor=none;fillColor=#005F4B;labelPosition=center;verticalLabelPosition=bottom;verticalAlign=top;align=center;outlineConnect=0;shape=mxgraph.veeam2.ram;&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-60&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;10.159999999999968&quot; y=&quot;61.599999999999994&quot; width=&quot;70&quot; height=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-63&quot; value=&quot;&quot; style=&quot;shape=table;startSize=0;container=1;collapsible=0;childLayout=tableLayout;&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-60&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;212.70999999999998&quot; y=&quot;29.599999999999994&quot; width=&quot;160&quot; height=&quot;114&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-64&quot; value=&quot;&quot; style=&quot;shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-63&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry width=&quot;160&quot; height=&quot;15&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-65&quot; value=&quot;Nt*...&quot; style=&quot;shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-64&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry width=&quot;160&quot; height=&quot;15&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxRectangle width=&quot;160&quot; height=&quot;15&quot; as=&quot;alternateBounds&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-66&quot; value=&quot;&quot; style=&quot;shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-63&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry y=&quot;15&quot; width=&quot;160&quot; height=&quot;27&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-67&quot; value=&quot;Nt*...&quot; style=&quot;shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-66&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry width=&quot;160&quot; height=&quot;27&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxRectangle width=&quot;160&quot; height=&quot;27&quot; as=&quot;alternateBounds&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-68&quot; value=&quot;&quot; style=&quot;shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-63&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry y=&quot;42&quot; width=&quot;160&quot; height=&quot;22&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-69&quot; value=&quot;Zw*...&quot; style=&quot;shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-68&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry width=&quot;160&quot; height=&quot;22&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxRectangle width=&quot;160&quot; height=&quot;22&quot; as=&quot;alternateBounds&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-70&quot; value=&quot;&quot; style=&quot;shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-63&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry y=&quot;64&quot; width=&quot;160&quot; height=&quot;20&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-71&quot; value=&quot;Zw*...&quot; style=&quot;shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-70&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry width=&quot;160&quot; height=&quot;20&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxRectangle width=&quot;160&quot; height=&quot;20&quot; as=&quot;alternateBounds&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-72&quot; value=&quot;&quot; style=&quot;shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-63&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry y=&quot;84&quot; width=&quot;160&quot; height=&quot;15&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-73&quot; value=&quot;Nt*...&quot; style=&quot;shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-72&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry width=&quot;160&quot; height=&quot;15&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxRectangle width=&quot;160&quot; height=&quot;15&quot; as=&quot;alternateBounds&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-74&quot; value=&quot;&quot; style=&quot;shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-63&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry y=&quot;99&quot; width=&quot;160&quot; height=&quot;15&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-75&quot; value=&quot;...&quot; style=&quot;shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-74&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry width=&quot;160&quot; height=&quot;15&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxRectangle width=&quot;160&quot; height=&quot;15&quot; as=&quot;alternateBounds&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-76&quot; value=&quot;&quot; style=&quot;endArrow=classic;html=1;rounded=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;curved=1;&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-60&quot; source=&quot;tEqawAXD5UkgbRX-SCwM-62&quot; target=&quot;tEqawAXD5UkgbRX-SCwM-66&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry width=&quot;50&quot; height=&quot;50&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;40.160000000000025&quot; y=&quot;61.599999999999994&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;90.16000000000003&quot; y=&quot;11.599999999999994&quot; as=&quot;targetPoint&quot; /&gt;&#10;            &lt;Array as=&quot;points&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-77&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 16px;&amp;quot;&amp;gt;Load ntdll.dll&amp;amp;nbsp;&amp;lt;/font&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font style=&amp;quot;font-size: 16px;&amp;quot;&amp;gt;export table&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&quot; style=&quot;edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-76&quot; vertex=&quot;1&quot; connectable=&quot;0&quot;&gt;&#10;          &lt;mxGeometry x=&quot;-0.1688&quot; y=&quot;-3&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;7&quot; y=&quot;-8&quot; as=&quot;offset&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-78&quot; value=&quot;&quot; style=&quot;shape=curlyBracket;whiteSpace=wrap;html=1;rounded=1;flipH=1;labelPosition=right;verticalLabelPosition=middle;align=left;verticalAlign=middle;&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-60&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;372.71&quot; y=&quot;26.599999999999994&quot; width=&quot;20&quot; height=&quot;120&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-79&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 16px;&amp;quot;&amp;gt;&amp;lt;b&amp;gt;Loop through the Nt* and Zw* functions&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font style=&amp;quot;font-size: 16px;&amp;quot;&amp;gt;&amp;lt;b&amp;gt;and check their syscalls stubs if they start with a redirection&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&quot; style=&quot;text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-60&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;392.71&quot; y=&quot;91.6&quot; width=&quot;210&quot; height=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-80&quot; value=&quot;&amp;lt;ul&amp;gt;&amp;lt;li&amp;gt;&amp;lt;font style=&amp;quot;font-size: 17px;&amp;quot;&amp;gt;Good before doing direct/indirect syscall.&amp;lt;/font&amp;gt;&amp;lt;/li&amp;gt;&amp;lt;li&amp;gt;&amp;lt;font style=&amp;quot;font-size: 17px;&amp;quot;&amp;gt;Good to verify if an unhooking routine went correctly.&amp;lt;/font&amp;gt;&amp;lt;/li&amp;gt;&amp;lt;li&amp;gt;&amp;lt;font style=&amp;quot;font-size: 17px;&amp;quot;&amp;gt;Not good against total API re-implementation.&amp;lt;/font&amp;gt;&amp;lt;/li&amp;gt;&amp;lt;li&amp;gt;&amp;lt;font style=&amp;quot;font-size: 17px;&amp;quot;&amp;gt;Limited to inline hooking and not IAT and SSDT hooks.&amp;lt;/font&amp;gt;&amp;lt;/li&amp;gt;&amp;lt;/ul&amp;gt;&quot; style=&quot;text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-60&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;42.23999999999995&quot; y=&quot;161.6&quot; width=&quot;490.47&quot; height=&quot;110&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-81&quot; value=&quot;&quot; style=&quot;shape=image;html=1;verticalAlign=top;verticalLabelPosition=bottom;labelBackgroundColor=#ffffff;imageAspect=0;aspect=fixed;image=https://cdn1.iconfinder.com/data/icons/ninja-things-1/720/ninja-background-128.png&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;790&quot; y=&quot;173.72000000000003&quot; width=&quot;36.27906976744186&quot; height=&quot;36.27906976744186&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-82&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 21px;&amp;quot;&amp;gt;&amp;lt;b&amp;gt;Direct Syscalls&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&quot; style=&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;830&quot; y=&quot;169.72&quot; width=&quot;440&quot; height=&quot;50.28&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-83&quot; value=&quot;&quot; style=&quot;shape=flexArrow;endArrow=classic;html=1;rounded=0;endWidth=5.714285714285714;endSize=12.72857142857143;fillColor=#f8cecc;strokeColor=#b85450;&quot; parent=&quot;1&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry width=&quot;50&quot; height=&quot;50&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;1049&quot; y=&quot;600&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;1049.17&quot; y=&quot;700&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-84&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 18px;&amp;quot;&amp;gt;Solution&amp;lt;/font&amp;gt;&quot; style=&quot;edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-83&quot; vertex=&quot;1&quot; connectable=&quot;0&quot;&gt;&#10;          &lt;mxGeometry x=&quot;-0.4598&quot; y=&quot;-2&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;17&quot; y=&quot;-2&quot; as=&quot;offset&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-85&quot; value=&quot;&quot; style=&quot;group&quot; parent=&quot;1&quot; vertex=&quot;1&quot; connectable=&quot;0&quot;&gt;&#10;          &lt;mxGeometry x=&quot;712.5&quot; y=&quot;230&quot; width=&quot;625&quot; height=&quot;360&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-86&quot; value=&quot;&quot; style=&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-85&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;77.5&quot; width=&quot;490&quot; height=&quot;360&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-87&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 17px;&amp;quot;&amp;gt;&amp;lt;b&amp;gt;*.cpp&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&quot; style=&quot;whiteSpace=wrap;html=1;shape=mxgraph.basic.document;container=1;&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-85&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;447.5&quot; y=&quot;92.5&quot; width=&quot;50&quot; height=&quot;65&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-88&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 18px;&amp;quot;&amp;gt;&amp;lt;b&amp;gt;*.h&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&quot; style=&quot;whiteSpace=wrap;html=1;shape=mxgraph.basic.document;container=1;&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-85&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;287.5&quot; y=&quot;92.5&quot; width=&quot;50&quot; height=&quot;65&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-89&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 18px;&amp;quot;&amp;gt;&amp;lt;b&amp;gt;*.asm&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&quot; style=&quot;whiteSpace=wrap;html=1;shape=mxgraph.basic.document;container=1;&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-85&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;117.5&quot; y=&quot;92.5&quot; width=&quot;50&quot; height=&quot;65&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-90&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 17px;&amp;quot;&amp;gt;&amp;lt;b&amp;gt;Avoid the hooked ntdll.dll and call&amp;amp;nbsp;&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font style=&amp;quot;font-size: 17px;&amp;quot;&amp;gt;&amp;lt;b&amp;gt;the target syscall&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;b style=&amp;quot;font-size: 17px; background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;&amp;amp;nbsp;directly with its SSN.&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&quot; style=&quot;text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-85&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;147.5&quot; y=&quot;19.99999999999997&quot; width=&quot;340&quot; height=&quot;50&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-91&quot; value=&quot;&amp;lt;b&amp;gt;&amp;lt;font style=&amp;quot;font-size: 15px;&amp;quot;&amp;gt;Syscall stub that&amp;amp;nbsp;&amp;lt;br&amp;gt;prepares the&amp;amp;nbsp;&amp;lt;/font&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;div&amp;gt;&amp;lt;b style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;&amp;lt;font style=&amp;quot;font-size: 15px;&amp;quot;&amp;gt;&amp;amp;nbsp;parameters in the&amp;amp;nbsp;&amp;lt;/font&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;div&amp;gt;&amp;lt;b&amp;gt;&amp;lt;font style=&amp;quot;font-size: 15px;&amp;quot;&amp;gt;correct registers&amp;lt;/font&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&quot; style=&quot;text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-85&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;67.5&quot; y=&quot;150&quot; width=&quot;160&quot; height=&quot;90&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-92&quot; value=&quot;&amp;lt;b&amp;gt;&amp;lt;font style=&amp;quot;font-size: 15px;&amp;quot;&amp;gt;Header file with the&amp;amp;nbsp;&amp;lt;/font&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;b&amp;gt;&amp;lt;font style=&amp;quot;font-size: 15px;&amp;quot;&amp;gt;external function&amp;amp;nbsp;&amp;lt;/font&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;b&amp;gt;&amp;lt;font style=&amp;quot;font-size: 15px;&amp;quot;&amp;gt;declarations&amp;lt;/font&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&quot; style=&quot;text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-85&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;227.5&quot; y=&quot;160&quot; width=&quot;170&quot; height=&quot;70&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-93&quot; value=&quot;&amp;lt;b&amp;gt;&amp;lt;font style=&amp;quot;font-size: 15px;&amp;quot;&amp;gt;The code that&amp;amp;nbsp;&amp;lt;/font&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;div&amp;gt;&amp;lt;b&amp;gt;&amp;lt;font style=&amp;quot;font-size: 15px;&amp;quot;&amp;gt;retrieves&amp;amp;nbsp;&amp;amp;nbsp;&amp;lt;/font&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;div&amp;gt;&amp;lt;b&amp;gt;&amp;lt;font style=&amp;quot;font-size: 15px;&amp;quot;&amp;gt;the SSN and call&amp;lt;/font&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;b&amp;gt;&amp;lt;font style=&amp;quot;font-size: 15px;&amp;quot;&amp;gt;the syscalls&amp;lt;/font&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&quot; style=&quot;text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-85&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;402.5&quot; y=&quot;154.38&quot; width=&quot;140&quot; height=&quot;90&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-94&quot; value=&quot;&quot; style=&quot;verticalLabelPosition=bottom;verticalAlign=top;html=1;shape=mxgraph.basic.tick;fillColor=#d5e8d4;strokeColor=#82b366;&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-85&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;120&quot; y=&quot;28.75&quot; width=&quot;27.5&quot; height=&quot;32.5&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;UserObject label=&quot;SSNs are version-dependant. Look for Hell&amp;#39;s Gate method.&amp;#xa;Atypical behaviour of the syscall instructions since they execute&amp;#xa;outside of the ntdll.dll.&amp;#xa;The return address after the syscall points back to non-standard&amp;#xa;memory region.&quot; id=&quot;tEqawAXD5UkgbRX-SCwM-95&quot;&gt;&#10;          &lt;mxCell style=&quot;text;whiteSpace=wrap;fontSize=16;&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-85&quot; vertex=&quot;1&quot;&gt;&#10;            &lt;mxGeometry x=&quot;107.5&quot; y=&quot;240&quot; width=&quot;490&quot; height=&quot;100&quot; as=&quot;geometry&quot; /&gt;&#10;          &lt;/mxCell&gt;&#10;        &lt;/UserObject&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-96&quot; value=&quot;&quot; style=&quot;shape=mxgraph.mockup.markup.redX;fillColor=#ff0000;html=1;shadow=0;whiteSpace=wrap;strokeColor=none;&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-85&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;87.5&quot; y=&quot;303&quot; width=&quot;13.72&quot; height=&quot;17&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-97&quot; value=&quot;&quot; style=&quot;shape=mxgraph.mockup.markup.redX;fillColor=#ff0000;html=1;shadow=0;whiteSpace=wrap;strokeColor=none;&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-85&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;87.5&quot; y=&quot;270&quot; width=&quot;13.72&quot; height=&quot;17&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-98&quot; value=&quot;&quot; style=&quot;shape=mxgraph.mockup.markup.redX;fillColor=#ff0000;html=1;shadow=0;whiteSpace=wrap;strokeColor=none;&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-85&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;87.5&quot; y=&quot;244.38&quot; width=&quot;13.72&quot; height=&quot;17&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sD_lDuidbchsZRyquxOI-5&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 21px;&amp;quot;&amp;gt;&amp;lt;b&amp;gt;LSASS Dumping&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&quot; style=&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;&quot; vertex=&quot;1&quot; parent=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;210&quot; y=&quot;1283.73&quot; width=&quot;491.69&quot; height=&quot;53.74&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sD_lDuidbchsZRyquxOI-6&quot; value=&quot;&quot; style=&quot;shape=image;html=1;verticalAlign=top;verticalLabelPosition=bottom;labelBackgroundColor=#ffffff;imageAspect=0;aspect=fixed;image=https://cdn1.iconfinder.com/data/icons/ninja-things-1/720/ninja-background-128.png&quot; vertex=&quot;1&quot; parent=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;129.99999999999997&quot; y=&quot;1281.86&quot; width=&quot;57.47&quot; height=&quot;57.47&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sD_lDuidbchsZRyquxOI-21&quot; value=&quot;&quot; style=&quot;group&quot; vertex=&quot;1&quot; connectable=&quot;0&quot; parent=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;340&quot; y=&quot;1370&quot; width=&quot;188.53&quot; height=&quot;130&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sD_lDuidbchsZRyquxOI-15&quot; value=&quot;&quot; style=&quot;strokeWidth=2;html=1;shape=mxgraph.flowchart.database;whiteSpace=wrap;&quot; vertex=&quot;1&quot; parent=&quot;sD_lDuidbchsZRyquxOI-21&quot;&gt;&#10;          &lt;mxGeometry x=&quot;63.7675&quot; width=&quot;60.995&quot; height=&quot;82.72727272727273&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sD_lDuidbchsZRyquxOI-16&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 20px;&amp;quot;&amp;gt;&amp;lt;b style=&amp;quot;&amp;quot;&amp;gt;LSASS Process&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&quot; style=&quot;text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;&quot; vertex=&quot;1&quot; parent=&quot;sD_lDuidbchsZRyquxOI-21&quot;&gt;&#10;          &lt;mxGeometry y=&quot;82.72727272727273&quot; width=&quot;170&quot; height=&quot;40&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sD_lDuidbchsZRyquxOI-10&quot; value=&quot;&quot; style=&quot;curved=1;endArrow=classic;html=1;rounded=0;&quot; edge=&quot;1&quot; parent=&quot;1&quot; source=&quot;sD_lDuidbchsZRyquxOI-16&quot;&gt;&#10;          &lt;mxGeometry width=&quot;50&quot; height=&quot;50&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;572.1300000000001&quot; y=&quot;1550&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;200&quot; y=&quot;1610&quot; as=&quot;targetPoint&quot; /&gt;&#10;            &lt;Array as=&quot;points&quot;&gt;&#10;              &lt;mxPoint x=&quot;280&quot; y=&quot;1480&quot; /&gt;&#10;              &lt;mxPoint x=&quot;160&quot; y=&quot;1460&quot; /&gt;&#10;            &lt;/Array&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sD_lDuidbchsZRyquxOI-24&quot; value=&quot;&quot; style=&quot;curved=1;endArrow=classic;html=1;rounded=0;exitX=0.984;exitY=0.632;exitDx=0;exitDy=0;exitPerimeter=0;&quot; edge=&quot;1&quot; parent=&quot;1&quot; source=&quot;sD_lDuidbchsZRyquxOI-16&quot;&gt;&#10;          &lt;mxGeometry width=&quot;50&quot; height=&quot;50&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;680&quot; y=&quot;1600&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;670&quot; y=&quot;1620&quot; as=&quot;targetPoint&quot; /&gt;&#10;            &lt;Array as=&quot;points&quot;&gt;&#10;              &lt;mxPoint x=&quot;610&quot; y=&quot;1478&quot; /&gt;&#10;              &lt;mxPoint x=&quot;700&quot; y=&quot;1460&quot; /&gt;&#10;              &lt;mxPoint x=&quot;700&quot; y=&quot;1520&quot; /&gt;&#10;            &lt;/Array&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sD_lDuidbchsZRyquxOI-26&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 26px;&amp;quot;&amp;gt;MiniDumpWriteDump&amp;lt;/font&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font style=&amp;quot;font-size: 26px;&amp;quot;&amp;gt;+&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font style=&amp;quot;font-size: 26px;&amp;quot;&amp;gt;SeDebugPrivilege&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&quot; style=&quot;edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];&quot; vertex=&quot;1&quot; connectable=&quot;0&quot; parent=&quot;sD_lDuidbchsZRyquxOI-24&quot;&gt;&#10;          &lt;mxGeometry x=&quot;-0.1338&quot; y=&quot;2&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;-455&quot; y=&quot;64&quot; as=&quot;offset&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sD_lDuidbchsZRyquxOI-31&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 26px;&amp;quot;&amp;gt;PssCaptureSnapshot&amp;lt;/font&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font style=&amp;quot;font-size: 26px;&amp;quot;&amp;gt;+&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font style=&amp;quot;font-size: 26px;&amp;quot;&amp;gt;MiniDumpWriteDump&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&quot; style=&quot;edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];&quot; vertex=&quot;1&quot; connectable=&quot;0&quot; parent=&quot;sD_lDuidbchsZRyquxOI-24&quot;&gt;&#10;          &lt;mxGeometry x=&quot;0.202&quot; y=&quot;-5&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;-15&quot; y=&quot;49&quot; as=&quot;offset&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sD_lDuidbchsZRyquxOI-29&quot; value=&quot;&quot; style=&quot;whiteSpace=wrap;html=1;shape=mxgraph.basic.document&quot; vertex=&quot;1&quot; parent=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;166.61&quot; y=&quot;1630&quot; width=&quot;63.39&quot; height=&quot;80&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sD_lDuidbchsZRyquxOI-30&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 23px;&amp;quot;&amp;gt;&amp;amp;nbsp;Directly create a *.dmp file&amp;lt;/font&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font style=&amp;quot;font-size: 23px;&amp;quot;&amp;gt;saved on the disk containing&amp;amp;nbsp;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font style=&amp;quot;font-size: 23px;&amp;quot;&amp;gt;its content.&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&quot; style=&quot;text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;&quot; vertex=&quot;1&quot; parent=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;60.17999999999999&quot; y=&quot;1710&quot; width=&quot;320&quot; height=&quot;100&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sD_lDuidbchsZRyquxOI-32&quot; value=&quot;&quot; style=&quot;shape=datastore;whiteSpace=wrap;html=1;&quot; vertex=&quot;1&quot; parent=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;630&quot; y=&quot;1630&quot; width=&quot;64.87&quot; height=&quot;80&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sD_lDuidbchsZRyquxOI-33&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 23px;&amp;quot;&amp;gt;Create a read-only clone of the&amp;lt;/font&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font style=&amp;quot;font-size: 23px;&amp;quot;&amp;gt;&amp;amp;nbsp;lsass.exe and only then&amp;lt;/font&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font style=&amp;quot;font-size: 23px;&amp;quot;&amp;gt;dump its memory usinng&amp;amp;nbsp;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font style=&amp;quot;font-size: 23px;&amp;quot;&amp;gt;MiniDumpWriteDump&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&quot; style=&quot;text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;&quot; vertex=&quot;1&quot; parent=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;498.67&quot; y=&quot;1720&quot; width=&quot;340&quot; height=&quot;120&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sD_lDuidbchsZRyquxOI-34&quot; value=&quot;&quot; style=&quot;group&quot; vertex=&quot;1&quot; connectable=&quot;0&quot; parent=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;810&quot; y=&quot;720&quot; width=&quot;500&quot; height=&quot;398.28&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-99&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 21px;&amp;quot;&amp;gt;&amp;lt;b&amp;gt;Indirect Syscalls&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&quot; style=&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;&quot; parent=&quot;sD_lDuidbchsZRyquxOI-34&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;40&quot; width=&quot;440&quot; height=&quot;50.28&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-100&quot; value=&quot;&quot; style=&quot;shape=image;html=1;verticalAlign=top;verticalLabelPosition=bottom;labelBackgroundColor=#ffffff;imageAspect=0;aspect=fixed;image=https://cdn1.iconfinder.com/data/icons/ninja-things-1/720/ninja-background-128.png&quot; parent=&quot;sD_lDuidbchsZRyquxOI-34&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry y=&quot;7&quot; width=&quot;36.27906976744186&quot; height=&quot;36.27906976744186&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-101&quot; value=&quot;&quot; style=&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;&quot; parent=&quot;sD_lDuidbchsZRyquxOI-34&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;34.41999999999996&quot; y=&quot;70.27999999999997&quot; width=&quot;453.72&quot; height=&quot;328&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-102&quot; value=&quot;&amp;lt;div style=&amp;quot;text-align: left;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;&amp;lt;font style=&amp;quot;font-size: 20px;&amp;quot;&amp;gt;Instead of manually calling a syscall by its SSN&amp;amp;nbsp;&amp;lt;/font&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font style=&amp;quot;font-size: 20px;&amp;quot;&amp;gt;&amp;lt;font style=&amp;quot;&amp;quot;&amp;gt;within our payload we will&amp;amp;nbsp;&amp;lt;/font&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;&amp;lt;font style=&amp;quot;&amp;quot;&amp;gt;find the address of a&amp;lt;/font&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;&amp;lt;font style=&amp;quot;font-size: 20px;&amp;quot;&amp;gt;target syscall instruction residing within ntdll.dll&amp;amp;nbsp;&amp;lt;/font&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font style=&amp;quot;font-size: 20px;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;&amp;lt;font style=&amp;quot;&amp;quot;&amp;gt;and jump&amp;amp;nbsp;&amp;lt;/font&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;&amp;lt;font style=&amp;quot;&amp;quot;&amp;gt;to that instruction&amp;amp;nbsp;&amp;lt;/font&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&quot; style=&quot;text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;&quot; parent=&quot;sD_lDuidbchsZRyquxOI-34&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;35&quot; y=&quot;98.27999999999997&quot; width=&quot;450&quot; height=&quot;110&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-103&quot; value=&quot;&quot; style=&quot;verticalLabelPosition=bottom;verticalAlign=top;html=1;shape=mxgraph.basic.tick;fillColor=#d5e8d4;strokeColor=#82b366;&quot; parent=&quot;sD_lDuidbchsZRyquxOI-34&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;40&quot; y=&quot;228.27999999999997&quot; width=&quot;27.5&quot; height=&quot;32.5&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-104&quot; value=&quot;&amp;lt;b&amp;gt;&amp;lt;font style=&amp;quot;font-size: 16px;&amp;quot;&amp;gt;The return address will be in a normal and expected&amp;amp;nbsp;&amp;lt;/font&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;div style=&amp;quot;text-align: left;&amp;quot;&amp;gt;&amp;lt;b&amp;gt;&amp;lt;font style=&amp;quot;font-size: 16px;&amp;quot;&amp;gt;memory region.&amp;lt;/font&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&quot; style=&quot;text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;&quot; parent=&quot;sD_lDuidbchsZRyquxOI-34&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;68.13999999999999&quot; y=&quot;219.52999999999997&quot; width=&quot;420&quot; height=&quot;50&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-105&quot; value=&quot;&amp;lt;b&amp;gt;&amp;lt;font style=&amp;quot;font-size: 16px;&amp;quot;&amp;gt;Better in avoiding memory inspection and&amp;amp;nbsp;&amp;lt;/font&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;b style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;&amp;lt;font style=&amp;quot;font-size: 16px;&amp;quot;&amp;gt;call stack&amp;amp;nbsp;&amp;lt;/font&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;div&amp;gt;&amp;lt;b style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;&amp;lt;font style=&amp;quot;font-size: 16px;&amp;quot;&amp;gt;red flags.&amp;lt;/font&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&quot; style=&quot;text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;&quot; parent=&quot;sD_lDuidbchsZRyquxOI-34&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;80&quot; y=&quot;269.53&quot; width=&quot;420&quot; height=&quot;50&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-106&quot; value=&quot;&quot; style=&quot;verticalLabelPosition=bottom;verticalAlign=top;html=1;shape=mxgraph.basic.tick;fillColor=#d5e8d4;strokeColor=#82b366;&quot; parent=&quot;sD_lDuidbchsZRyquxOI-34&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;40&quot; y=&quot;278.28&quot; width=&quot;27.5&quot; height=&quot;32.5&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-107&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 16px;&amp;quot;&amp;gt;&amp;lt;b style=&amp;quot;&amp;quot;&amp;gt;Isn&amp;#39;t that strong against ETW+ Kernel callbacks&amp;amp;nbsp;&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font style=&amp;quot;font-size: 16px;&amp;quot;&amp;gt;&amp;lt;b style=&amp;quot;&amp;quot;&amp;gt;protections.&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&quot; style=&quot;text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;&quot; parent=&quot;sD_lDuidbchsZRyquxOI-34&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;80&quot; y=&quot;319.53&quot; width=&quot;390&quot; height=&quot;50&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-108&quot; value=&quot;&quot; style=&quot;shape=mxgraph.mockup.markup.redX;fillColor=#ff0000;html=1;shadow=0;whiteSpace=wrap;strokeColor=none;&quot; parent=&quot;sD_lDuidbchsZRyquxOI-34&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;40&quot; y=&quot;329.53&quot; width=&quot;33.6&quot; height=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sD_lDuidbchsZRyquxOI-36&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 25px;&amp;quot;&amp;gt;The LSASS process is a critical Windows process since :&amp;amp;nbsp;&amp;lt;/font&amp;gt;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;font style=&amp;quot;font-size: 25px;&amp;quot;&amp;gt;- It caches passwords in memory.&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;font style=&amp;quot;font-size: 25px;&amp;quot;&amp;gt;- Creates access tokens.&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;font style=&amp;quot;font-size: 25px;&amp;quot;&amp;gt;- Enforces security policy.&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;font style=&amp;quot;font-size: 25px;&amp;quot;&amp;gt;- Writes to windows logs.&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;font-size: 25px;&amp;quot;&amp;gt;Dumping its memory could lead to obtaining very sensitive&amp;amp;nbsp;&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;font-size: 25px;&amp;quot;&amp;gt;data to be used later with offline tools like mimikataz.&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&quot; style=&quot;text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;&quot; vertex=&quot;1&quot; parent=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;110&quot; y=&quot;1840&quot; width=&quot;680&quot; height=&quot;220&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;      &lt;/root&gt;&#10;    &lt;/mxGraphModel&gt;&#10;  &lt;/diagram&gt;&#10;&lt;/mxfile&gt;&#10;"><defs/><g><g data-cell-id="0"><g data-cell-id="1"><g data-cell-id="sD_lDuidbchsZRyquxOI-35"><g><rect x="55" y="1653.73" width="790" height="716.27" rx="107.44" ry="107.44" fill="#f8cecc" stroke="#b85450" pointer-events="all" style="fill: light-dark(rgb(248, 206, 204), rgb(81, 45, 43)); stroke: light-dark(rgb(184, 84, 80), rgb(215, 129, 126));"/></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-1"><g><rect x="138.75" y="0" width="126.25" height="870" fill="none" stroke="none" pointer-events="all"/><path d="M 138.75 0 M 265 0 L 265 870 L 138.75 870" fill="none" stroke="#000000" stroke-linecap="square" stroke-miterlimit="10" stroke-dasharray="8 8" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-2"><g><ellipse cx="474.18" cy="577.41" rx="140" ry="135.41" fill="#dae8fc" stroke="#6c8ebf" transform="rotate(-90,474.18,577.41)" pointer-events="all" style="fill: light-dark(rgb(218, 232, 252), rgb(29, 41, 59)); stroke: light-dark(rgb(108, 142, 191), rgb(92, 121, 163));"/></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-3"><g><rect x="111.61" y="330" width="110" height="30" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 108px; height: 1px; padding-top: 345px; margin-left: 113px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font style="font-size: 18px;">shell.exe</font></div></div></div></foreignObject><text x="167" y="349" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">shell.exe</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-4"><g><rect x="111.61" y="400" width="110" height="30" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 108px; height: 1px; padding-top: 415px; margin-left: 113px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font style="font-size: 18px;">kernel32.dll</font></div></div></div></foreignObject><text x="167" y="419" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">kernel32.dll</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-5"><g><rect x="111.61" y="470" width="110" height="30" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 108px; height: 1px; padding-top: 485px; margin-left: 113px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font style="font-size: 18px;">ntdll.dll</font></div></div></div></foreignObject><text x="167" y="489" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">ntdll.dll</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-6"><g><path d="M 166.61 360 L 166.61 393.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 166.61 398.88 L 163.11 391.88 L 166.61 393.63 L 170.11 391.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-7"><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 379px; margin-left: 167px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; background-color: #ffffff; "><div style="display: inline-block; font-size: 11px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; background-color: light-dark(#ffffff, var(--ge-dark-color, #121212)); white-space: nowrap; "><b>ReadProcessMemory</b></div></div></div></foreignObject><text x="167" y="382" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="11px" text-anchor="middle">ReadProcessMemory</text></switch></g></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-8"><g><path d="M 166.61 430 L 166.61 463.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 166.61 468.88 L 163.11 461.88 L 166.61 463.63 L 170.11 461.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-9"><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 449px; margin-left: 166px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; background-color: #ffffff; "><div style="display: inline-block; font-size: 11px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; background-color: light-dark(#ffffff, var(--ge-dark-color, #121212)); white-space: nowrap; "><b>NtReadVirtualMemory</b></div></div></div></foreignObject><text x="166" y="452" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="11px" text-anchor="middle">NtReadVirtualMemory</text></switch></g></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-10"><g><rect x="111.61" y="680" width="110" height="110" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 111.61 700 L 221.61 700" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 131.61 680 L 131.61 790" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-11"><g><path d="M 166.61 500 L 166.61 673.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 166.61 678.88 L 163.11 671.88 L 166.61 673.63 L 170.11 671.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-12"><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 640px; margin-left: 168px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; background-color: #ffffff; "><div style="display: inline-block; font-size: 11px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; background-color: light-dark(#ffffff, var(--ge-dark-color, #121212)); white-space: nowrap; "><b>Syscall</b></div></div></div></foreignObject><text x="168" y="643" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="11px" text-anchor="middle">Syscall</text></switch></g></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-13"><g><rect x="121.61" y="700" width="102.5" height="90" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 101px; height: 1px; padding-top: 745px; margin-left: 123px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Pointers<br />to the<br />corresponding<br />kernel<br />function</div></div></div></foreignObject><text x="173" y="749" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Pointers...</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-14"><g><rect x="79.92" y="820" width="173.39" height="30" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 171px; height: 1px; padding-top: 835px; margin-left: 81px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><b><font style="font-size: 14px;">Nt!NtReadVirtualMemory</font></b></div></div></div></foreignObject><text x="167" y="839" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Nt!NtReadVirtualMemory</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-15"><g><path d="M 166.61 790 L 166.61 813.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 166.61 818.88 L 163.11 811.88 L 166.61 813.63 L 170.11 811.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-16"><g><path d="M 33.33 900 L 33 130" fill="none" stroke="#000000" stroke-width="2" stroke-miterlimit="10" stroke-dasharray="2 6" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-17"><g><path d="M 5 660 L 265 660" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-18"><g><rect x="-53.12" y="348.12" width="132.5" height="26.25" rx="3.94" ry="3.94" fill="#d5e8d4" stroke="#82b366" transform="rotate(-90,13.13,361.24)" pointer-events="all" style="fill: light-dark(rgb(213, 232, 212), rgb(31, 47, 30)); stroke: light-dark(rgb(130, 179, 102), rgb(68, 110, 44));"/></g><g><g transform="translate(-0.5 -0.5)rotate(-90 13.13000000000011 361.2449999999999)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 131px; height: 1px; padding-top: 361px; margin-left: -52px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font style="font-size: 14px;"><b>User-Mode</b></font></div></div></div></foreignObject><text x="13" y="365" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">User-Mode</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-19"><g><rect x="-46.87" y="741.88" width="116.25" height="22.5" rx="3.38" ry="3.38" fill="#f8cecc" stroke="#b85450" transform="rotate(-90,11.26,753.13)" pointer-events="all" style="fill: light-dark(rgb(248, 206, 204), rgb(81, 45, 43)); stroke: light-dark(rgb(184, 84, 80), rgb(215, 129, 126));"/></g><g><g transform="translate(-0.5 -0.5)rotate(-90 11.25500000000011 753.1300000000001)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 114px; height: 1px; padding-top: 753px; margin-left: -46px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font style="font-size: 14px;"><b>Kernel-mode</b></font></div></div></div></foreignObject><text x="11" y="757" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Kernel-mode</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-20"><g><rect x="134.11" y="680" width="90" height="20" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 88px; height: 1px; padding-top: 690px; margin-left: 135px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><b>Syscall Table</b></div></div></div></foreignObject><text x="179" y="694" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Syscall Table</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-21"><g><image x="54.68" y="569.5" width="83.57" height="60" xlink:href="data:image/png;base64,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" preserveAspectRatio="none"/></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-22"><g><rect x="38.75" y="540" width="110" height="30" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 555px; margin-left: 94px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: nowrap; "><b><u><font style="font-size: 14px;">Syscall stub</font></u></b></div></div></div></foreignObject><text x="94" y="559" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Syscall stub</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-23"><g><ellipse cx="70" cy="415" rx="35" ry="10" fill="#dae8fc" stroke="#6c8ebf" pointer-events="all" style="fill: light-dark(rgb(218, 232, 252), rgb(29, 41, 59)); stroke: light-dark(rgb(108, 142, 191), rgb(92, 121, 163));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 68px; height: 1px; padding-top: 415px; margin-left: 36px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><b>Win32 API</b></div></div></div></foreignObject><text x="70" y="419" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Win32 API</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-24"><g><ellipse cx="70" cy="480" rx="35" ry="10" fill="#dae8fc" stroke="#6c8ebf" pointer-events="all" style="fill: light-dark(rgb(218, 232, 252), rgb(29, 41, 59)); stroke: light-dark(rgb(108, 142, 191), rgb(92, 121, 163));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 68px; height: 1px; padding-top: 480px; margin-left: 36px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><b>NT API</b></div></div></div></foreignObject><text x="70" y="484" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">NT API</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-25"><g><rect x="35" y="510" width="98.76" height="10" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 97px; height: 1px; padding-top: 515px; margin-left: 36px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><b>Functions start with Nt or Zw</b></div></div></div></foreignObject><text x="84" y="519" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Functions start...</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-26"><g><rect x="121.61" y="300" width="90" height="30" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 315px; margin-left: 167px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: nowrap; "><font style="font-size: 15px;">User App</font></div></div></div></foreignObject><text x="167" y="319" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">User App</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-27"><g><rect x="414.18" y="520" width="120" height="40" rx="20" ry="20" fill="#dae8fc" stroke="#6c8ebf" pointer-events="all" style="fill: light-dark(rgb(218, 232, 252), rgb(29, 41, 59)); stroke: light-dark(rgb(108, 142, 191), rgb(92, 121, 163));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 114px; height: 1px; padding-top: 540px; margin-left: 417px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><span style="font-size: 18px;">EDR / AV</span></div></div></div></foreignObject><text x="474" y="544" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">EDR / AV</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-28"><g><path d="M 221.61 485 Q 231.61 485 317.89 512.5 Q 404.18 540 414.18 540" fill="none" stroke="#6c8ebf" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(108, 142, 191), rgb(92, 121, 163));"/></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-29"><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 511px; margin-left: 303px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; background-color: #ffffff; "><div style="display: inline-block; font-size: 11px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; background-color: light-dark(#ffffff, var(--ge-dark-color, #121212)); white-space: nowrap; "><font style="font-size: 17px;">Often Hooked<br />(inline hooking)</font></div></div></div></foreignObject><text x="303" y="514" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="11px" text-anchor="middle">Often Hooked...</text></switch></g></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-30"><g><rect x="422.45" y="600" width="90" height="90" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><rect x="424.45" y="602" width="86" height="86" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 84px; height: 1px; padding-top: 645px; margin-left: 425px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font style="font-size: 15px;">mov ...</font><div><font style="font-size: 15px;">.</font></div><div><font style="font-size: 15px;">.</font></div><div><font style="font-size: 15px;">.</font></div><div><font style="font-size: 15px;">ret</font></div></div></div></div></foreignObject><text x="467" y="649" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">mov ......</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-31"><g><rect x="382.45" y="570" width="170" height="30" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 585px; margin-left: 467px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: nowrap; "><font style="font-size: 16px;">Custom syscall stub</font></div></div></div></foreignObject><text x="467" y="589" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Custom syscall stub</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-32"><g><rect x="240" y="463.5" width="120" height="25" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><rect x="242" y="465.5" width="116" height="21" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 114px; height: 1px; padding-top: 476px; margin-left: 243px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font style="font-size: 16px;"><b>jmp edrFunc</b></font></div></div></div></foreignObject><text x="300" y="480" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">jmp edrFunc</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-33"><g><image x="445.36" y="441.5" width="56.64" height="68" xlink:href="https://app.diagrams.net/img/lib/azure2/other/Resource_Guard.svg"/></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-34"><g><image x="323.22" y="796.5" width="36.28" height="36.28" xlink:href="https://cdn1.iconfinder.com/data/icons/ninja-things-1/720/ninja-background-128.png" preserveAspectRatio="none"/></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-35"><g><path d="M 470.58 695.52 L 480.58 695.48 L 480.82 749.29 L 484.18 749.28 L 476 788.5 L 467.47 749.35 L 470.82 749.34 Z" fill="#f8cecc" stroke="#b85450" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(248, 206, 204), rgb(81, 45, 43)); stroke: light-dark(rgb(184, 84, 80), rgb(215, 129, 126));"/></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-36"><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 731px; margin-left: 482px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; background-color: #ffffff; "><div style="display: inline-block; font-size: 11px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; background-color: light-dark(#ffffff, var(--ge-dark-color, #121212)); white-space: nowrap; "><font style="font-size: 18px;">Solution</font></div></div></div></foreignObject><text x="482" y="734" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="11px" text-anchor="middle">Solution</text></switch></g></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-37"><g><rect x="370.46" y="790" width="302.55" height="50.28" rx="7.54" ry="7.54" fill="#f8cecc" stroke="#b85450" pointer-events="all" style="fill: light-dark(rgb(248, 206, 204), rgb(81, 45, 43)); stroke: light-dark(rgb(184, 84, 80), rgb(215, 129, 126));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 301px; height: 1px; padding-top: 815px; margin-left: 371px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font style="font-size: 21px;">Unhooking ntdll.dll by restoring the .text section</font></div></div></div></foreignObject><text x="522" y="819" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Unhooking ntdll.dll by restoring the .text section</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-38"><g><rect x="295" y="850" width="460" height="360" rx="54" ry="54" fill="#f8cecc" stroke="#b85450" pointer-events="all" style="fill: light-dark(rgb(248, 206, 204), rgb(81, 45, 43)); stroke: light-dark(rgb(184, 84, 80), rgb(215, 129, 126));"/></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-39"><g><rect x="308.65" y="902" width="35.23" height="50" fill="none" stroke="none" pointer-events="all"/><path d="M 308.65 903.26 C 308.75 902.61 309.24 902.1 309.87 902 L 342.74 902 C 343.42 902.17 343.88 902.8 343.86 903.51 L 343.86 932.58 C 341.61 931.31 339.07 930.69 336.51 930.76 C 340.3 926.42 341.19 920.13 338.75 914.85 C 336.31 909.56 331.03 906.32 325.37 906.64 C 319.72 906.96 314.81 910.77 312.94 916.3 C 311.07 921.83 312.61 927.98 316.83 931.87 L 319.95 928.55 C 321.01 927.62 322.52 927.49 323.71 928.21 C 324.9 928.94 325.52 930.36 325.26 931.77 L 323.65 935.45 C 324.99 935.66 326.35 935.68 327.7 935.5 L 327.7 947.94 L 309.85 947.94 C 309.3 947.87 308.83 947.48 308.65 946.93 Z M 310.11 904.52 C 310.25 904.96 310.64 905.25 311.09 905.25 C 311.53 905.25 311.93 904.96 312.06 904.52 C 312.2 904.08 312.05 903.61 311.69 903.34 C 311.33 903.07 310.85 903.07 310.49 903.34 C 310.13 903.61 309.98 904.08 310.11 904.52 Z M 340.31 904.52 C 340.44 904.96 340.84 905.25 341.28 905.25 C 341.73 905.25 342.12 904.96 342.26 904.52 C 342.39 904.08 342.24 903.61 341.88 903.34 C 341.53 903.07 341.04 903.07 340.68 903.34 C 340.33 903.61 340.17 904.08 340.31 904.52 Z M 319.66 922.25 C 319.21 919.56 320.34 916.85 322.55 915.35 C 324.76 913.85 327.61 913.85 329.82 915.35 C 332.03 916.85 333.16 919.56 332.71 922.25 C 332.16 925.53 329.41 927.93 326.19 927.93 C 322.96 927.93 320.21 925.53 319.66 922.25 Z M 321.12 922.2 C 321.6 924.75 323.77 926.6 326.28 926.6 C 328.8 926.6 330.96 924.75 331.45 922.2 C 331.85 920.04 330.97 917.85 329.2 916.63 C 327.43 915.41 325.13 915.41 323.37 916.63 C 321.6 917.85 320.71 920.04 321.12 922.2 Z M 322.05 921.39 C 321.93 921.08 322.03 920.72 322.29 920.52 C 322.55 920.32 322.91 920.32 323.17 920.52 C 323.43 920.72 323.53 921.08 323.41 921.39 C 323.3 921.69 323.03 921.88 322.73 921.88 C 322.43 921.88 322.15 921.69 322.05 921.39 Z M 323.17 918.87 C 322.96 918.56 323.02 918.14 323.29 917.89 C 323.57 917.64 323.98 917.64 324.26 917.89 C 324.53 918.14 324.59 918.56 324.38 918.87 C 324.25 919.09 324.02 919.21 323.77 919.21 C 323.53 919.21 323.3 919.09 323.17 918.87 Z M 325.6 917.72 C 325.45 917.4 325.54 917.02 325.8 916.8 C 326.07 916.58 326.45 916.58 326.71 916.8 C 326.98 917.02 327.06 917.4 326.92 917.72 C 326.79 917.98 326.54 918.14 326.26 918.14 C 325.98 918.14 325.72 917.98 325.6 917.72 Z M 328.13 918.72 C 328.02 918.41 328.12 918.05 328.38 917.85 C 328.64 917.65 328.99 917.65 329.26 917.85 C 329.52 918.05 329.61 918.41 329.5 918.72 C 329.39 919.02 329.12 919.21 328.82 919.21 C 328.51 919.21 328.24 919.02 328.13 918.72 Z M 329.16 921.39 C 329.01 921.08 329.09 920.69 329.36 920.47 C 329.62 920.25 330 920.25 330.27 920.47 C 330.54 920.69 330.62 921.08 330.47 921.39 C 330.35 921.65 330.09 921.82 329.81 921.82 C 329.53 921.82 329.28 921.65 329.16 921.39 Z M 328.08 923.96 C 327.97 923.65 328.07 923.29 328.33 923.09 C 328.59 922.88 328.95 922.88 329.21 923.09 C 329.47 923.29 329.57 923.65 329.45 923.96 C 329.34 924.25 329.07 924.45 328.77 924.45 C 328.46 924.45 328.19 924.25 328.08 923.96 Z M 325.65 925.12 C 325.5 924.8 325.58 924.42 325.85 924.2 C 326.12 923.98 326.5 923.98 326.76 924.2 C 327.03 924.42 327.11 924.8 326.96 925.12 C 326.84 925.38 326.59 925.55 326.31 925.55 C 326.03 925.55 325.77 925.38 325.65 925.12 Z M 323.07 923.96 C 322.95 923.65 323.05 923.29 323.31 923.09 C 323.57 922.88 323.93 922.88 324.19 923.09 C 324.45 923.29 324.55 923.65 324.43 923.96 C 324.32 924.25 324.05 924.45 323.75 924.45 C 323.45 924.45 323.18 924.25 323.07 923.96 Z M 324.24 921.49 C 324.05 920.63 324.4 919.73 325.11 919.24 C 325.82 918.74 326.75 918.74 327.46 919.24 C 328.17 919.73 328.51 920.63 328.33 921.49 C 328.12 922.49 327.27 923.2 326.28 923.2 C 325.3 923.2 324.45 922.49 324.24 921.49 Z M 311.77 938.87 C 310.76 940.05 310.49 941.71 311.05 943.17 C 311.61 944.62 312.92 945.63 314.43 945.77 C 315.94 945.9 317.4 945.14 318.2 943.81 L 324.09 931.57 C 324.23 930.65 323.79 929.75 323 929.31 C 322.21 928.88 321.24 929.02 320.58 929.65 Z M 313.08 942.15 C 312.83 941.36 313.09 940.48 313.74 939.99 C 314.4 939.5 315.28 939.5 315.93 939.99 C 316.58 940.48 316.85 941.36 316.59 942.15 C 316.34 942.92 315.63 943.45 314.84 943.45 C 314.04 943.45 313.34 942.92 313.08 942.15 Z M 329.84 935.3 C 330.56 933.96 333.42 933.01 336.73 933.01 C 340.04 933.01 342.9 933.96 343.62 935.3 L 343.62 949.1 C 343.62 950.7 340.54 952 336.73 952 C 332.92 952 329.84 950.7 329.84 949.1 Z M 331.79 935.55 C 331.79 936.45 333.99 937.18 336.71 937.18 C 339.42 937.18 341.62 936.45 341.62 935.55 C 341.62 934.65 339.42 933.92 336.71 933.92 C 333.99 933.92 331.79 934.65 331.79 935.55 Z" fill="#00bef2" stroke="none" pointer-events="all" style="fill: light-dark(rgb(0, 190, 242), rgb(0, 137, 182));"/></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-40"><g><rect x="317.28" y="992" width="230" height="50" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 1017px; margin-left: 432px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: nowrap; "><font style="font-size: 17px;">1- Retreive a Clean ntdll.dll</font><div><font style="font-size: 17px;">file from Disk</font></div></div></div></div></foreignObject><text x="432" y="1021" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">1- Retreive a Clean ntdll.dll...</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-41"><g><path d="M 343.88 927 L 371.98 927" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 377.23 927 L 370.23 930.5 L 371.98 927 L 370.23 923.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-42"><g><path d="M 471.34 880.57 L 471.34 992 L 378.34 992 L 378.34 862 L 458.06 862 Z" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 458.06 862 C 459.14 866.35 457.36 870.82 453.31 873.94 L 471.34 880.97" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-43"><g><path d="M 378.34 952 L 472.29 952" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-44"><g><rect x="397.13" y="952" width="80" height="40" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 972px; margin-left: 437px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: nowrap; "><b>clean .text</b><div><b>section</b></div></div></div></div></foreignObject><text x="437" y="976" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">clean .text...</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-45"><g><path d="M 383.1 975.67 C 383.25 975 383.63 974.43 384.14 974.12 C 384.65 973.81 385.24 973.78 385.77 974.03 C 386.55 974.49 387.14 975.3 387.44 976.29 C 388.82 971.48 390.92 967.03 393.62 963.17 C 394.39 962.31 395.46 962 396.46 962.35 C 396.71 962.4 396.93 962.6 397.03 962.89 C 397.13 963.19 397.11 963.52 396.96 963.78 C 393.28 968.88 390.55 974.9 388.95 981.42 C 388 982 386.89 982 385.94 981.42 C 385.23 979.47 384.27 977.67 383.1 976.08 C 383.04 975.96 383.04 975.8 383.1 975.67 Z" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-46"><g><path d="M 472.29 932 Q 519.27 932 509.87 917 Q 500.48 902 523.97 907 Q 547.45 912 552.15 902 Q 556.85 892 575.64 907 Q 594.43 922 608.52 937 Q 622.61 952 610.64 985.99" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 608.89 990.95 L 607.92 983.18 L 610.64 985.99 L 614.52 985.51 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-47"><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 945px; margin-left: 687px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; background-color: #ffffff; "><div style="display: inline-block; font-size: 11px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; background-color: light-dark(#ffffff, var(--ge-dark-color, #121212)); white-space: nowrap; "><div><div><br /></div></div></div></div></div></foreignObject><text x="687" y="948" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="11px" text-anchor="middle">&#xa;</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-48"><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 913px; margin-left: 620px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; background-color: #ffffff; "><div style="display: inline-block; font-size: 11px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; background-color: light-dark(#ffffff, var(--ge-dark-color, #121212)); white-space: nowrap; "><font style="font-size: 15px;"><b>2- Patch the .text section</b></font><div><span style="font-size: 15px;"><b>and <u>restore the modified protections</u><br /></b></span><div><br /></div></div></div></div></div></foreignObject><text x="620" y="916" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="11px" text-anchor="middle">2- Patch the .text section...</text></switch></g></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-49"><g><rect x="556.85" y="1052" width="84.55" height="30" fill="none" stroke="none" pointer-events="all"/><path d="M 556.85 1052 L 556.85 1057.25 C 558.65 1057.43 560 1058.58 560 1059.94 C 560 1061.3 558.65 1062.44 556.85 1062.63 L 556.85 1075.61 L 562.54 1075.61 L 562.54 1082 L 596.15 1082 L 596.17 1081.41 C 596.17 1080.65 596.45 1080.08 596.9 1079.72 C 597.35 1079.34 598.01 1079.12 599.09 1079.12 C 600.2 1079.12 600.88 1079.39 601.37 1079.78 C 601.84 1080.19 602.1 1080.76 602.1 1081.4 L 602.1 1082 L 635.71 1082 L 635.71 1075.61 L 641.4 1075.61 L 641.4 1062.62 C 639.67 1062.37 638.42 1061.25 638.42 1059.94 C 638.42 1058.63 639.67 1057.51 641.4 1057.26 L 641.4 1052 Z" fill="#005f4b" stroke="none" pointer-events="all" style="fill: light-dark(rgb(0, 95, 75), rgb(110, 192, 174));"/><path d="M 564.13 1075.61 L 634.12 1075.61 L 634.12 1080.81 L 603.42 1080.81 C 603.29 1080.16 603.16 1079.51 602.57 1079 C 601.8 1078.34 600.58 1077.93 599.09 1077.93 C 597.69 1077.93 596.49 1078.28 595.73 1078.91 C 595.13 1079.4 594.98 1080.11 594.83 1080.81 L 564.13 1080.81 Z M 623.51 1060.59 L 623.51 1067.01 L 630.01 1067.01 L 630.01 1060.59 Z M 608.38 1060.59 L 608.38 1067.01 L 614.88 1067.01 L 614.88 1060.59 Z M 583.37 1060.59 L 583.37 1067.01 L 589.87 1067.01 L 589.87 1060.59 Z M 568.25 1060.59 L 568.25 1067.01 L 574.74 1067.01 L 574.74 1060.59 Z M 621.91 1059.4 L 631.6 1059.4 L 631.6 1068.2 L 621.91 1068.2 Z M 606.78 1059.4 L 616.48 1059.4 L 616.48 1068.2 L 606.78 1068.2 Z M 581.77 1059.4 L 591.47 1059.4 L 591.47 1068.2 L 581.77 1068.2 Z M 566.65 1059.4 L 576.34 1059.4 L 576.34 1068.2 L 566.65 1068.2 Z" fill="#ffffff" stroke="none" pointer-events="all" style="fill: light-dark(rgb(255, 255, 255), rgb(18, 18, 18));"/></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-50"><g><path d="M 622.33 997.71 L 622.33 1032 L 594.43 1032 L 594.43 992 L 618.34 992 Z" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 618.34 992 C 618.67 993.34 618.13 994.71 616.92 995.67 L 622.33 997.84" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-51"><g><rect x="509.87" y="1022" width="180" height="40" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 1042px; margin-left: 600px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: nowrap; "><font style="font-size: 18px;"><b>in-memory ntdll.dll</b></font></div></div></div></foreignObject><text x="600" y="1046" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">in-memory ntdll.dll</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-52"><g><image x="437.37" y="1101.5" width="48.26" height="57.94" xlink:href="https://app.diagrams.net/img/lib/azure2/other/Resource_Guard.svg"/></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-53"><g><rect x="413.53" y="1170" width="110" height="40" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 1190px; margin-left: 469px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: nowrap; "><font style="font-size: 20px;">EDR / AV</font></div></div></div></foreignObject><text x="469" y="1194" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">EDR / AV</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-54"><g><path d="M 492.71 1141.29 Q 575.64 1132 591.54 1087.99" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 487.5 1141.88 L 494.06 1137.62 L 492.71 1141.29 L 494.84 1144.57 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 593.33 1083.05 L 594.24 1090.82 L 591.54 1087.99 L 587.65 1088.45 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-55"><g><image x="466.37" y="36.78" width="43" height="43" xlink:href="https://cdn1.iconfinder.com/data/icons/ninja-things-1/720/ninja-background-128.png" preserveAspectRatio="none"/></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-56"><g><rect x="512.45" y="33.64" width="560" height="50.28" rx="7.54" ry="7.54" fill="#f8cecc" stroke="#b85450" pointer-events="all" style="fill: light-dark(rgb(248, 206, 204), rgb(81, 45, 43)); stroke: light-dark(rgb(184, 84, 80), rgb(215, 129, 126));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 558px; height: 1px; padding-top: 59px; margin-left: 513px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font style="font-size: 21px;">Detecting hooked syscalls within ntdll.dll</font></div></div></div></foreignObject><text x="792" y="62" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Detecting hooked syscalls within ntdll.dll</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-57"><g><path d="M 221.61 470 Q 274.11 470 279.56 300 Q 285 130 462.24 208.05" fill="none" stroke="#b85450" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(184, 84, 80), rgb(215, 129, 126));"/><path d="M 467.05 210.16 L 459.23 210.55 L 462.24 208.05 L 462.05 204.14 Z" fill="#b85450" stroke="#b85450" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(184, 84, 80), rgb(215, 129, 126)); stroke: light-dark(rgb(184, 84, 80), rgb(215, 129, 126));"/></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-58"><g><path d="M 605.5 545 L 605.5 535 L 698.91 535 L 698.91 531.64 L 738.1 540 L 698.91 548.36 L 698.91 545 Z" fill="#f8cecc" stroke="#b85450" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(248, 206, 204), rgb(81, 45, 43)); stroke: light-dark(rgb(184, 84, 80), rgb(215, 129, 126));"/></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-59"><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 541px; margin-left: 659px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; background-color: #ffffff; "><div style="display: inline-block; font-size: 11px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; background-color: light-dark(#ffffff, var(--ge-dark-color, #121212)); white-space: nowrap; "><font style="font-size: 18px;">Solution</font></div></div></div></foreignObject><text x="659" y="544" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="11px" text-anchor="middle">Solution</text></switch></g></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-60"><g/><g data-cell-id="tEqawAXD5UkgbRX-SCwM-61"><g><rect x="472.29" y="88.4" width="602.71" height="281.6" rx="42.24" ry="42.24" fill="#f8cecc" stroke="#b85450" pointer-events="all" style="fill: light-dark(rgb(248, 206, 204), rgb(81, 45, 43)); stroke: light-dark(rgb(184, 84, 80), rgb(215, 129, 126));"/></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-62"><g><rect x="482.45" y="150" width="70" height="30" fill="none" stroke="none" pointer-events="all"/><path d="M 482.45 150 L 482.45 155.25 C 483.94 155.43 485.06 156.58 485.06 157.94 C 485.06 159.3 483.94 160.44 482.45 160.63 L 482.45 173.61 L 487.16 173.61 L 487.16 180 L 514.99 180 L 515.01 179.41 C 515.01 178.65 515.24 178.08 515.61 177.72 C 515.98 177.34 516.52 177.12 517.42 177.12 C 518.34 177.12 518.91 177.39 519.31 177.78 C 519.7 178.19 519.91 178.76 519.91 179.4 L 519.91 180 L 547.74 180 L 547.74 173.61 L 552.45 173.61 L 552.45 160.62 C 551.02 160.37 549.98 159.25 549.98 157.94 C 549.98 156.63 551.02 155.51 552.45 155.26 L 552.45 150 Z" fill="#005f4b" stroke="none" pointer-events="all" style="fill: light-dark(rgb(0, 95, 75), rgb(110, 192, 174));"/><path d="M 488.48 173.61 L 546.42 173.61 L 546.42 178.81 L 521 178.81 C 520.9 178.16 520.79 177.51 520.3 177 C 519.66 176.34 518.66 175.93 517.42 175.93 C 516.26 175.93 515.27 176.28 514.64 176.91 C 514.14 177.4 514.02 178.11 513.9 178.81 L 488.48 178.81 Z M 537.64 158.59 L 537.64 165.01 L 543.01 165.01 L 543.01 158.59 Z M 525.11 158.59 L 525.11 165.01 L 530.49 165.01 L 530.49 158.59 Z M 504.41 158.59 L 504.41 165.01 L 509.79 165.01 L 509.79 158.59 Z M 491.89 158.59 L 491.89 165.01 L 497.26 165.01 L 497.26 158.59 Z M 536.31 157.4 L 544.34 157.4 L 544.34 166.2 L 536.31 166.2 Z M 523.79 157.4 L 531.82 157.4 L 531.82 166.2 L 523.79 166.2 Z M 503.08 157.4 L 511.11 157.4 L 511.11 166.2 L 503.08 166.2 Z M 490.56 157.4 L 498.59 157.4 L 498.59 166.2 L 490.56 166.2 Z" fill="#ffffff" stroke="none" pointer-events="all" style="fill: light-dark(rgb(255, 255, 255), rgb(18, 18, 18));"/></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-63"><g><rect x="685" y="118" width="160" height="114" fill="#ffffff" stroke="none" pointer-events="none" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212));"/><path d="M 685 118 L 845 118 L 845 232 L 685 232 L 685 118" fill="none" stroke="#000000" stroke-linecap="square" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 685 133 L 845 133" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 685 160 L 845 160" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 685 182 L 845 182" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 685 202 L 845 202" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 685 217 L 845 217" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-64"><g/><g data-cell-id="tEqawAXD5UkgbRX-SCwM-65"><g><rect x="685" y="118" width="160" height="15" fill="none" stroke="none" pointer-events="all"/><path d="M 685 118 M 845 118 M 845 133 M 685 133" fill="none" stroke="#000000" stroke-linecap="square" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 158px; height: 1px; padding-top: 126px; margin-left: 686px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; max-height: 11px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Nt*...</div></div></div></foreignObject><text x="765" y="129" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Nt*...</text></switch></g></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-66"><g/><g data-cell-id="tEqawAXD5UkgbRX-SCwM-67"><g><rect x="685" y="133" width="160" height="27" fill="none" stroke="none" pointer-events="all"/><path d="M 685 133 M 845 133 M 845 160 M 685 160" fill="none" stroke="#000000" stroke-linecap="square" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 158px; height: 1px; padding-top: 147px; margin-left: 686px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; max-height: 23px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Nt*...</div></div></div></foreignObject><text x="765" y="150" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Nt*...</text></switch></g></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-68"><g/><g data-cell-id="tEqawAXD5UkgbRX-SCwM-69"><g><rect x="685" y="160" width="160" height="22" fill="none" stroke="none" pointer-events="all"/><path d="M 685 160 M 845 160 M 845 182 M 685 182" fill="none" stroke="#000000" stroke-linecap="square" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 158px; height: 1px; padding-top: 171px; margin-left: 686px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; max-height: 18px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Zw*...</div></div></div></foreignObject><text x="765" y="175" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Zw*...</text></switch></g></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-70"><g/><g data-cell-id="tEqawAXD5UkgbRX-SCwM-71"><g><rect x="685" y="182" width="160" height="20" fill="none" stroke="none" pointer-events="all"/><path d="M 685 182 M 845 182 M 845 202 M 685 202" fill="none" stroke="#000000" stroke-linecap="square" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 158px; height: 1px; padding-top: 192px; margin-left: 686px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; max-height: 16px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Zw*...</div></div></div></foreignObject><text x="765" y="196" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Zw*...</text></switch></g></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-72"><g/><g data-cell-id="tEqawAXD5UkgbRX-SCwM-73"><g><rect x="685" y="202" width="160" height="15" fill="none" stroke="none" pointer-events="all"/><path d="M 685 202 M 845 202 M 845 217 M 685 217" fill="none" stroke="#000000" stroke-linecap="square" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 158px; height: 1px; padding-top: 210px; margin-left: 686px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; max-height: 11px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Nt*...</div></div></div></foreignObject><text x="765" y="213" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Nt*...</text></switch></g></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-74"><g/><g data-cell-id="tEqawAXD5UkgbRX-SCwM-75"><g><rect x="685" y="217" width="160" height="15" fill="none" stroke="none" pointer-events="all"/><path d="M 685 217 M 845 217 M 845 232 M 685 232" fill="none" stroke="#000000" stroke-linecap="square" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 158px; height: 1px; padding-top: 225px; margin-left: 686px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; max-height: 11px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">...</div></div></div></foreignObject><text x="765" y="228" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">...</text></switch></g></g></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-76"><g><path d="M 552.45 161.14 Q 552.45 161.14 678.67 147.2" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 683.89 146.62 L 677.32 150.87 L 678.67 147.2 L 676.55 143.91 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-77"><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 151px; margin-left: 616px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; background-color: #ffffff; "><div style="display: inline-block; font-size: 11px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; background-color: light-dark(#ffffff, var(--ge-dark-color, #121212)); white-space: nowrap; "><font style="font-size: 16px;">Load ntdll.dll</font><div><font style="font-size: 16px;">export table</font></div></div></div></div></foreignObject><text x="616" y="154" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="11px" text-anchor="middle">Load ntdll.dll...</text></switch></g></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-78"><g><path d="M 865 115 L 860 115 Q 855 115 855 125 L 855 165 Q 855 175 850 175 L 847.5 175 Q 845 175 850 175 L 852.5 175 Q 855 175 855 185 L 855 225 Q 855 235 860 235 L 865 235" fill="none" stroke="#000000" stroke-miterlimit="10" transform="translate(855,0)scale(-1,1)translate(-855,0)" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-79"><g><rect x="865" y="180" width="210" height="30" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 208px; height: 1px; padding-top: 195px; margin-left: 866px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font style="font-size: 16px;"><b>Loop through the Nt* and Zw* functions</b></font><div><font style="font-size: 16px;"><b>and check their syscalls stubs if they start with a redirection</b></font></div></div></div></div></foreignObject><text x="970" y="199" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Loop through the Nt* and Zw* functi...</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-80"><g><rect x="514.53" y="250" width="490.47" height="110" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 488px; height: 1px; padding-top: 305px; margin-left: 516px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><ul><li><font style="font-size: 17px;">Good before doing direct/indirect syscall.</font></li><li><font style="font-size: 17px;">Good to verify if an unhooking routine went correctly.</font></li><li><font style="font-size: 17px;">Not good against total API re-implementation.</font></li><li><font style="font-size: 17px;">Limited to inline hooking and not IAT and SSDT hooks.</font></li></ul></div></div></div></foreignObject><text x="760" y="309" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Good before doing direct/indirect syscall.Good to verify if an unhooking routine w...</text></switch></g></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-81"><g><image x="784.5" y="463.22" width="36.28" height="36.28" xlink:href="https://cdn1.iconfinder.com/data/icons/ninja-things-1/720/ninja-background-128.png" preserveAspectRatio="none"/></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-82"><g><rect x="825" y="459.72" width="440" height="50.28" rx="7.54" ry="7.54" fill="#f8cecc" stroke="#b85450" pointer-events="all" style="fill: light-dark(rgb(248, 206, 204), rgb(81, 45, 43)); stroke: light-dark(rgb(184, 84, 80), rgb(215, 129, 126));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 438px; height: 1px; padding-top: 485px; margin-left: 826px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font style="font-size: 21px;"><b>Direct Syscalls</b></font></div></div></div></foreignObject><text x="1045" y="488" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Direct Syscalls</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-83"><g><path d="M 1039 890.51 L 1049 890.49 L 1049.1 950.31 L 1052.46 950.3 L 1044.17 989.5 L 1035.75 950.33 L 1039.1 950.32 Z" fill="#f8cecc" stroke="#b85450" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(248, 206, 204), rgb(81, 45, 43)); stroke: light-dark(rgb(184, 84, 80), rgb(215, 129, 126));"/></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-84"><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 916px; margin-left: 1060px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; background-color: #ffffff; "><div style="display: inline-block; font-size: 11px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; background-color: light-dark(#ffffff, var(--ge-dark-color, #121212)); white-space: nowrap; "><font style="font-size: 18px;">Solution</font></div></div></div></foreignObject><text x="1060" y="919" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="11px" text-anchor="middle">Solution</text></switch></g></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-85"><g/><g data-cell-id="tEqawAXD5UkgbRX-SCwM-86"><g><rect x="785" y="520" width="490" height="360" rx="54" ry="54" fill="#f8cecc" stroke="#b85450" pointer-events="all" style="fill: light-dark(rgb(248, 206, 204), rgb(81, 45, 43)); stroke: light-dark(rgb(184, 84, 80), rgb(215, 129, 126));"/></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-87"><g><path d="M 1204.49 621.79 L 1204.49 677.5 L 1155 677.5 L 1155 612.5 L 1197.42 612.5 Z" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1197.42 612.5 C 1198 614.67 1197.05 616.91 1194.9 618.47 L 1204.49 621.98" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 48px; height: 1px; padding-top: 645px; margin-left: 1156px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font style="font-size: 17px;"><b>*.cpp</b></font></div></div></div></foreignObject><text x="1180" y="649" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">*.cpp</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-88"><g><path d="M 1044.49 621.79 L 1044.49 677.5 L 995 677.5 L 995 612.5 L 1037.42 612.5 Z" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1037.42 612.5 C 1038 614.67 1037.05 616.91 1034.9 618.47 L 1044.49 621.98" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 48px; height: 1px; padding-top: 645px; margin-left: 996px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font style="font-size: 18px;"><b>*.h</b></font></div></div></div></foreignObject><text x="1020" y="649" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">*.h</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-89"><g><path d="M 874.49 621.79 L 874.49 677.5 L 825 677.5 L 825 612.5 L 867.42 612.5 Z" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 867.42 612.5 C 868 614.67 867.05 616.91 864.9 618.47 L 874.49 621.98" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 48px; height: 1px; padding-top: 645px; margin-left: 826px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font style="font-size: 18px;"><b>*.asm</b></font></div></div></div></foreignObject><text x="850" y="649" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">*.asm</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-90"><g><rect x="855" y="540" width="340" height="50" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 565px; margin-left: 1025px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: nowrap; "><font style="font-size: 17px;"><b>Avoid the hooked ntdll.dll and call</b></font><div><font style="font-size: 17px;"><b>the target syscall</b></font><b style="font-size: 17px; background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">directly with its SSN.</b></div></div></div></div></foreignObject><text x="1025" y="569" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Avoid the hooked ntdll.dll and call...</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-91"><g><rect x="775" y="670" width="160" height="90" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 715px; margin-left: 855px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: nowrap; "><b><font style="font-size: 15px;">Syscall stub that<br />prepares the</font></b><div><b style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><font style="font-size: 15px;">parameters in the</font></b><div><b><font style="font-size: 15px;">correct registers</font></b></div></div></div></div></div></foreignObject><text x="855" y="719" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Syscall stub that...</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-92"><g><rect x="935" y="680" width="170" height="70" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 715px; margin-left: 1020px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: nowrap; "><b><font style="font-size: 15px;">Header file with the</font></b><div><div><b><font style="font-size: 15px;">external function</font></b></div><div><b><font style="font-size: 15px;">declarations</font></b></div></div></div></div></div></foreignObject><text x="1020" y="719" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Header file with the...</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-93"><g><rect x="1110" y="674.38" width="140" height="90" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 719px; margin-left: 1180px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: nowrap; "><b><font style="font-size: 15px;">The code that</font></b><div><b><font style="font-size: 15px;">retrieves</font></b><div><b><font style="font-size: 15px;">the SSN and call</font></b></div><div><b><font style="font-size: 15px;">the syscalls</font></b></div></div></div></div></div></foreignObject><text x="1180" y="723" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">The code that...</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-94"><g><path d="M 827.62 570.97 C 827.91 569.87 828.65 568.95 829.64 568.45 C 830.64 567.94 831.8 567.89 832.83 568.31 C 834.34 569.05 835.5 570.37 836.09 571.97 C 838.78 564.16 842.87 556.93 848.14 550.65 C 849.64 549.25 851.74 548.75 853.68 549.31 C 854.18 549.39 854.6 549.73 854.8 550.2 C 855 550.68 854.95 551.22 854.66 551.65 C 847.49 559.93 842.15 569.71 839.02 580.3 C 837.18 581.25 835 581.25 833.16 580.3 C 831.76 577.14 829.89 574.21 827.62 571.64 C 827.5 571.43 827.5 571.18 827.62 570.97 Z" fill="#d5e8d4" stroke="#82b366" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(213, 232, 212), rgb(31, 47, 30)); stroke: light-dark(rgb(130, 179, 102), rgb(68, 110, 44));"/></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-95"><g><rect x="815" y="760" width="490" height="100" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 488px; height: 1px; padding-top: 767px; margin-left: 817px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 16px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">SSNs are version-dependant. Look for Hell's Gate method.<br />Atypical behaviour of the syscall instructions since they execute<br />outside of the ntdll.dll.<br />The return address after the syscall points back to non-standard<br />memory region.</div></div></div></foreignObject><text x="817" y="783" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="16px">SSNs are version-dependant. Look for Hell's Gate method....</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-96"><g><path d="M 796.37 823 L 801.86 829.8 L 807.35 823 L 808.72 824.7 L 803.23 831.5 L 808.72 838.3 L 807.35 840 L 801.86 833.2 L 796.37 840 L 795 838.3 L 800.49 831.5 L 795 824.7 Z" fill="#ff0000" stroke="none" pointer-events="all" style="fill: light-dark(rgb(255, 0, 0), rgb(255, 144, 144));"/></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-97"><g><path d="M 796.37 790 L 801.86 796.8 L 807.35 790 L 808.72 791.7 L 803.23 798.5 L 808.72 805.3 L 807.35 807 L 801.86 800.2 L 796.37 807 L 795 805.3 L 800.49 798.5 L 795 791.7 Z" fill="#ff0000" stroke="none" pointer-events="all" style="fill: light-dark(rgb(255, 0, 0), rgb(255, 144, 144));"/></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-98"><g><path d="M 796.37 764.38 L 801.86 771.18 L 807.35 764.38 L 808.72 766.08 L 803.23 772.88 L 808.72 779.68 L 807.35 781.38 L 801.86 774.58 L 796.37 781.38 L 795 779.68 L 800.49 772.88 L 795 766.08 Z" fill="#ff0000" stroke="none" pointer-events="all" style="fill: light-dark(rgb(255, 0, 0), rgb(255, 144, 144));"/></g></g></g><g data-cell-id="sD_lDuidbchsZRyquxOI-5"><g><rect x="205" y="1573.73" width="491.69" height="53.74" rx="8.06" ry="8.06" fill="#f8cecc" stroke="#b85450" pointer-events="all" style="fill: light-dark(rgb(248, 206, 204), rgb(81, 45, 43)); stroke: light-dark(rgb(184, 84, 80), rgb(215, 129, 126));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 490px; height: 1px; padding-top: 1601px; margin-left: 206px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font style="font-size: 21px;"><b>LSASS Dumping</b></font></div></div></div></foreignObject><text x="451" y="1604" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">LSASS Dumping</text></switch></g></g></g><g data-cell-id="sD_lDuidbchsZRyquxOI-6"><g><image x="124.5" y="1571.36" width="57.47" height="57.47" xlink:href="https://cdn1.iconfinder.com/data/icons/ninja-things-1/720/ninja-background-128.png" preserveAspectRatio="none"/></g></g><g data-cell-id="sD_lDuidbchsZRyquxOI-21"><g/><g data-cell-id="sD_lDuidbchsZRyquxOI-15"><g><path d="M 398.77 1728.94 L 398.77 1673.79 C 398.77 1666.17 412.42 1660 429.26 1660 C 446.11 1660 459.76 1666.17 459.76 1673.79 L 459.76 1728.94 C 459.76 1736.55 446.11 1742.73 429.26 1742.73 C 412.42 1742.73 398.77 1736.55 398.77 1728.94 Z" fill="#ffffff" stroke="#000000" stroke-width="2" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 398.77 1673.79 C 398.77 1681.4 412.42 1687.58 429.26 1687.58 C 446.11 1687.58 459.76 1681.4 459.76 1673.79" fill="none" stroke="#000000" stroke-width="2" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="sD_lDuidbchsZRyquxOI-16"><g><rect x="335" y="1742.73" width="170" height="40" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 1763px; margin-left: 420px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: nowrap; "><font style="font-size: 20px;"><b style="">LSASS Process</b></font></div></div></div></foreignObject><text x="420" y="1766" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">LSASS Process</text></switch></g></g></g></g><g data-cell-id="sD_lDuidbchsZRyquxOI-10"><g><path d="M 335 1766.99 Q 275 1770 215 1760 Q 155 1750 193.36 1893.85" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 194.71 1898.92 L 189.53 1893.06 L 193.36 1893.85 L 196.29 1891.25 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="sD_lDuidbchsZRyquxOI-24"><g><path d="M 502.28 1768.01 Q 605 1768 650 1759 Q 695 1750 695 1780 Q 695 1810 666.83 1903.9" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 665.32 1908.93 L 663.98 1901.22 L 666.83 1903.9 L 670.69 1903.23 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g data-cell-id="sD_lDuidbchsZRyquxOI-26"><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 1821px; margin-left: 203px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; background-color: #ffffff; "><div style="display: inline-block; font-size: 11px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; background-color: light-dark(#ffffff, var(--ge-dark-color, #121212)); white-space: nowrap; "><font style="font-size: 26px;">MiniDumpWriteDump</font><div><font style="font-size: 26px;">+</font></div><div><font style="font-size: 26px;">SeDebugPrivilege</font></div></div></div></div></foreignObject><text x="203" y="1824" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="11px" text-anchor="middle">MiniDumpWriteDump...</text></switch></g></g></g><g data-cell-id="sD_lDuidbchsZRyquxOI-31"><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 1821px; margin-left: 676px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; background-color: #ffffff; "><div style="display: inline-block; font-size: 11px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; background-color: light-dark(#ffffff, var(--ge-dark-color, #121212)); white-space: nowrap; "><font style="font-size: 26px;">PssCaptureSnapshot</font><div><font style="font-size: 26px;">+</font></div><div><font style="font-size: 26px;">MiniDumpWriteDump</font></div></div></div></div></foreignObject><text x="676" y="1824" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="11px" text-anchor="middle">PssCaptureSnapshot...</text></switch></g></g></g></g><g data-cell-id="sD_lDuidbchsZRyquxOI-29"><g><path d="M 224.36 1931.43 L 224.36 2000 L 161.61 2000 L 161.61 1920 L 215.4 1920 Z" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 215.4 1920 C 216.13 1922.67 214.92 1925.43 212.19 1927.35 L 224.36 1931.67" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="sD_lDuidbchsZRyquxOI-30"><g><rect x="55.18" y="2000" width="320" height="100" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 2050px; margin-left: 215px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: nowrap; "><font style="font-size: 23px;">Directly create a *.dmp file</font><div><font style="font-size: 23px;">saved on the disk containing</font></div><div><font style="font-size: 23px;">its content.</font></div></div></div></div></foreignObject><text x="215" y="2054" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Directly create a *.dmp file...</text></switch></g></g></g><g data-cell-id="sD_lDuidbchsZRyquxOI-32"><g><path d="M 625 1930 C 625 1916.67 689.87 1916.67 689.87 1930 L 689.87 1990 C 689.87 2003.33 625 2003.33 625 1990 Z" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 625 1930 C 625 1940 689.87 1940 689.87 1930 M 625 1935 C 625 1945 689.87 1945 689.87 1935 M 625 1940 C 625 1950 689.87 1950 689.87 1940" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="sD_lDuidbchsZRyquxOI-33"><g><rect x="493.67" y="2010" width="340" height="120" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 2070px; margin-left: 664px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: nowrap; "><font style="font-size: 23px;">Create a read-only clone of the</font><div><font style="font-size: 23px;">lsass.exe and only then</font><div><font style="font-size: 23px;">dump its memory usinng</font></div><div><font style="font-size: 23px;">MiniDumpWriteDump</font></div></div></div></div></div></foreignObject><text x="664" y="2074" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Create a read-only clone of the...</text></switch></g></g></g><g data-cell-id="sD_lDuidbchsZRyquxOI-34"><g/><g data-cell-id="tEqawAXD5UkgbRX-SCwM-99"><g><rect x="845" y="1010" width="440" height="50.28" rx="7.54" ry="7.54" fill="#f8cecc" stroke="#b85450" pointer-events="all" style="fill: light-dark(rgb(248, 206, 204), rgb(81, 45, 43)); stroke: light-dark(rgb(184, 84, 80), rgb(215, 129, 126));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 438px; height: 1px; padding-top: 1035px; margin-left: 846px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font style="font-size: 21px;"><b>Indirect Syscalls</b></font></div></div></div></foreignObject><text x="1065" y="1039" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Indirect Syscalls</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-100"><g><image x="804.5" y="1016.5" width="36.28" height="36.28" xlink:href="https://cdn1.iconfinder.com/data/icons/ninja-things-1/720/ninja-background-128.png" preserveAspectRatio="none"/></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-101"><g><rect x="839.42" y="1080.28" width="453.72" height="328" rx="49.2" ry="49.2" fill="#f8cecc" stroke="#b85450" pointer-events="all" style="fill: light-dark(rgb(248, 206, 204), rgb(81, 45, 43)); stroke: light-dark(rgb(184, 84, 80), rgb(215, 129, 126));"/></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-102"><g><rect x="840" y="1108.28" width="450" height="110" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 1163px; margin-left: 1065px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: nowrap; "><div style="text-align: left;"><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><font style="font-size: 20px;">Instead of manually calling a syscall by its SSN</font></span></div><div><font style="font-size: 20px;"><font style="">within our payload we will</font><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><font style="">find the address of a</font></span></font></div><div><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><font style="font-size: 20px;">target syscall instruction residing within ntdll.dll</font></span></div><div><font style="font-size: 20px;"><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><font style="">and jump</font></span><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><font style="">to that instruction</font></span></font></div></div></div></div></foreignObject><text x="1065" y="1167" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Instead of manually calling a syscall by its SSN...</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-103"><g><path d="M 845.12 1260.5 C 845.41 1259.4 846.15 1258.48 847.14 1257.98 C 848.14 1257.47 849.3 1257.42 850.33 1257.84 C 851.84 1258.58 853 1259.9 853.59 1261.5 C 856.28 1253.69 860.37 1246.46 865.64 1240.18 C 867.14 1238.78 869.24 1238.28 871.18 1238.84 C 871.68 1238.92 872.1 1239.26 872.3 1239.73 C 872.5 1240.21 872.45 1240.75 872.16 1241.18 C 864.99 1249.46 859.65 1259.24 856.52 1269.83 C 854.68 1270.78 852.5 1270.78 850.66 1269.83 C 849.26 1266.67 847.39 1263.74 845.12 1261.17 C 845 1260.96 845 1260.71 845.12 1260.5 Z" fill="#d5e8d4" stroke="#82b366" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(213, 232, 212), rgb(31, 47, 30)); stroke: light-dark(rgb(130, 179, 102), rgb(68, 110, 44));"/></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-104"><g><rect x="873.14" y="1229.53" width="420" height="50" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 1255px; margin-left: 1083px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: nowrap; "><b><font style="font-size: 16px;">The return address will be in a normal and expected</font></b><div style="text-align: left;"><b><font style="font-size: 16px;">memory region.</font></b></div></div></div></div></foreignObject><text x="1083" y="1258" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">The return address will be in a normal and expected...</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-105"><g><rect x="885" y="1279.53" width="420" height="50" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 1305px; margin-left: 887px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: nowrap; "><b><font style="font-size: 16px;">Better in avoiding memory inspection and</font></b><b style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><font style="font-size: 16px;">call stack</font></b><div><b style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><font style="font-size: 16px;">red flags.</font></b></div></div></div></div></foreignObject><text x="887" y="1308" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px">Better in avoiding memory inspection andcall stack...</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-106"><g><path d="M 845.12 1310.5 C 845.41 1309.4 846.15 1308.48 847.14 1307.98 C 848.14 1307.47 849.3 1307.42 850.33 1307.84 C 851.84 1308.58 853 1309.9 853.59 1311.5 C 856.28 1303.69 860.37 1296.46 865.64 1290.18 C 867.14 1288.78 869.24 1288.28 871.18 1288.84 C 871.68 1288.92 872.1 1289.26 872.3 1289.73 C 872.5 1290.21 872.45 1290.75 872.16 1291.18 C 864.99 1299.46 859.65 1309.24 856.52 1319.83 C 854.68 1320.78 852.5 1320.78 850.66 1319.83 C 849.26 1316.67 847.39 1313.74 845.12 1311.17 C 845 1310.96 845 1310.71 845.12 1310.5 Z" fill="#d5e8d4" stroke="#82b366" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(213, 232, 212), rgb(31, 47, 30)); stroke: light-dark(rgb(130, 179, 102), rgb(68, 110, 44));"/></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-107"><g><rect x="885" y="1329.53" width="390" height="50" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 1355px; margin-left: 887px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: nowrap; "><font style="font-size: 16px;"><b style="">Isn't that strong against ETW+ Kernel callbacks</b></font><div><font style="font-size: 16px;"><b style="">protections.</b></font></div></div></div></div></foreignObject><text x="887" y="1358" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px">Isn't that strong against ETW+ Kernel callbacks...</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-108"><g><path d="M 848.36 1339.53 L 861.8 1351.53 L 875.24 1339.53 L 878.6 1342.53 L 865.16 1354.53 L 878.6 1366.53 L 875.24 1369.53 L 861.8 1357.53 L 848.36 1369.53 L 845 1366.53 L 858.44 1354.53 L 845 1342.53 Z" fill="#ff0000" stroke="none" pointer-events="all" style="fill: light-dark(rgb(255, 0, 0), rgb(255, 144, 144));"/></g></g></g><g data-cell-id="sD_lDuidbchsZRyquxOI-36"><g><rect x="105" y="2130" width="680" height="220" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 2240px; margin-left: 107px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: nowrap; "><font style="font-size: 25px;">The LSASS process is a critical Windows process since :</font><div style=""><font style="font-size: 25px;">- It caches passwords in memory.</font></div><div style=""><font style="font-size: 25px;">- Creates access tokens.</font></div><div style=""><font style="font-size: 25px;">- Enforces security policy.</font></div><div style=""><font style="font-size: 25px;">- Writes to windows logs.</font></div><div style=""><span style="font-size: 25px;">Dumping its memory could lead to obtaining very sensitive</span></div><div style=""><span style="font-size: 25px;">data to be used later with offline tools like mimikataz.</span></div></div></div></div></foreignObject><text x="107" y="2244" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px">The LSASS process is a critical Windows process since :...</text></switch></g></g></g></g></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://www.drawio.com/doc/faq/svg-export-text-problems" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Text is not SVG - cannot display</text></a></switch></svg>