<mxfile host="app.diagrams.net" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/137.0.0.0 Safari/537.36" version="27.1.4">
  <diagram name="Page-1" id="MYQSJNCdZhOi3zPZW-Wj">
    <mxGraphModel dx="1840" dy="2056" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="sD_lDuidbchsZRyquxOI-35" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="1">
          <mxGeometry x="60" y="1363.73" width="790" height="716.27" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-1" value="" style="shape=partialRectangle;whiteSpace=wrap;html=1;top=0;left=0;fillColor=none;dashed=1;dashPattern=8 8;" parent="1" vertex="1">
          <mxGeometry x="143.75" y="-290" width="126.25" height="870" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-2" value="" style="ellipse;whiteSpace=wrap;html=1;rotation=-90;shadow=0;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="339.17999999999995" y="152" width="280" height="270.82" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-3" value="&lt;font style=&quot;font-size: 18px;&quot;&gt;shell.exe&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="116.61" y="40" width="110" height="30" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-4" value="&lt;font style=&quot;font-size: 18px;&quot;&gt;kernel32.dll&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="116.61" y="110" width="110" height="30" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-5" value="&lt;font style=&quot;font-size: 18px;&quot;&gt;ntdll.dll&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="116.61" y="180" width="110" height="30" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-6" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="tEqawAXD5UkgbRX-SCwM-3" target="tEqawAXD5UkgbRX-SCwM-4" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="400" y="250" as="sourcePoint" />
            <mxPoint x="450" y="200" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-7" value="&lt;b&gt;ReadProcessMemory&lt;/b&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="tEqawAXD5UkgbRX-SCwM-6" vertex="1" connectable="0">
          <mxGeometry x="-0.1371" y="-1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-8" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="tEqawAXD5UkgbRX-SCwM-4" target="tEqawAXD5UkgbRX-SCwM-5" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="400" y="250" as="sourcePoint" />
            <mxPoint x="450" y="200" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-9" value="&lt;b&gt;NtReadVirtualMemory&lt;/b&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="tEqawAXD5UkgbRX-SCwM-8" vertex="1" connectable="0">
          <mxGeometry x="-0.0871" y="-2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-10" value="" style="shape=internalStorage;whiteSpace=wrap;html=1;backgroundOutline=1;align=center;" parent="1" vertex="1">
          <mxGeometry x="116.61" y="390" width="110" height="110" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-11" value="" style="endArrow=classic;html=1;rounded=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" parent="1" source="tEqawAXD5UkgbRX-SCwM-5" target="tEqawAXD5UkgbRX-SCwM-10" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="118" y="210" as="sourcePoint" />
            <mxPoint x="115" y="261" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-12" value="&lt;b&gt;Syscall&lt;/b&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="tEqawAXD5UkgbRX-SCwM-11" vertex="1" connectable="0">
          <mxGeometry x="-0.6685" y="2" relative="1" as="geometry">
            <mxPoint x="-2" y="110" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-13" value="Pointers&amp;nbsp;&lt;br&gt;to the&amp;nbsp;&lt;br&gt;corresponding&amp;nbsp;&lt;br&gt;kernel&lt;br&gt;function" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="126.61" y="410" width="102.5" height="90" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-14" value="&lt;b&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;Nt!NtReadVirtualMemory&lt;/font&gt;&lt;/b&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="84.92" y="530" width="173.39" height="30" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-15" value="" style="endArrow=classic;html=1;rounded=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" parent="1" source="tEqawAXD5UkgbRX-SCwM-10" target="tEqawAXD5UkgbRX-SCwM-14" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="120" y="430" as="sourcePoint" />
            <mxPoint x="118" y="480" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-16" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;rounded=0;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="38.33" y="610" as="sourcePoint" />
            <mxPoint x="38" y="-160" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-17" value="" style="endArrow=none;html=1;rounded=0;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="10" y="370" as="sourcePoint" />
            <mxPoint x="270" y="370" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-18" value="&lt;font style=&quot;font-size: 14px;&quot;&gt;&lt;b&gt;User-Mode&lt;/b&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;rotation=-90;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="-48.12" y="58.12" width="132.5" height="26.25" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-19" value="&lt;font style=&quot;font-size: 14px;&quot;&gt;&lt;b&gt;Kernel-mode&lt;/b&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;rotation=-90;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="-41.87" y="451.88" width="116.25" height="22.5" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-20" value="&lt;b&gt;Syscall Table&lt;/b&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="139.11" y="390" width="90" height="20" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-21" value="" style="shape=image;verticalLabelPosition=bottom;labelBackgroundColor=default;verticalAlign=top;aspect=fixed;imageAspect=0;image=data:image/png,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;" parent="1" vertex="1">
          <mxGeometry x="60.18" y="280" width="83.57" height="60" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-22" value="&lt;b&gt;&lt;u&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;Syscall stub&lt;/font&gt;&lt;/u&gt;&lt;/b&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="43.750000000000014" y="250" width="110" height="30" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-23" value="&lt;b&gt;Win32 API&lt;/b&gt;" style="ellipse;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="40" y="115" width="70" height="20" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-24" value="&lt;b&gt;NT API&lt;/b&gt;" style="ellipse;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="40" y="180" width="70" height="20" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-25" value="&lt;b&gt;Functions start with Nt or Zw&lt;/b&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="40" y="220" width="98.76" height="10" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-26" value="&lt;font style=&quot;font-size: 15px;&quot;&gt;User App&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="126.61000000000001" y="10" width="90" height="30" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-27" value="&lt;span style=&quot;font-size: 18px;&quot;&gt;EDR / AV&lt;/span&gt;" style="whiteSpace=wrap;html=1;rounded=1;arcSize=50;align=center;verticalAlign=middle;strokeWidth=1;autosize=1;spacing=4;treeFolding=1;treeMoving=1;newEdgeStyle={&quot;edgeStyle&quot;:&quot;entityRelationEdgeStyle&quot;,&quot;startArrow&quot;:&quot;none&quot;,&quot;endArrow&quot;:&quot;none&quot;,&quot;segment&quot;:10,&quot;curved&quot;:1,&quot;sourcePerimeterSpacing&quot;:0,&quot;targetPerimeterSpacing&quot;:0};fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="419.18" y="230" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-28" value="" style="edgeStyle=entityRelationEdgeStyle;startArrow=none;endArrow=none;segment=10;curved=1;sourcePerimeterSpacing=0;targetPerimeterSpacing=0;rounded=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" source="tEqawAXD5UkgbRX-SCwM-5" target="tEqawAXD5UkgbRX-SCwM-27" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="230" y="180" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-29" value="&lt;font style=&quot;font-size: 17px;&quot;&gt;Often Hooked&lt;br&gt;(inline hooking)&lt;/font&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="tEqawAXD5UkgbRX-SCwM-28" vertex="1" connectable="0">
          <mxGeometry x="-0.1775" y="3" relative="1" as="geometry">
            <mxPoint x="1" y="6" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-30" value="&lt;font style=&quot;font-size: 15px;&quot;&gt;mov ...&lt;/font&gt;&lt;div&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;.&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;.&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;.&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;ret&lt;/font&gt;&lt;/div&gt;" style="shape=ext;double=1;whiteSpace=wrap;html=1;aspect=fixed;" parent="1" vertex="1">
          <mxGeometry x="427.45" y="310" width="90" height="90" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-31" value="&lt;font style=&quot;font-size: 16px;&quot;&gt;Custom syscall stub&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="387.45" y="280" width="170" height="30" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-32" value="&lt;font style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;jmp edrFunc&lt;/b&gt;&lt;/font&gt;" style="shape=ext;double=1;rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="245" y="173.5" width="120" height="25" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-33" value="" style="image;aspect=fixed;html=1;points=[];align=center;fontSize=12;image=img/lib/azure2/other/Resource_Guard.svg;" parent="1" vertex="1">
          <mxGeometry x="450.86" y="152" width="56.64" height="68" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-34" value="" style="shape=image;html=1;verticalAlign=top;verticalLabelPosition=bottom;labelBackgroundColor=#ffffff;imageAspect=0;aspect=fixed;image=https://cdn1.iconfinder.com/data/icons/ninja-things-1/720/ninja-background-128.png" parent="1" vertex="1">
          <mxGeometry x="328.72" y="507" width="36.27906976744186" height="36.27906976744186" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-35" value="" style="shape=flexArrow;endArrow=classic;html=1;rounded=0;endWidth=5.714285714285714;endSize=12.72857142857143;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="480.58000000000004" y="405" as="sourcePoint" />
            <mxPoint x="481" y="499" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-36" value="&lt;font style=&quot;font-size: 18px;&quot;&gt;Solution&lt;/font&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="tEqawAXD5UkgbRX-SCwM-35" vertex="1" connectable="0">
          <mxGeometry x="-0.4598" y="-2" relative="1" as="geometry">
            <mxPoint x="7" y="10" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-37" value="&lt;font style=&quot;font-size: 21px;&quot;&gt;Unhooking ntdll.dll by restoring the .text section&amp;nbsp;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="375.46" y="500" width="302.55" height="50.28" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-38" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="300" y="560" width="460" height="360" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-39" value="" style="verticalLabelPosition=bottom;html=1;verticalAlign=top;align=center;strokeColor=none;fillColor=#00BEF2;shape=mxgraph.azure.vhd_data_disk;pointerEvents=1;" parent="1" vertex="1">
          <mxGeometry x="313.65268121495706" y="612" width="35.231031422693725" height="50" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-40" value="&lt;font style=&quot;font-size: 17px;&quot;&gt;1- Retreive a Clean ntdll.dll&lt;/font&gt;&lt;div&gt;&lt;font style=&quot;font-size: 17px;&quot;&gt;&amp;nbsp;file from Disk&lt;/font&gt;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;rotation=0;" parent="1" vertex="1">
          <mxGeometry x="322.2772377072325" y="702" width="230" height="50" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-41" value="" style="endArrow=classic;html=1;rounded=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;entryPerimeter=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;exitPerimeter=0;" parent="1" source="tEqawAXD5UkgbRX-SCwM-39" target="tEqawAXD5UkgbRX-SCwM-42" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="280" y="562" as="sourcePoint" />
            <mxPoint x="326.97470856359166" y="512" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-42" value="" style="whiteSpace=wrap;html=1;shape=mxgraph.basic.document" parent="1" vertex="1">
          <mxGeometry x="383.3443588399016" y="572" width="93.94941712718328" height="130" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-43" value="" style="endArrow=none;html=1;rounded=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;entryPerimeter=0;exitX=0;exitY=0.5;exitDx=0;exitDy=0;exitPerimeter=0;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="383.3443588399016" y="662" as="sourcePoint" />
            <mxPoint x="477.2937759670849" y="662" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-44" value="&lt;b&gt;clean .text&lt;/b&gt;&lt;div&gt;&lt;b&gt;&amp;nbsp;section&lt;/b&gt;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="402.13424226533823" y="662" width="80" height="40" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-45" value="" style="verticalLabelPosition=bottom;verticalAlign=top;html=1;shape=mxgraph.basic.tick" parent="1" vertex="1">
          <mxGeometry x="388.0418296962608" y="672" width="14.092412569077492" height="20" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-46" value="" style="curved=1;endArrow=classic;html=1;rounded=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" target="tEqawAXD5UkgbRX-SCwM-50" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="477.2937759670849" y="642" as="sourcePoint" />
            <mxPoint x="561.8482513815497" y="622" as="targetPoint" />
            <Array as="points">
              <mxPoint x="524.2684845306765" y="642" />
              <mxPoint x="505.4786011052399" y="612" />
              <mxPoint x="552.4533096688315" y="622" />
              <mxPoint x="561.8482513815497" y="602" />
              <mxPoint x="599.4280182324231" y="632" />
              <mxPoint x="627.612843370578" y="662" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-47" value="&lt;div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="tEqawAXD5UkgbRX-SCwM-46" vertex="1" connectable="0">
          <mxGeometry x="0.372" y="-2" relative="1" as="geometry">
            <mxPoint x="97" y="23" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-48" value="&lt;font style=&quot;font-size: 15px;&quot;&gt;&lt;b&gt;2- Patch the .text section&lt;/b&gt;&lt;/font&gt;&lt;div&gt;&lt;span style=&quot;font-size: 15px;&quot;&gt;&lt;b&gt;and &lt;u&gt;restore the modified protections&lt;/u&gt;&lt;br&gt;&lt;/b&gt;&lt;/span&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="tEqawAXD5UkgbRX-SCwM-46" vertex="1" connectable="0">
          <mxGeometry x="-0.1484" y="3" relative="1" as="geometry">
            <mxPoint x="81" y="5" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-49" value="" style="sketch=0;pointerEvents=1;shadow=0;dashed=0;html=1;strokeColor=none;fillColor=#005F4B;labelPosition=center;verticalLabelPosition=bottom;verticalAlign=top;align=center;outlineConnect=0;shape=mxgraph.veeam2.ram;" parent="1" vertex="1">
          <mxGeometry x="561.8482513815497" y="762" width="84.55447541446495" height="30" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-50" value="" style="whiteSpace=wrap;html=1;shape=mxgraph.basic.document" parent="1" vertex="1">
          <mxGeometry x="599.4280182324231" y="702" width="28.184825138154984" height="40" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-51" value="&lt;font style=&quot;font-size: 18px;&quot;&gt;&lt;b&gt;in-memory ntdll.dll&lt;/b&gt;&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="514.8735428179582" y="732" width="180" height="40" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-52" value="" style="image;aspect=fixed;html=1;points=[];align=center;fontSize=12;image=img/lib/azure2/other/Resource_Guard.svg;" parent="1" vertex="1">
          <mxGeometry x="442.87070953168495" y="812" width="48.26290801331692" height="57.94275679564885" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-53" value="&lt;font style=&quot;font-size: 20px;&quot;&gt;EDR / AV&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="418.52841555403177" y="880" width="110" height="40" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-54" value="" style="endArrow=classic;startArrow=classic;html=1;rounded=0;curved=1;" parent="1" target="tEqawAXD5UkgbRX-SCwM-49" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="491.38618853616236" y="852" as="sourcePoint" />
            <mxPoint x="538.3608970997541" y="802" as="targetPoint" />
            <Array as="points">
              <mxPoint x="580.6381348069865" y="842" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-55" value="" style="shape=image;html=1;verticalAlign=top;verticalLabelPosition=bottom;labelBackgroundColor=#ffffff;imageAspect=0;aspect=fixed;image=https://cdn1.iconfinder.com/data/icons/ninja-things-1/720/ninja-background-128.png" parent="1" vertex="1">
          <mxGeometry x="471.87" y="-252.72" width="43" height="43" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-56" value="&lt;font style=&quot;font-size: 21px;&quot;&gt;Detecting hooked syscalls within ntdll.dll&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="517.4499999999999" y="-256.36" width="560" height="50.28" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-57" value="" style="curved=1;endArrow=classic;html=1;rounded=0;entryX=-0.007;entryY=0.434;entryDx=0;entryDy=0;entryPerimeter=0;exitX=1;exitY=0;exitDx=0;exitDy=0;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" source="tEqawAXD5UkgbRX-SCwM-5" target="tEqawAXD5UkgbRX-SCwM-61" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="229.11" y="180" as="sourcePoint" />
            <mxPoint x="279.11" y="130" as="targetPoint" />
            <Array as="points">
              <mxPoint x="279.11" y="180" />
              <mxPoint x="290" y="-160" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-58" value="" style="shape=flexArrow;endArrow=classic;html=1;rounded=0;endWidth=5.714285714285714;endSize=12.72857142857143;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="610.0000000000001" y="250" as="sourcePoint" />
            <mxPoint x="743.6" y="250" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-59" value="&lt;font style=&quot;font-size: 18px;&quot;&gt;Solution&lt;/font&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="tEqawAXD5UkgbRX-SCwM-58" vertex="1" connectable="0">
          <mxGeometry x="-0.4598" y="-2" relative="1" as="geometry">
            <mxPoint x="17" y="-2" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-60" value="" style="group" parent="1" vertex="1" connectable="0">
          <mxGeometry x="477.29" y="-201.6" width="602.71" height="281.6" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-61" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;" parent="tEqawAXD5UkgbRX-SCwM-60" vertex="1">
          <mxGeometry width="602.71" height="281.6" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-62" value="" style="sketch=0;pointerEvents=1;shadow=0;dashed=0;html=1;strokeColor=none;fillColor=#005F4B;labelPosition=center;verticalLabelPosition=bottom;verticalAlign=top;align=center;outlineConnect=0;shape=mxgraph.veeam2.ram;" parent="tEqawAXD5UkgbRX-SCwM-60" vertex="1">
          <mxGeometry x="10.159999999999968" y="61.599999999999994" width="70" height="30" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-63" value="" style="shape=table;startSize=0;container=1;collapsible=0;childLayout=tableLayout;" parent="tEqawAXD5UkgbRX-SCwM-60" vertex="1">
          <mxGeometry x="212.70999999999998" y="29.599999999999994" width="160" height="114" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-64" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="tEqawAXD5UkgbRX-SCwM-63" vertex="1">
          <mxGeometry width="160" height="15" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-65" value="Nt*..." style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" parent="tEqawAXD5UkgbRX-SCwM-64" vertex="1">
          <mxGeometry width="160" height="15" as="geometry">
            <mxRectangle width="160" height="15" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-66" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="tEqawAXD5UkgbRX-SCwM-63" vertex="1">
          <mxGeometry y="15" width="160" height="27" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-67" value="Nt*..." style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" parent="tEqawAXD5UkgbRX-SCwM-66" vertex="1">
          <mxGeometry width="160" height="27" as="geometry">
            <mxRectangle width="160" height="27" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-68" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="tEqawAXD5UkgbRX-SCwM-63" vertex="1">
          <mxGeometry y="42" width="160" height="22" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-69" value="Zw*..." style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" parent="tEqawAXD5UkgbRX-SCwM-68" vertex="1">
          <mxGeometry width="160" height="22" as="geometry">
            <mxRectangle width="160" height="22" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-70" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="tEqawAXD5UkgbRX-SCwM-63" vertex="1">
          <mxGeometry y="64" width="160" height="20" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-71" value="Zw*..." style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" parent="tEqawAXD5UkgbRX-SCwM-70" vertex="1">
          <mxGeometry width="160" height="20" as="geometry">
            <mxRectangle width="160" height="20" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-72" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="tEqawAXD5UkgbRX-SCwM-63" vertex="1">
          <mxGeometry y="84" width="160" height="15" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-73" value="Nt*..." style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" parent="tEqawAXD5UkgbRX-SCwM-72" vertex="1">
          <mxGeometry width="160" height="15" as="geometry">
            <mxRectangle width="160" height="15" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-74" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="tEqawAXD5UkgbRX-SCwM-63" vertex="1">
          <mxGeometry y="99" width="160" height="15" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-75" value="..." style="shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;" parent="tEqawAXD5UkgbRX-SCwM-74" vertex="1">
          <mxGeometry width="160" height="15" as="geometry">
            <mxRectangle width="160" height="15" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-76" value="" style="endArrow=classic;html=1;rounded=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;curved=1;" parent="tEqawAXD5UkgbRX-SCwM-60" source="tEqawAXD5UkgbRX-SCwM-62" target="tEqawAXD5UkgbRX-SCwM-66" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="40.160000000000025" y="61.599999999999994" as="sourcePoint" />
            <mxPoint x="90.16000000000003" y="11.599999999999994" as="targetPoint" />
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-77" value="&lt;font style=&quot;font-size: 16px;&quot;&gt;Load ntdll.dll&amp;nbsp;&lt;/font&gt;&lt;div&gt;&lt;font style=&quot;font-size: 16px;&quot;&gt;export table&lt;/font&gt;&lt;/div&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="tEqawAXD5UkgbRX-SCwM-76" vertex="1" connectable="0">
          <mxGeometry x="-0.1688" y="-3" relative="1" as="geometry">
            <mxPoint x="7" y="-8" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-78" value="" style="shape=curlyBracket;whiteSpace=wrap;html=1;rounded=1;flipH=1;labelPosition=right;verticalLabelPosition=middle;align=left;verticalAlign=middle;" parent="tEqawAXD5UkgbRX-SCwM-60" vertex="1">
          <mxGeometry x="372.71" y="26.599999999999994" width="20" height="120" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-79" value="&lt;font style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;Loop through the Nt* and Zw* functions&lt;/b&gt;&lt;/font&gt;&lt;div&gt;&lt;font style=&quot;font-size: 16px;&quot;&gt;&lt;b&gt;and check their syscalls stubs if they start with a redirection&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="tEqawAXD5UkgbRX-SCwM-60" vertex="1">
          <mxGeometry x="392.71" y="91.6" width="210" height="30" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-80" value="&lt;ul&gt;&lt;li&gt;&lt;font style=&quot;font-size: 17px;&quot;&gt;Good before doing direct/indirect syscall.&lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font style=&quot;font-size: 17px;&quot;&gt;Good to verify if an unhooking routine went correctly.&lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font style=&quot;font-size: 17px;&quot;&gt;Not good against total API re-implementation.&lt;/font&gt;&lt;/li&gt;&lt;li&gt;&lt;font style=&quot;font-size: 17px;&quot;&gt;Limited to inline hooking and not IAT and SSDT hooks.&lt;/font&gt;&lt;/li&gt;&lt;/ul&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="tEqawAXD5UkgbRX-SCwM-60" vertex="1">
          <mxGeometry x="42.23999999999995" y="161.6" width="490.47" height="110" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-81" value="" style="shape=image;html=1;verticalAlign=top;verticalLabelPosition=bottom;labelBackgroundColor=#ffffff;imageAspect=0;aspect=fixed;image=https://cdn1.iconfinder.com/data/icons/ninja-things-1/720/ninja-background-128.png" parent="1" vertex="1">
          <mxGeometry x="790" y="173.72000000000003" width="36.27906976744186" height="36.27906976744186" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-82" value="&lt;font style=&quot;font-size: 21px;&quot;&gt;&lt;b&gt;Direct Syscalls&lt;/b&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="830" y="169.72" width="440" height="50.28" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-83" value="" style="shape=flexArrow;endArrow=classic;html=1;rounded=0;endWidth=5.714285714285714;endSize=12.72857142857143;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1049" y="600" as="sourcePoint" />
            <mxPoint x="1049.17" y="700" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-84" value="&lt;font style=&quot;font-size: 18px;&quot;&gt;Solution&lt;/font&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="tEqawAXD5UkgbRX-SCwM-83" vertex="1" connectable="0">
          <mxGeometry x="-0.4598" y="-2" relative="1" as="geometry">
            <mxPoint x="17" y="-2" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-85" value="" style="group" parent="1" vertex="1" connectable="0">
          <mxGeometry x="712.5" y="230" width="625" height="360" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-86" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;" parent="tEqawAXD5UkgbRX-SCwM-85" vertex="1">
          <mxGeometry x="77.5" width="490" height="360" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-87" value="&lt;font style=&quot;font-size: 17px;&quot;&gt;&lt;b&gt;*.cpp&lt;/b&gt;&lt;/font&gt;" style="whiteSpace=wrap;html=1;shape=mxgraph.basic.document;container=1;" parent="tEqawAXD5UkgbRX-SCwM-85" vertex="1">
          <mxGeometry x="447.5" y="92.5" width="50" height="65" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-88" value="&lt;font style=&quot;font-size: 18px;&quot;&gt;&lt;b&gt;*.h&lt;/b&gt;&lt;/font&gt;" style="whiteSpace=wrap;html=1;shape=mxgraph.basic.document;container=1;" parent="tEqawAXD5UkgbRX-SCwM-85" vertex="1">
          <mxGeometry x="287.5" y="92.5" width="50" height="65" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-89" value="&lt;font style=&quot;font-size: 18px;&quot;&gt;&lt;b&gt;*.asm&lt;/b&gt;&lt;/font&gt;" style="whiteSpace=wrap;html=1;shape=mxgraph.basic.document;container=1;" parent="tEqawAXD5UkgbRX-SCwM-85" vertex="1">
          <mxGeometry x="117.5" y="92.5" width="50" height="65" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-90" value="&lt;font style=&quot;font-size: 17px;&quot;&gt;&lt;b&gt;Avoid the hooked ntdll.dll and call&amp;nbsp;&lt;/b&gt;&lt;/font&gt;&lt;div&gt;&lt;font style=&quot;font-size: 17px;&quot;&gt;&lt;b&gt;the target syscall&lt;/b&gt;&lt;/font&gt;&lt;b style=&quot;font-size: 17px; background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;&amp;nbsp;directly with its SSN.&lt;/b&gt;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="tEqawAXD5UkgbRX-SCwM-85" vertex="1">
          <mxGeometry x="147.5" y="19.99999999999997" width="340" height="50" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-91" value="&lt;b&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;Syscall stub that&amp;nbsp;&lt;br&gt;prepares the&amp;nbsp;&lt;/font&gt;&lt;/b&gt;&lt;div&gt;&lt;b style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&amp;nbsp;parameters in the&amp;nbsp;&lt;/font&gt;&lt;/b&gt;&lt;div&gt;&lt;b&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;correct registers&lt;/font&gt;&lt;/b&gt;&lt;/div&gt;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="tEqawAXD5UkgbRX-SCwM-85" vertex="1">
          <mxGeometry x="67.5" y="150" width="160" height="90" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-92" value="&lt;b&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;Header file with the&amp;nbsp;&lt;/font&gt;&lt;/b&gt;&lt;div&gt;&lt;div&gt;&lt;b&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;external function&amp;nbsp;&lt;/font&gt;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;declarations&lt;/font&gt;&lt;/b&gt;&lt;/div&gt;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="tEqawAXD5UkgbRX-SCwM-85" vertex="1">
          <mxGeometry x="227.5" y="160" width="170" height="70" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-93" value="&lt;b&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;The code that&amp;nbsp;&lt;/font&gt;&lt;/b&gt;&lt;div&gt;&lt;b&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;retrieves&amp;nbsp;&amp;nbsp;&lt;/font&gt;&lt;/b&gt;&lt;div&gt;&lt;b&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;the SSN and call&lt;/font&gt;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;the syscalls&lt;/font&gt;&lt;/b&gt;&lt;/div&gt;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="tEqawAXD5UkgbRX-SCwM-85" vertex="1">
          <mxGeometry x="402.5" y="154.38" width="140" height="90" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-94" value="" style="verticalLabelPosition=bottom;verticalAlign=top;html=1;shape=mxgraph.basic.tick;fillColor=#d5e8d4;strokeColor=#82b366;" parent="tEqawAXD5UkgbRX-SCwM-85" vertex="1">
          <mxGeometry x="120" y="28.75" width="27.5" height="32.5" as="geometry" />
        </mxCell>
        <UserObject label="SSNs are version-dependant. Look for Hell&#39;s Gate method.&#xa;Atypical behaviour of the syscall instructions since they executeÂ &#xa;outside of the ntdll.dll.Â &#xa;The return address after the syscall points back to non-standard&#xa;memory region." id="tEqawAXD5UkgbRX-SCwM-95">
          <mxCell style="text;whiteSpace=wrap;fontSize=16;" parent="tEqawAXD5UkgbRX-SCwM-85" vertex="1">
            <mxGeometry x="107.5" y="240" width="490" height="100" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-96" value="" style="shape=mxgraph.mockup.markup.redX;fillColor=#ff0000;html=1;shadow=0;whiteSpace=wrap;strokeColor=none;" parent="tEqawAXD5UkgbRX-SCwM-85" vertex="1">
          <mxGeometry x="87.5" y="303" width="13.72" height="17" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-97" value="" style="shape=mxgraph.mockup.markup.redX;fillColor=#ff0000;html=1;shadow=0;whiteSpace=wrap;strokeColor=none;" parent="tEqawAXD5UkgbRX-SCwM-85" vertex="1">
          <mxGeometry x="87.5" y="270" width="13.72" height="17" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-98" value="" style="shape=mxgraph.mockup.markup.redX;fillColor=#ff0000;html=1;shadow=0;whiteSpace=wrap;strokeColor=none;" parent="tEqawAXD5UkgbRX-SCwM-85" vertex="1">
          <mxGeometry x="87.5" y="244.38" width="13.72" height="17" as="geometry" />
        </mxCell>
        <mxCell id="sD_lDuidbchsZRyquxOI-5" value="&lt;font style=&quot;font-size: 21px;&quot;&gt;&lt;b&gt;LSASS Dumping&lt;/b&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="1">
          <mxGeometry x="210" y="1283.73" width="491.69" height="53.74" as="geometry" />
        </mxCell>
        <mxCell id="sD_lDuidbchsZRyquxOI-6" value="" style="shape=image;html=1;verticalAlign=top;verticalLabelPosition=bottom;labelBackgroundColor=#ffffff;imageAspect=0;aspect=fixed;image=https://cdn1.iconfinder.com/data/icons/ninja-things-1/720/ninja-background-128.png" vertex="1" parent="1">
          <mxGeometry x="129.99999999999997" y="1281.86" width="57.47" height="57.47" as="geometry" />
        </mxCell>
        <mxCell id="sD_lDuidbchsZRyquxOI-21" value="" style="group" vertex="1" connectable="0" parent="1">
          <mxGeometry x="340" y="1370" width="188.53" height="130" as="geometry" />
        </mxCell>
        <mxCell id="sD_lDuidbchsZRyquxOI-15" value="" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.database;whiteSpace=wrap;" vertex="1" parent="sD_lDuidbchsZRyquxOI-21">
          <mxGeometry x="63.7675" width="60.995" height="82.72727272727273" as="geometry" />
        </mxCell>
        <mxCell id="sD_lDuidbchsZRyquxOI-16" value="&lt;font style=&quot;font-size: 20px;&quot;&gt;&lt;b style=&quot;&quot;&gt;LSASS Process&lt;/b&gt;&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="sD_lDuidbchsZRyquxOI-21">
          <mxGeometry y="82.72727272727273" width="170" height="40" as="geometry" />
        </mxCell>
        <mxCell id="sD_lDuidbchsZRyquxOI-10" value="" style="curved=1;endArrow=classic;html=1;rounded=0;" edge="1" parent="1" source="sD_lDuidbchsZRyquxOI-16">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="572.1300000000001" y="1550" as="sourcePoint" />
            <mxPoint x="200" y="1610" as="targetPoint" />
            <Array as="points">
              <mxPoint x="280" y="1480" />
              <mxPoint x="160" y="1460" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="sD_lDuidbchsZRyquxOI-24" value="" style="curved=1;endArrow=classic;html=1;rounded=0;exitX=0.984;exitY=0.632;exitDx=0;exitDy=0;exitPerimeter=0;" edge="1" parent="1" source="sD_lDuidbchsZRyquxOI-16">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="680" y="1600" as="sourcePoint" />
            <mxPoint x="670" y="1620" as="targetPoint" />
            <Array as="points">
              <mxPoint x="610" y="1478" />
              <mxPoint x="700" y="1460" />
              <mxPoint x="700" y="1520" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="sD_lDuidbchsZRyquxOI-26" value="&lt;font style=&quot;font-size: 26px;&quot;&gt;MiniDumpWriteDump&lt;/font&gt;&lt;div&gt;&lt;font style=&quot;font-size: 26px;&quot;&gt;+&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 26px;&quot;&gt;SeDebugPrivilege&lt;/font&gt;&lt;/div&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="sD_lDuidbchsZRyquxOI-24">
          <mxGeometry x="-0.1338" y="2" relative="1" as="geometry">
            <mxPoint x="-455" y="64" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="sD_lDuidbchsZRyquxOI-31" value="&lt;font style=&quot;font-size: 26px;&quot;&gt;PssCaptureSnapshot&lt;/font&gt;&lt;div&gt;&lt;font style=&quot;font-size: 26px;&quot;&gt;+&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 26px;&quot;&gt;MiniDumpWriteDump&lt;/font&gt;&lt;/div&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="sD_lDuidbchsZRyquxOI-24">
          <mxGeometry x="0.202" y="-5" relative="1" as="geometry">
            <mxPoint x="-15" y="49" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="sD_lDuidbchsZRyquxOI-29" value="" style="whiteSpace=wrap;html=1;shape=mxgraph.basic.document" vertex="1" parent="1">
          <mxGeometry x="166.61" y="1630" width="63.39" height="80" as="geometry" />
        </mxCell>
        <mxCell id="sD_lDuidbchsZRyquxOI-30" value="&lt;font style=&quot;font-size: 23px;&quot;&gt;&amp;nbsp;Directly create a *.dmp file&lt;/font&gt;&lt;div&gt;&lt;font style=&quot;font-size: 23px;&quot;&gt;saved on the disk containing&amp;nbsp;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 23px;&quot;&gt;its content.&lt;/font&gt;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="60.17999999999999" y="1710" width="320" height="100" as="geometry" />
        </mxCell>
        <mxCell id="sD_lDuidbchsZRyquxOI-32" value="" style="shape=datastore;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="630" y="1630" width="64.87" height="80" as="geometry" />
        </mxCell>
        <mxCell id="sD_lDuidbchsZRyquxOI-33" value="&lt;font style=&quot;font-size: 23px;&quot;&gt;Create a read-only clone of the&lt;/font&gt;&lt;div&gt;&lt;font style=&quot;font-size: 23px;&quot;&gt;&amp;nbsp;lsass.exe and only then&lt;/font&gt;&lt;div&gt;&lt;font style=&quot;font-size: 23px;&quot;&gt;dump its memory usinng&amp;nbsp;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 23px;&quot;&gt;MiniDumpWriteDump&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="498.67" y="1720" width="340" height="120" as="geometry" />
        </mxCell>
        <mxCell id="sD_lDuidbchsZRyquxOI-34" value="" style="group" vertex="1" connectable="0" parent="1">
          <mxGeometry x="810" y="720" width="500" height="398.28" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-99" value="&lt;font style=&quot;font-size: 21px;&quot;&gt;&lt;b&gt;Indirect Syscalls&lt;/b&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;" parent="sD_lDuidbchsZRyquxOI-34" vertex="1">
          <mxGeometry x="40" width="440" height="50.28" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-100" value="" style="shape=image;html=1;verticalAlign=top;verticalLabelPosition=bottom;labelBackgroundColor=#ffffff;imageAspect=0;aspect=fixed;image=https://cdn1.iconfinder.com/data/icons/ninja-things-1/720/ninja-background-128.png" parent="sD_lDuidbchsZRyquxOI-34" vertex="1">
          <mxGeometry y="7" width="36.27906976744186" height="36.27906976744186" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-101" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;" parent="sD_lDuidbchsZRyquxOI-34" vertex="1">
          <mxGeometry x="34.41999999999996" y="70.27999999999997" width="453.72" height="328" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-102" value="&lt;div style=&quot;text-align: left;&quot;&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;Instead of manually calling a syscall by its SSN&amp;nbsp;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;&lt;font style=&quot;&quot;&gt;within our payload we will&amp;nbsp;&lt;/font&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;&lt;font style=&quot;&quot;&gt;find the address of a&lt;/font&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;target syscall instruction residing within ntdll.dll&amp;nbsp;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;&lt;font style=&quot;&quot;&gt;and jump&amp;nbsp;&lt;/font&gt;&lt;/span&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;&lt;font style=&quot;&quot;&gt;to that instruction&amp;nbsp;&lt;/font&gt;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="sD_lDuidbchsZRyquxOI-34" vertex="1">
          <mxGeometry x="35" y="98.27999999999997" width="450" height="110" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-103" value="" style="verticalLabelPosition=bottom;verticalAlign=top;html=1;shape=mxgraph.basic.tick;fillColor=#d5e8d4;strokeColor=#82b366;" parent="sD_lDuidbchsZRyquxOI-34" vertex="1">
          <mxGeometry x="40" y="228.27999999999997" width="27.5" height="32.5" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-104" value="&lt;b&gt;&lt;font style=&quot;font-size: 16px;&quot;&gt;The return address will be in a normal and expected&amp;nbsp;&lt;/font&gt;&lt;/b&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;b&gt;&lt;font style=&quot;font-size: 16px;&quot;&gt;memory region.&lt;/font&gt;&lt;/b&gt;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="sD_lDuidbchsZRyquxOI-34" vertex="1">
          <mxGeometry x="68.13999999999999" y="219.52999999999997" width="420" height="50" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-105" value="&lt;b&gt;&lt;font style=&quot;font-size: 16px;&quot;&gt;Better in avoiding memory inspection and&amp;nbsp;&lt;/font&gt;&lt;/b&gt;&lt;b style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;&lt;font style=&quot;font-size: 16px;&quot;&gt;call stack&amp;nbsp;&lt;/font&gt;&lt;/b&gt;&lt;div&gt;&lt;b style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;&lt;font style=&quot;font-size: 16px;&quot;&gt;red flags.&lt;/font&gt;&lt;/b&gt;&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="sD_lDuidbchsZRyquxOI-34" vertex="1">
          <mxGeometry x="80" y="269.53" width="420" height="50" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-106" value="" style="verticalLabelPosition=bottom;verticalAlign=top;html=1;shape=mxgraph.basic.tick;fillColor=#d5e8d4;strokeColor=#82b366;" parent="sD_lDuidbchsZRyquxOI-34" vertex="1">
          <mxGeometry x="40" y="278.28" width="27.5" height="32.5" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-107" value="&lt;font style=&quot;font-size: 16px;&quot;&gt;&lt;b style=&quot;&quot;&gt;Isn&#39;t that strong against ETW+ Kernel callbacks&amp;nbsp;&lt;/b&gt;&lt;/font&gt;&lt;div&gt;&lt;font style=&quot;font-size: 16px;&quot;&gt;&lt;b style=&quot;&quot;&gt;protections.&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="sD_lDuidbchsZRyquxOI-34" vertex="1">
          <mxGeometry x="80" y="319.53" width="390" height="50" as="geometry" />
        </mxCell>
        <mxCell id="tEqawAXD5UkgbRX-SCwM-108" value="" style="shape=mxgraph.mockup.markup.redX;fillColor=#ff0000;html=1;shadow=0;whiteSpace=wrap;strokeColor=none;" parent="sD_lDuidbchsZRyquxOI-34" vertex="1">
          <mxGeometry x="40" y="329.53" width="33.6" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sD_lDuidbchsZRyquxOI-36" value="&lt;font style=&quot;font-size: 25px;&quot;&gt;The LSASS process is a critical Windows process since :&amp;nbsp;&lt;/font&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 25px;&quot;&gt;- It caches passwords in memory.&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 25px;&quot;&gt;- Creates access tokens.&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 25px;&quot;&gt;- Enforces security policy.&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 25px;&quot;&gt;- Writes to windows logs.&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;font-size: 25px;&quot;&gt;Dumping its memory could lead to obtaining very sensitive&amp;nbsp;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;font-size: 25px;&quot;&gt;data to be used later with offline tools like mimikataz.&lt;/span&gt;&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="110" y="1840" width="680" height="220" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
