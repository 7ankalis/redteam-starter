<?xml version="1.0" encoding="UTF-8"?>
<!-- Do not edit this file with editors other than draw.io -->
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" style="background: transparent; background-color: transparent; color-scheme: light dark;" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="1401px" height="2561px" viewBox="-0.5 -0.5 1401 2561" content="&lt;mxfile host=&quot;app.diagrams.net&quot; agent=&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/137.0.0.0 Safari/537.36&quot; version=&quot;27.1.4&quot;&gt;&#10;  &lt;diagram name=&quot;Page-1&quot; id=&quot;MYQSJNCdZhOi3zPZW-Wj&quot;&gt;&#10;    &lt;mxGraphModel dx=&quot;3312&quot; dy=&quot;2820&quot; grid=&quot;1&quot; gridSize=&quot;10&quot; guides=&quot;1&quot; tooltips=&quot;1&quot; connect=&quot;1&quot; arrows=&quot;1&quot; fold=&quot;1&quot; page=&quot;1&quot; pageScale=&quot;1&quot; pageWidth=&quot;850&quot; pageHeight=&quot;1100&quot; math=&quot;0&quot; shadow=&quot;0&quot;&gt;&#10;      &lt;root&gt;&#10;        &lt;mxCell id=&quot;0&quot; /&gt;&#10;        &lt;mxCell id=&quot;1&quot; parent=&quot;0&quot; /&gt;&#10;        &lt;mxCell id=&quot;sD_lDuidbchsZRyquxOI-37&quot; value=&quot;&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;&quot; vertex=&quot;1&quot; parent=&quot;1&quot;&gt;&#10;          &lt;mxGeometry y=&quot;-450&quot; width=&quot;1400&quot; height=&quot;2560&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sD_lDuidbchsZRyquxOI-35&quot; value=&quot;&quot; style=&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;&quot; vertex=&quot;1&quot; parent=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;60&quot; y=&quot;1363.73&quot; width=&quot;790&quot; height=&quot;716.27&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-1&quot; value=&quot;&quot; style=&quot;shape=partialRectangle;whiteSpace=wrap;html=1;top=0;left=0;fillColor=none;dashed=1;dashPattern=8 8;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;143.75&quot; y=&quot;-290&quot; width=&quot;126.25&quot; height=&quot;870&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-2&quot; value=&quot;&quot; style=&quot;ellipse;whiteSpace=wrap;html=1;rotation=-90;shadow=0;fillColor=#dae8fc;strokeColor=#6c8ebf;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;339.17999999999995&quot; y=&quot;152&quot; width=&quot;280&quot; height=&quot;270.82&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-3&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 18px;&amp;quot;&amp;gt;shell.exe&amp;lt;/font&amp;gt;&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;116.61&quot; y=&quot;40&quot; width=&quot;110&quot; height=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-4&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 18px;&amp;quot;&amp;gt;kernel32.dll&amp;lt;/font&amp;gt;&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;116.61&quot; y=&quot;110&quot; width=&quot;110&quot; height=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-5&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 18px;&amp;quot;&amp;gt;ntdll.dll&amp;lt;/font&amp;gt;&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;116.61&quot; y=&quot;180&quot; width=&quot;110&quot; height=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-6&quot; value=&quot;&quot; style=&quot;endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;&quot; parent=&quot;1&quot; source=&quot;tEqawAXD5UkgbRX-SCwM-3&quot; target=&quot;tEqawAXD5UkgbRX-SCwM-4&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry width=&quot;50&quot; height=&quot;50&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;400&quot; y=&quot;250&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;450&quot; y=&quot;200&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-7&quot; value=&quot;&amp;lt;b&amp;gt;ReadProcessMemory&amp;lt;/b&amp;gt;&quot; style=&quot;edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-6&quot; vertex=&quot;1&quot; connectable=&quot;0&quot;&gt;&#10;          &lt;mxGeometry x=&quot;-0.1371&quot; y=&quot;-1&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint as=&quot;offset&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-8&quot; value=&quot;&quot; style=&quot;endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;&quot; parent=&quot;1&quot; source=&quot;tEqawAXD5UkgbRX-SCwM-4&quot; target=&quot;tEqawAXD5UkgbRX-SCwM-5&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry width=&quot;50&quot; height=&quot;50&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;400&quot; y=&quot;250&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;450&quot; y=&quot;200&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-9&quot; value=&quot;&amp;lt;b&amp;gt;NtReadVirtualMemory&amp;lt;/b&amp;gt;&quot; style=&quot;edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-8&quot; vertex=&quot;1&quot; connectable=&quot;0&quot;&gt;&#10;          &lt;mxGeometry x=&quot;-0.0871&quot; y=&quot;-2&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint as=&quot;offset&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-10&quot; value=&quot;&quot; style=&quot;shape=internalStorage;whiteSpace=wrap;html=1;backgroundOutline=1;align=center;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;116.61&quot; y=&quot;390&quot; width=&quot;110&quot; height=&quot;110&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-11&quot; value=&quot;&quot; style=&quot;endArrow=classic;html=1;rounded=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;&quot; parent=&quot;1&quot; source=&quot;tEqawAXD5UkgbRX-SCwM-5&quot; target=&quot;tEqawAXD5UkgbRX-SCwM-10&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry width=&quot;50&quot; height=&quot;50&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;118&quot; y=&quot;210&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;115&quot; y=&quot;261&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-12&quot; value=&quot;&amp;lt;b&amp;gt;Syscall&amp;lt;/b&amp;gt;&quot; style=&quot;edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-11&quot; vertex=&quot;1&quot; connectable=&quot;0&quot;&gt;&#10;          &lt;mxGeometry x=&quot;-0.6685&quot; y=&quot;2&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;-2&quot; y=&quot;110&quot; as=&quot;offset&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-13&quot; value=&quot;Pointers&amp;amp;nbsp;&amp;lt;br&amp;gt;to the&amp;amp;nbsp;&amp;lt;br&amp;gt;corresponding&amp;amp;nbsp;&amp;lt;br&amp;gt;kernel&amp;lt;br&amp;gt;function&quot; style=&quot;text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;126.61&quot; y=&quot;410&quot; width=&quot;102.5&quot; height=&quot;90&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-14&quot; value=&quot;&amp;lt;b&amp;gt;&amp;lt;font style=&amp;quot;font-size: 14px;&amp;quot;&amp;gt;Nt!NtReadVirtualMemory&amp;lt;/font&amp;gt;&amp;lt;/b&amp;gt;&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;84.92&quot; y=&quot;530&quot; width=&quot;173.39&quot; height=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-15&quot; value=&quot;&quot; style=&quot;endArrow=classic;html=1;rounded=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;&quot; parent=&quot;1&quot; source=&quot;tEqawAXD5UkgbRX-SCwM-10&quot; target=&quot;tEqawAXD5UkgbRX-SCwM-14&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry width=&quot;50&quot; height=&quot;50&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;120&quot; y=&quot;430&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;118&quot; y=&quot;480&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-16&quot; value=&quot;&quot; style=&quot;endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;rounded=0;&quot; parent=&quot;1&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry width=&quot;50&quot; height=&quot;50&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;38.33&quot; y=&quot;610&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;38&quot; y=&quot;-160&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-17&quot; value=&quot;&quot; style=&quot;endArrow=none;html=1;rounded=0;&quot; parent=&quot;1&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry width=&quot;50&quot; height=&quot;50&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;10&quot; y=&quot;370&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;270&quot; y=&quot;370&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-18&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 14px;&amp;quot;&amp;gt;&amp;lt;b&amp;gt;User-Mode&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&quot; style=&quot;rounded=1;whiteSpace=wrap;html=1;rotation=-90;fillColor=#d5e8d4;strokeColor=#82b366;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;-48.12&quot; y=&quot;58.12&quot; width=&quot;132.5&quot; height=&quot;26.25&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-19&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 14px;&amp;quot;&amp;gt;&amp;lt;b&amp;gt;Kernel-mode&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&quot; style=&quot;rounded=1;whiteSpace=wrap;html=1;rotation=-90;fillColor=#f8cecc;strokeColor=#b85450;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;-41.87&quot; y=&quot;451.88&quot; width=&quot;116.25&quot; height=&quot;22.5&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-20&quot; value=&quot;&amp;lt;b&amp;gt;Syscall Table&amp;lt;/b&amp;gt;&quot; style=&quot;text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;139.11&quot; y=&quot;390&quot; width=&quot;90&quot; height=&quot;20&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-21&quot; value=&quot;&quot; style=&quot;shape=image;verticalLabelPosition=bottom;labelBackgroundColor=default;verticalAlign=top;aspect=fixed;imageAspect=0;image=data:image/png,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;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;60.18&quot; y=&quot;280&quot; width=&quot;83.57&quot; height=&quot;60&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-22&quot; value=&quot;&amp;lt;b&amp;gt;&amp;lt;u&amp;gt;&amp;lt;font style=&amp;quot;font-size: 14px;&amp;quot;&amp;gt;Syscall stub&amp;lt;/font&amp;gt;&amp;lt;/u&amp;gt;&amp;lt;/b&amp;gt;&quot; style=&quot;text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;43.750000000000014&quot; y=&quot;250&quot; width=&quot;110&quot; height=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-23&quot; value=&quot;&amp;lt;b&amp;gt;Win32 API&amp;lt;/b&amp;gt;&quot; style=&quot;ellipse;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;40&quot; y=&quot;115&quot; width=&quot;70&quot; height=&quot;20&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-24&quot; value=&quot;&amp;lt;b&amp;gt;NT API&amp;lt;/b&amp;gt;&quot; style=&quot;ellipse;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;40&quot; y=&quot;180&quot; width=&quot;70&quot; height=&quot;20&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-25&quot; value=&quot;&amp;lt;b&amp;gt;Functions start with Nt or Zw&amp;lt;/b&amp;gt;&quot; style=&quot;text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;40&quot; y=&quot;220&quot; width=&quot;98.76&quot; height=&quot;10&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-26&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 15px;&amp;quot;&amp;gt;User App&amp;lt;/font&amp;gt;&quot; style=&quot;text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;126.61000000000001&quot; y=&quot;10&quot; width=&quot;90&quot; height=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-27&quot; value=&quot;&amp;lt;span style=&amp;quot;font-size: 18px;&amp;quot;&amp;gt;EDR / AV&amp;lt;/span&amp;gt;&quot; style=&quot;whiteSpace=wrap;html=1;rounded=1;arcSize=50;align=center;verticalAlign=middle;strokeWidth=1;autosize=1;spacing=4;treeFolding=1;treeMoving=1;newEdgeStyle={&amp;quot;edgeStyle&amp;quot;:&amp;quot;entityRelationEdgeStyle&amp;quot;,&amp;quot;startArrow&amp;quot;:&amp;quot;none&amp;quot;,&amp;quot;endArrow&amp;quot;:&amp;quot;none&amp;quot;,&amp;quot;segment&amp;quot;:10,&amp;quot;curved&amp;quot;:1,&amp;quot;sourcePerimeterSpacing&amp;quot;:0,&amp;quot;targetPerimeterSpacing&amp;quot;:0};fillColor=#dae8fc;strokeColor=#6c8ebf;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;419.18&quot; y=&quot;230&quot; width=&quot;120&quot; height=&quot;40&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-28&quot; value=&quot;&quot; style=&quot;edgeStyle=entityRelationEdgeStyle;startArrow=none;endArrow=none;segment=10;curved=1;sourcePerimeterSpacing=0;targetPerimeterSpacing=0;rounded=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;fillColor=#dae8fc;strokeColor=#6c8ebf;&quot; parent=&quot;1&quot; source=&quot;tEqawAXD5UkgbRX-SCwM-5&quot; target=&quot;tEqawAXD5UkgbRX-SCwM-27&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;230&quot; y=&quot;180&quot; as=&quot;sourcePoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-29&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 17px;&amp;quot;&amp;gt;Often Hooked&amp;lt;br&amp;gt;(inline hooking)&amp;lt;/font&amp;gt;&quot; style=&quot;edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-28&quot; vertex=&quot;1&quot; connectable=&quot;0&quot;&gt;&#10;          &lt;mxGeometry x=&quot;-0.1775&quot; y=&quot;3&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;1&quot; y=&quot;6&quot; as=&quot;offset&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-30&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 15px;&amp;quot;&amp;gt;mov ...&amp;lt;/font&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font style=&amp;quot;font-size: 15px;&amp;quot;&amp;gt;.&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font style=&amp;quot;font-size: 15px;&amp;quot;&amp;gt;.&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font style=&amp;quot;font-size: 15px;&amp;quot;&amp;gt;.&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font style=&amp;quot;font-size: 15px;&amp;quot;&amp;gt;ret&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&quot; style=&quot;shape=ext;double=1;whiteSpace=wrap;html=1;aspect=fixed;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;427.45&quot; y=&quot;310&quot; width=&quot;90&quot; height=&quot;90&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-31&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 16px;&amp;quot;&amp;gt;Custom syscall stub&amp;lt;/font&amp;gt;&quot; style=&quot;text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;387.45&quot; y=&quot;280&quot; width=&quot;170&quot; height=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-32&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 16px;&amp;quot;&amp;gt;&amp;lt;b&amp;gt;jmp edrFunc&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&quot; style=&quot;shape=ext;double=1;rounded=0;whiteSpace=wrap;html=1;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;245&quot; y=&quot;173.5&quot; width=&quot;120&quot; height=&quot;25&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-33&quot; value=&quot;&quot; style=&quot;image;aspect=fixed;html=1;points=[];align=center;fontSize=12;image=img/lib/azure2/other/Resource_Guard.svg;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;450.86&quot; y=&quot;152&quot; width=&quot;56.64&quot; height=&quot;68&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-34&quot; value=&quot;&quot; style=&quot;shape=image;html=1;verticalAlign=top;verticalLabelPosition=bottom;labelBackgroundColor=#ffffff;imageAspect=0;aspect=fixed;image=https://cdn1.iconfinder.com/data/icons/ninja-things-1/720/ninja-background-128.png&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;328.72&quot; y=&quot;507&quot; width=&quot;36.27906976744186&quot; height=&quot;36.27906976744186&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-35&quot; value=&quot;&quot; style=&quot;shape=flexArrow;endArrow=classic;html=1;rounded=0;endWidth=5.714285714285714;endSize=12.72857142857143;fillColor=#f8cecc;strokeColor=#b85450;&quot; parent=&quot;1&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry width=&quot;50&quot; height=&quot;50&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;480.58000000000004&quot; y=&quot;405&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;481&quot; y=&quot;499&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-36&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 18px;&amp;quot;&amp;gt;Solution&amp;lt;/font&amp;gt;&quot; style=&quot;edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-35&quot; vertex=&quot;1&quot; connectable=&quot;0&quot;&gt;&#10;          &lt;mxGeometry x=&quot;-0.4598&quot; y=&quot;-2&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;7&quot; y=&quot;10&quot; as=&quot;offset&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-37&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 21px;&amp;quot;&amp;gt;Unhooking ntdll.dll by restoring the .text section&amp;amp;nbsp;&amp;lt;/font&amp;gt;&quot; style=&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;375.46&quot; y=&quot;500&quot; width=&quot;302.55&quot; height=&quot;50.28&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-38&quot; value=&quot;&quot; style=&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;300&quot; y=&quot;560&quot; width=&quot;460&quot; height=&quot;360&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-39&quot; value=&quot;&quot; style=&quot;verticalLabelPosition=bottom;html=1;verticalAlign=top;align=center;strokeColor=none;fillColor=#00BEF2;shape=mxgraph.azure.vhd_data_disk;pointerEvents=1;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;313.65268121495706&quot; y=&quot;612&quot; width=&quot;35.231031422693725&quot; height=&quot;50&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-40&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 17px;&amp;quot;&amp;gt;1- Retreive a Clean ntdll.dll&amp;lt;/font&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font style=&amp;quot;font-size: 17px;&amp;quot;&amp;gt;&amp;amp;nbsp;file from Disk&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&quot; style=&quot;text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;rotation=0;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;322.2772377072325&quot; y=&quot;702&quot; width=&quot;230&quot; height=&quot;50&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-41&quot; value=&quot;&quot; style=&quot;endArrow=classic;html=1;rounded=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;entryPerimeter=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;exitPerimeter=0;&quot; parent=&quot;1&quot; source=&quot;tEqawAXD5UkgbRX-SCwM-39&quot; target=&quot;tEqawAXD5UkgbRX-SCwM-42&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry width=&quot;50&quot; height=&quot;50&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;280&quot; y=&quot;562&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;326.97470856359166&quot; y=&quot;512&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-42&quot; value=&quot;&quot; style=&quot;whiteSpace=wrap;html=1;shape=mxgraph.basic.document&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;383.3443588399016&quot; y=&quot;572&quot; width=&quot;93.94941712718328&quot; height=&quot;130&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-43&quot; value=&quot;&quot; style=&quot;endArrow=none;html=1;rounded=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;entryPerimeter=0;exitX=0;exitY=0.5;exitDx=0;exitDy=0;exitPerimeter=0;&quot; parent=&quot;1&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry width=&quot;50&quot; height=&quot;50&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;383.3443588399016&quot; y=&quot;662&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;477.2937759670849&quot; y=&quot;662&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-44&quot; value=&quot;&amp;lt;b&amp;gt;clean .text&amp;lt;/b&amp;gt;&amp;lt;div&amp;gt;&amp;lt;b&amp;gt;&amp;amp;nbsp;section&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&quot; style=&quot;text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;402.13424226533823&quot; y=&quot;662&quot; width=&quot;80&quot; height=&quot;40&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-45&quot; value=&quot;&quot; style=&quot;verticalLabelPosition=bottom;verticalAlign=top;html=1;shape=mxgraph.basic.tick&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;388.0418296962608&quot; y=&quot;672&quot; width=&quot;14.092412569077492&quot; height=&quot;20&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-46&quot; value=&quot;&quot; style=&quot;curved=1;endArrow=classic;html=1;rounded=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;entryPerimeter=0;&quot; parent=&quot;1&quot; target=&quot;tEqawAXD5UkgbRX-SCwM-50&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry width=&quot;50&quot; height=&quot;50&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;477.2937759670849&quot; y=&quot;642&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;561.8482513815497&quot; y=&quot;622&quot; as=&quot;targetPoint&quot; /&gt;&#10;            &lt;Array as=&quot;points&quot;&gt;&#10;              &lt;mxPoint x=&quot;524.2684845306765&quot; y=&quot;642&quot; /&gt;&#10;              &lt;mxPoint x=&quot;505.4786011052399&quot; y=&quot;612&quot; /&gt;&#10;              &lt;mxPoint x=&quot;552.4533096688315&quot; y=&quot;622&quot; /&gt;&#10;              &lt;mxPoint x=&quot;561.8482513815497&quot; y=&quot;602&quot; /&gt;&#10;              &lt;mxPoint x=&quot;599.4280182324231&quot; y=&quot;632&quot; /&gt;&#10;              &lt;mxPoint x=&quot;627.612843370578&quot; y=&quot;662&quot; /&gt;&#10;            &lt;/Array&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-47&quot; value=&quot;&amp;lt;div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&quot; style=&quot;edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-46&quot; vertex=&quot;1&quot; connectable=&quot;0&quot;&gt;&#10;          &lt;mxGeometry x=&quot;0.372&quot; y=&quot;-2&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;97&quot; y=&quot;23&quot; as=&quot;offset&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-48&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 15px;&amp;quot;&amp;gt;&amp;lt;b&amp;gt;2- Patch the .text section&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;div&amp;gt;&amp;lt;span style=&amp;quot;font-size: 15px;&amp;quot;&amp;gt;&amp;lt;b&amp;gt;and &amp;lt;u&amp;gt;restore the modified protections&amp;lt;/u&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;div&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&quot; style=&quot;edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-46&quot; vertex=&quot;1&quot; connectable=&quot;0&quot;&gt;&#10;          &lt;mxGeometry x=&quot;-0.1484&quot; y=&quot;3&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;81&quot; y=&quot;5&quot; as=&quot;offset&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-49&quot; value=&quot;&quot; style=&quot;sketch=0;pointerEvents=1;shadow=0;dashed=0;html=1;strokeColor=none;fillColor=#005F4B;labelPosition=center;verticalLabelPosition=bottom;verticalAlign=top;align=center;outlineConnect=0;shape=mxgraph.veeam2.ram;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;561.8482513815497&quot; y=&quot;762&quot; width=&quot;84.55447541446495&quot; height=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-50&quot; value=&quot;&quot; style=&quot;whiteSpace=wrap;html=1;shape=mxgraph.basic.document&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;599.4280182324231&quot; y=&quot;702&quot; width=&quot;28.184825138154984&quot; height=&quot;40&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-51&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 18px;&amp;quot;&amp;gt;&amp;lt;b&amp;gt;in-memory ntdll.dll&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&quot; style=&quot;text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;514.8735428179582&quot; y=&quot;732&quot; width=&quot;180&quot; height=&quot;40&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-52&quot; value=&quot;&quot; style=&quot;image;aspect=fixed;html=1;points=[];align=center;fontSize=12;image=img/lib/azure2/other/Resource_Guard.svg;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;442.87070953168495&quot; y=&quot;812&quot; width=&quot;48.26290801331692&quot; height=&quot;57.94275679564885&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-53&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 20px;&amp;quot;&amp;gt;EDR / AV&amp;lt;/font&amp;gt;&quot; style=&quot;text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;418.52841555403177&quot; y=&quot;880&quot; width=&quot;110&quot; height=&quot;40&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-54&quot; value=&quot;&quot; style=&quot;endArrow=classic;startArrow=classic;html=1;rounded=0;curved=1;&quot; parent=&quot;1&quot; target=&quot;tEqawAXD5UkgbRX-SCwM-49&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry width=&quot;50&quot; height=&quot;50&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;491.38618853616236&quot; y=&quot;852&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;538.3608970997541&quot; y=&quot;802&quot; as=&quot;targetPoint&quot; /&gt;&#10;            &lt;Array as=&quot;points&quot;&gt;&#10;              &lt;mxPoint x=&quot;580.6381348069865&quot; y=&quot;842&quot; /&gt;&#10;            &lt;/Array&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-55&quot; value=&quot;&quot; style=&quot;shape=image;html=1;verticalAlign=top;verticalLabelPosition=bottom;labelBackgroundColor=#ffffff;imageAspect=0;aspect=fixed;image=https://cdn1.iconfinder.com/data/icons/ninja-things-1/720/ninja-background-128.png&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;471.87&quot; y=&quot;-252.72&quot; width=&quot;43&quot; height=&quot;43&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-56&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 21px;&amp;quot;&amp;gt;Detecting hooked syscalls within ntdll.dll&amp;lt;/font&amp;gt;&quot; style=&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;517.4499999999999&quot; y=&quot;-256.36&quot; width=&quot;560&quot; height=&quot;50.28&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-57&quot; value=&quot;&quot; style=&quot;curved=1;endArrow=classic;html=1;rounded=0;entryX=-0.007;entryY=0.434;entryDx=0;entryDy=0;entryPerimeter=0;exitX=1;exitY=0;exitDx=0;exitDy=0;fillColor=#f8cecc;strokeColor=#b85450;&quot; parent=&quot;1&quot; source=&quot;tEqawAXD5UkgbRX-SCwM-5&quot; target=&quot;tEqawAXD5UkgbRX-SCwM-61&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry width=&quot;50&quot; height=&quot;50&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;229.11&quot; y=&quot;180&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;279.11&quot; y=&quot;130&quot; as=&quot;targetPoint&quot; /&gt;&#10;            &lt;Array as=&quot;points&quot;&gt;&#10;              &lt;mxPoint x=&quot;279.11&quot; y=&quot;180&quot; /&gt;&#10;              &lt;mxPoint x=&quot;290&quot; y=&quot;-160&quot; /&gt;&#10;            &lt;/Array&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-58&quot; value=&quot;&quot; style=&quot;shape=flexArrow;endArrow=classic;html=1;rounded=0;endWidth=5.714285714285714;endSize=12.72857142857143;fillColor=#f8cecc;strokeColor=#b85450;&quot; parent=&quot;1&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry width=&quot;50&quot; height=&quot;50&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;610.0000000000001&quot; y=&quot;250&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;743.6&quot; y=&quot;250&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-59&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 18px;&amp;quot;&amp;gt;Solution&amp;lt;/font&amp;gt;&quot; style=&quot;edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-58&quot; vertex=&quot;1&quot; connectable=&quot;0&quot;&gt;&#10;          &lt;mxGeometry x=&quot;-0.4598&quot; y=&quot;-2&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;17&quot; y=&quot;-2&quot; as=&quot;offset&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-60&quot; value=&quot;&quot; style=&quot;group&quot; parent=&quot;1&quot; vertex=&quot;1&quot; connectable=&quot;0&quot;&gt;&#10;          &lt;mxGeometry x=&quot;477.29&quot; y=&quot;-201.6&quot; width=&quot;602.71&quot; height=&quot;281.6&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-61&quot; value=&quot;&quot; style=&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-60&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry width=&quot;602.71&quot; height=&quot;281.6&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-62&quot; value=&quot;&quot; style=&quot;sketch=0;pointerEvents=1;shadow=0;dashed=0;html=1;strokeColor=none;fillColor=#005F4B;labelPosition=center;verticalLabelPosition=bottom;verticalAlign=top;align=center;outlineConnect=0;shape=mxgraph.veeam2.ram;&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-60&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;10.159999999999968&quot; y=&quot;61.599999999999994&quot; width=&quot;70&quot; height=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-63&quot; value=&quot;&quot; style=&quot;shape=table;startSize=0;container=1;collapsible=0;childLayout=tableLayout;&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-60&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;212.70999999999998&quot; y=&quot;29.599999999999994&quot; width=&quot;160&quot; height=&quot;114&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-64&quot; value=&quot;&quot; style=&quot;shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-63&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry width=&quot;160&quot; height=&quot;15&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-65&quot; value=&quot;Nt*...&quot; style=&quot;shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-64&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry width=&quot;160&quot; height=&quot;15&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxRectangle width=&quot;160&quot; height=&quot;15&quot; as=&quot;alternateBounds&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-66&quot; value=&quot;&quot; style=&quot;shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-63&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry y=&quot;15&quot; width=&quot;160&quot; height=&quot;27&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-67&quot; value=&quot;Nt*...&quot; style=&quot;shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-66&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry width=&quot;160&quot; height=&quot;27&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxRectangle width=&quot;160&quot; height=&quot;27&quot; as=&quot;alternateBounds&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-68&quot; value=&quot;&quot; style=&quot;shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-63&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry y=&quot;42&quot; width=&quot;160&quot; height=&quot;22&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-69&quot; value=&quot;Zw*...&quot; style=&quot;shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-68&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry width=&quot;160&quot; height=&quot;22&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxRectangle width=&quot;160&quot; height=&quot;22&quot; as=&quot;alternateBounds&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-70&quot; value=&quot;&quot; style=&quot;shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-63&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry y=&quot;64&quot; width=&quot;160&quot; height=&quot;20&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-71&quot; value=&quot;Zw*...&quot; style=&quot;shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-70&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry width=&quot;160&quot; height=&quot;20&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxRectangle width=&quot;160&quot; height=&quot;20&quot; as=&quot;alternateBounds&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-72&quot; value=&quot;&quot; style=&quot;shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-63&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry y=&quot;84&quot; width=&quot;160&quot; height=&quot;15&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-73&quot; value=&quot;Nt*...&quot; style=&quot;shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-72&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry width=&quot;160&quot; height=&quot;15&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxRectangle width=&quot;160&quot; height=&quot;15&quot; as=&quot;alternateBounds&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-74&quot; value=&quot;&quot; style=&quot;shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-63&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry y=&quot;99&quot; width=&quot;160&quot; height=&quot;15&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-75&quot; value=&quot;...&quot; style=&quot;shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-74&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry width=&quot;160&quot; height=&quot;15&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxRectangle width=&quot;160&quot; height=&quot;15&quot; as=&quot;alternateBounds&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-76&quot; value=&quot;&quot; style=&quot;endArrow=classic;html=1;rounded=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;curved=1;&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-60&quot; source=&quot;tEqawAXD5UkgbRX-SCwM-62&quot; target=&quot;tEqawAXD5UkgbRX-SCwM-66&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry width=&quot;50&quot; height=&quot;50&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;40.160000000000025&quot; y=&quot;61.599999999999994&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;90.16000000000003&quot; y=&quot;11.599999999999994&quot; as=&quot;targetPoint&quot; /&gt;&#10;            &lt;Array as=&quot;points&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-77&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 16px;&amp;quot;&amp;gt;Load ntdll.dll&amp;amp;nbsp;&amp;lt;/font&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font style=&amp;quot;font-size: 16px;&amp;quot;&amp;gt;export table&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&quot; style=&quot;edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-76&quot; vertex=&quot;1&quot; connectable=&quot;0&quot;&gt;&#10;          &lt;mxGeometry x=&quot;-0.1688&quot; y=&quot;-3&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;7&quot; y=&quot;-8&quot; as=&quot;offset&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-78&quot; value=&quot;&quot; style=&quot;shape=curlyBracket;whiteSpace=wrap;html=1;rounded=1;flipH=1;labelPosition=right;verticalLabelPosition=middle;align=left;verticalAlign=middle;&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-60&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;372.71&quot; y=&quot;26.599999999999994&quot; width=&quot;20&quot; height=&quot;120&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-79&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 16px;&amp;quot;&amp;gt;&amp;lt;b&amp;gt;Loop through the Nt* and Zw* functions&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font style=&amp;quot;font-size: 16px;&amp;quot;&amp;gt;&amp;lt;b&amp;gt;and check their syscalls stubs if they start with a redirection&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&quot; style=&quot;text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-60&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;392.71&quot; y=&quot;91.6&quot; width=&quot;210&quot; height=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-80&quot; value=&quot;&amp;lt;ul&amp;gt;&amp;lt;li&amp;gt;&amp;lt;font style=&amp;quot;font-size: 17px;&amp;quot;&amp;gt;Good before doing direct/indirect syscall.&amp;lt;/font&amp;gt;&amp;lt;/li&amp;gt;&amp;lt;li&amp;gt;&amp;lt;font style=&amp;quot;font-size: 17px;&amp;quot;&amp;gt;Good to verify if an unhooking routine went correctly.&amp;lt;/font&amp;gt;&amp;lt;/li&amp;gt;&amp;lt;li&amp;gt;&amp;lt;font style=&amp;quot;font-size: 17px;&amp;quot;&amp;gt;Not good against total API re-implementation.&amp;lt;/font&amp;gt;&amp;lt;/li&amp;gt;&amp;lt;li&amp;gt;&amp;lt;font style=&amp;quot;font-size: 17px;&amp;quot;&amp;gt;Limited to inline hooking and not IAT and SSDT hooks.&amp;lt;/font&amp;gt;&amp;lt;/li&amp;gt;&amp;lt;/ul&amp;gt;&quot; style=&quot;text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-60&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;42.23999999999995&quot; y=&quot;161.6&quot; width=&quot;490.47&quot; height=&quot;110&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-81&quot; value=&quot;&quot; style=&quot;shape=image;html=1;verticalAlign=top;verticalLabelPosition=bottom;labelBackgroundColor=#ffffff;imageAspect=0;aspect=fixed;image=https://cdn1.iconfinder.com/data/icons/ninja-things-1/720/ninja-background-128.png&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;790&quot; y=&quot;173.72000000000003&quot; width=&quot;36.27906976744186&quot; height=&quot;36.27906976744186&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-82&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 21px;&amp;quot;&amp;gt;&amp;lt;b&amp;gt;Direct Syscalls&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&quot; style=&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;830&quot; y=&quot;169.72&quot; width=&quot;440&quot; height=&quot;50.28&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-83&quot; value=&quot;&quot; style=&quot;shape=flexArrow;endArrow=classic;html=1;rounded=0;endWidth=5.714285714285714;endSize=12.72857142857143;fillColor=#f8cecc;strokeColor=#b85450;&quot; parent=&quot;1&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry width=&quot;50&quot; height=&quot;50&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;1049&quot; y=&quot;600&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;1049.17&quot; y=&quot;700&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-84&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 18px;&amp;quot;&amp;gt;Solution&amp;lt;/font&amp;gt;&quot; style=&quot;edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-83&quot; vertex=&quot;1&quot; connectable=&quot;0&quot;&gt;&#10;          &lt;mxGeometry x=&quot;-0.4598&quot; y=&quot;-2&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;17&quot; y=&quot;-2&quot; as=&quot;offset&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-85&quot; value=&quot;&quot; style=&quot;group&quot; parent=&quot;1&quot; vertex=&quot;1&quot; connectable=&quot;0&quot;&gt;&#10;          &lt;mxGeometry x=&quot;712.5&quot; y=&quot;230&quot; width=&quot;625&quot; height=&quot;360&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-86&quot; value=&quot;&quot; style=&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-85&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;77.5&quot; width=&quot;490&quot; height=&quot;360&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-87&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 17px;&amp;quot;&amp;gt;&amp;lt;b&amp;gt;*.cpp&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&quot; style=&quot;whiteSpace=wrap;html=1;shape=mxgraph.basic.document;container=1;&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-85&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;447.5&quot; y=&quot;92.5&quot; width=&quot;50&quot; height=&quot;65&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-88&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 18px;&amp;quot;&amp;gt;&amp;lt;b&amp;gt;*.h&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&quot; style=&quot;whiteSpace=wrap;html=1;shape=mxgraph.basic.document;container=1;&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-85&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;287.5&quot; y=&quot;92.5&quot; width=&quot;50&quot; height=&quot;65&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-89&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 18px;&amp;quot;&amp;gt;&amp;lt;b&amp;gt;*.asm&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&quot; style=&quot;whiteSpace=wrap;html=1;shape=mxgraph.basic.document;container=1;&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-85&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;117.5&quot; y=&quot;92.5&quot; width=&quot;50&quot; height=&quot;65&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-90&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 17px;&amp;quot;&amp;gt;&amp;lt;b&amp;gt;Avoid the hooked ntdll.dll and call&amp;amp;nbsp;&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font style=&amp;quot;font-size: 17px;&amp;quot;&amp;gt;&amp;lt;b&amp;gt;the target syscall&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;b style=&amp;quot;font-size: 17px; background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;&amp;amp;nbsp;directly with its SSN.&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&quot; style=&quot;text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-85&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;147.5&quot; y=&quot;19.99999999999997&quot; width=&quot;340&quot; height=&quot;50&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-91&quot; value=&quot;&amp;lt;b&amp;gt;&amp;lt;font style=&amp;quot;font-size: 15px;&amp;quot;&amp;gt;Syscall stub that&amp;amp;nbsp;&amp;lt;br&amp;gt;prepares the&amp;amp;nbsp;&amp;lt;/font&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;div&amp;gt;&amp;lt;b style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;&amp;lt;font style=&amp;quot;font-size: 15px;&amp;quot;&amp;gt;&amp;amp;nbsp;parameters in the&amp;amp;nbsp;&amp;lt;/font&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;div&amp;gt;&amp;lt;b&amp;gt;&amp;lt;font style=&amp;quot;font-size: 15px;&amp;quot;&amp;gt;correct registers&amp;lt;/font&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&quot; style=&quot;text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-85&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;67.5&quot; y=&quot;150&quot; width=&quot;160&quot; height=&quot;90&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-92&quot; value=&quot;&amp;lt;b&amp;gt;&amp;lt;font style=&amp;quot;font-size: 15px;&amp;quot;&amp;gt;Header file with the&amp;amp;nbsp;&amp;lt;/font&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;b&amp;gt;&amp;lt;font style=&amp;quot;font-size: 15px;&amp;quot;&amp;gt;external function&amp;amp;nbsp;&amp;lt;/font&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;b&amp;gt;&amp;lt;font style=&amp;quot;font-size: 15px;&amp;quot;&amp;gt;declarations&amp;lt;/font&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&quot; style=&quot;text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-85&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;227.5&quot; y=&quot;160&quot; width=&quot;170&quot; height=&quot;70&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-93&quot; value=&quot;&amp;lt;b&amp;gt;&amp;lt;font style=&amp;quot;font-size: 15px;&amp;quot;&amp;gt;The code that&amp;amp;nbsp;&amp;lt;/font&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;div&amp;gt;&amp;lt;b&amp;gt;&amp;lt;font style=&amp;quot;font-size: 15px;&amp;quot;&amp;gt;retrieves&amp;amp;nbsp;&amp;amp;nbsp;&amp;lt;/font&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;div&amp;gt;&amp;lt;b&amp;gt;&amp;lt;font style=&amp;quot;font-size: 15px;&amp;quot;&amp;gt;the SSN and call&amp;lt;/font&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;b&amp;gt;&amp;lt;font style=&amp;quot;font-size: 15px;&amp;quot;&amp;gt;the syscalls&amp;lt;/font&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&quot; style=&quot;text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-85&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;402.5&quot; y=&quot;154.38&quot; width=&quot;140&quot; height=&quot;90&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-94&quot; value=&quot;&quot; style=&quot;verticalLabelPosition=bottom;verticalAlign=top;html=1;shape=mxgraph.basic.tick;fillColor=#d5e8d4;strokeColor=#82b366;&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-85&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;120&quot; y=&quot;28.75&quot; width=&quot;27.5&quot; height=&quot;32.5&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;UserObject label=&quot;SSNs are version-dependant. Look for Hell&amp;#39;s Gate method.&amp;#xa;Atypical behaviour of the syscall instructions since they execute &amp;#xa;outside of the ntdll.dll. &amp;#xa;The return address after the syscall points back to non-standard&amp;#xa;memory region.&quot; id=&quot;tEqawAXD5UkgbRX-SCwM-95&quot;&gt;&#10;          &lt;mxCell style=&quot;text;whiteSpace=wrap;fontSize=16;&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-85&quot; vertex=&quot;1&quot;&gt;&#10;            &lt;mxGeometry x=&quot;107.5&quot; y=&quot;240&quot; width=&quot;490&quot; height=&quot;100&quot; as=&quot;geometry&quot; /&gt;&#10;          &lt;/mxCell&gt;&#10;        &lt;/UserObject&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-96&quot; value=&quot;&quot; style=&quot;shape=mxgraph.mockup.markup.redX;fillColor=#ff0000;html=1;shadow=0;whiteSpace=wrap;strokeColor=none;&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-85&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;87.5&quot; y=&quot;303&quot; width=&quot;13.72&quot; height=&quot;17&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-97&quot; value=&quot;&quot; style=&quot;shape=mxgraph.mockup.markup.redX;fillColor=#ff0000;html=1;shadow=0;whiteSpace=wrap;strokeColor=none;&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-85&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;87.5&quot; y=&quot;270&quot; width=&quot;13.72&quot; height=&quot;17&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-98&quot; value=&quot;&quot; style=&quot;shape=mxgraph.mockup.markup.redX;fillColor=#ff0000;html=1;shadow=0;whiteSpace=wrap;strokeColor=none;&quot; parent=&quot;tEqawAXD5UkgbRX-SCwM-85&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;87.5&quot; y=&quot;244.38&quot; width=&quot;13.72&quot; height=&quot;17&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sD_lDuidbchsZRyquxOI-5&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 21px;&amp;quot;&amp;gt;&amp;lt;b&amp;gt;LSASS Dumping&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&quot; style=&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;&quot; vertex=&quot;1&quot; parent=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;210&quot; y=&quot;1283.73&quot; width=&quot;491.69&quot; height=&quot;53.74&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sD_lDuidbchsZRyquxOI-6&quot; value=&quot;&quot; style=&quot;shape=image;html=1;verticalAlign=top;verticalLabelPosition=bottom;labelBackgroundColor=#ffffff;imageAspect=0;aspect=fixed;image=https://cdn1.iconfinder.com/data/icons/ninja-things-1/720/ninja-background-128.png&quot; vertex=&quot;1&quot; parent=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;129.99999999999997&quot; y=&quot;1281.86&quot; width=&quot;57.47&quot; height=&quot;57.47&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sD_lDuidbchsZRyquxOI-21&quot; value=&quot;&quot; style=&quot;group&quot; vertex=&quot;1&quot; connectable=&quot;0&quot; parent=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;340&quot; y=&quot;1370&quot; width=&quot;188.53&quot; height=&quot;130&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sD_lDuidbchsZRyquxOI-15&quot; value=&quot;&quot; style=&quot;strokeWidth=2;html=1;shape=mxgraph.flowchart.database;whiteSpace=wrap;&quot; vertex=&quot;1&quot; parent=&quot;sD_lDuidbchsZRyquxOI-21&quot;&gt;&#10;          &lt;mxGeometry x=&quot;63.7675&quot; width=&quot;60.995&quot; height=&quot;82.72727272727273&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sD_lDuidbchsZRyquxOI-16&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 20px;&amp;quot;&amp;gt;&amp;lt;b style=&amp;quot;&amp;quot;&amp;gt;LSASS Process&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&quot; style=&quot;text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;&quot; vertex=&quot;1&quot; parent=&quot;sD_lDuidbchsZRyquxOI-21&quot;&gt;&#10;          &lt;mxGeometry y=&quot;82.72727272727273&quot; width=&quot;170&quot; height=&quot;40&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sD_lDuidbchsZRyquxOI-10&quot; value=&quot;&quot; style=&quot;curved=1;endArrow=classic;html=1;rounded=0;&quot; edge=&quot;1&quot; parent=&quot;1&quot; source=&quot;sD_lDuidbchsZRyquxOI-16&quot;&gt;&#10;          &lt;mxGeometry width=&quot;50&quot; height=&quot;50&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;572.1300000000001&quot; y=&quot;1550&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;200&quot; y=&quot;1610&quot; as=&quot;targetPoint&quot; /&gt;&#10;            &lt;Array as=&quot;points&quot;&gt;&#10;              &lt;mxPoint x=&quot;280&quot; y=&quot;1480&quot; /&gt;&#10;              &lt;mxPoint x=&quot;160&quot; y=&quot;1460&quot; /&gt;&#10;            &lt;/Array&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sD_lDuidbchsZRyquxOI-24&quot; value=&quot;&quot; style=&quot;curved=1;endArrow=classic;html=1;rounded=0;exitX=0.984;exitY=0.632;exitDx=0;exitDy=0;exitPerimeter=0;&quot; edge=&quot;1&quot; parent=&quot;1&quot; source=&quot;sD_lDuidbchsZRyquxOI-16&quot;&gt;&#10;          &lt;mxGeometry width=&quot;50&quot; height=&quot;50&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;680&quot; y=&quot;1600&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;670&quot; y=&quot;1620&quot; as=&quot;targetPoint&quot; /&gt;&#10;            &lt;Array as=&quot;points&quot;&gt;&#10;              &lt;mxPoint x=&quot;610&quot; y=&quot;1478&quot; /&gt;&#10;              &lt;mxPoint x=&quot;700&quot; y=&quot;1460&quot; /&gt;&#10;              &lt;mxPoint x=&quot;700&quot; y=&quot;1520&quot; /&gt;&#10;            &lt;/Array&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sD_lDuidbchsZRyquxOI-26&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 26px;&amp;quot;&amp;gt;MiniDumpWriteDump&amp;lt;/font&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font style=&amp;quot;font-size: 26px;&amp;quot;&amp;gt;+&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font style=&amp;quot;font-size: 26px;&amp;quot;&amp;gt;SeDebugPrivilege&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&quot; style=&quot;edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];&quot; vertex=&quot;1&quot; connectable=&quot;0&quot; parent=&quot;sD_lDuidbchsZRyquxOI-24&quot;&gt;&#10;          &lt;mxGeometry x=&quot;-0.1338&quot; y=&quot;2&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;-455&quot; y=&quot;64&quot; as=&quot;offset&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sD_lDuidbchsZRyquxOI-31&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 26px;&amp;quot;&amp;gt;PssCaptureSnapshot&amp;lt;/font&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font style=&amp;quot;font-size: 26px;&amp;quot;&amp;gt;+&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font style=&amp;quot;font-size: 26px;&amp;quot;&amp;gt;MiniDumpWriteDump&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&quot; style=&quot;edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];&quot; vertex=&quot;1&quot; connectable=&quot;0&quot; parent=&quot;sD_lDuidbchsZRyquxOI-24&quot;&gt;&#10;          &lt;mxGeometry x=&quot;0.202&quot; y=&quot;-5&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;-15&quot; y=&quot;49&quot; as=&quot;offset&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sD_lDuidbchsZRyquxOI-29&quot; value=&quot;&quot; style=&quot;whiteSpace=wrap;html=1;shape=mxgraph.basic.document&quot; vertex=&quot;1&quot; parent=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;166.61&quot; y=&quot;1630&quot; width=&quot;63.39&quot; height=&quot;80&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sD_lDuidbchsZRyquxOI-30&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 23px;&amp;quot;&amp;gt;&amp;amp;nbsp;Directly create a *.dmp file&amp;lt;/font&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font style=&amp;quot;font-size: 23px;&amp;quot;&amp;gt;saved on the disk containing&amp;amp;nbsp;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font style=&amp;quot;font-size: 23px;&amp;quot;&amp;gt;its content.&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&quot; style=&quot;text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;&quot; vertex=&quot;1&quot; parent=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;60.17999999999999&quot; y=&quot;1710&quot; width=&quot;320&quot; height=&quot;100&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sD_lDuidbchsZRyquxOI-32&quot; value=&quot;&quot; style=&quot;shape=datastore;whiteSpace=wrap;html=1;&quot; vertex=&quot;1&quot; parent=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;630&quot; y=&quot;1630&quot; width=&quot;64.87&quot; height=&quot;80&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sD_lDuidbchsZRyquxOI-33&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 23px;&amp;quot;&amp;gt;Create a read-only clone of the&amp;lt;/font&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font style=&amp;quot;font-size: 23px;&amp;quot;&amp;gt;&amp;amp;nbsp;lsass.exe and only then&amp;lt;/font&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font style=&amp;quot;font-size: 23px;&amp;quot;&amp;gt;dump its memory usinng&amp;amp;nbsp;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font style=&amp;quot;font-size: 23px;&amp;quot;&amp;gt;MiniDumpWriteDump&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&quot; style=&quot;text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;&quot; vertex=&quot;1&quot; parent=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;498.67&quot; y=&quot;1720&quot; width=&quot;340&quot; height=&quot;120&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sD_lDuidbchsZRyquxOI-34&quot; value=&quot;&quot; style=&quot;group&quot; vertex=&quot;1&quot; connectable=&quot;0&quot; parent=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;810&quot; y=&quot;720&quot; width=&quot;500&quot; height=&quot;398.28&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-99&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 21px;&amp;quot;&amp;gt;&amp;lt;b&amp;gt;Indirect Syscalls&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&quot; style=&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;&quot; parent=&quot;sD_lDuidbchsZRyquxOI-34&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;40&quot; width=&quot;440&quot; height=&quot;50.28&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-100&quot; value=&quot;&quot; style=&quot;shape=image;html=1;verticalAlign=top;verticalLabelPosition=bottom;labelBackgroundColor=#ffffff;imageAspect=0;aspect=fixed;image=https://cdn1.iconfinder.com/data/icons/ninja-things-1/720/ninja-background-128.png&quot; parent=&quot;sD_lDuidbchsZRyquxOI-34&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry y=&quot;7&quot; width=&quot;36.27906976744186&quot; height=&quot;36.27906976744186&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-101&quot; value=&quot;&quot; style=&quot;rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;&quot; parent=&quot;sD_lDuidbchsZRyquxOI-34&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;34.41999999999996&quot; y=&quot;70.27999999999997&quot; width=&quot;453.72&quot; height=&quot;328&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-102&quot; value=&quot;&amp;lt;div style=&amp;quot;text-align: left;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;&amp;lt;font style=&amp;quot;font-size: 20px;&amp;quot;&amp;gt;Instead of manually calling a syscall by its SSN&amp;amp;nbsp;&amp;lt;/font&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font style=&amp;quot;font-size: 20px;&amp;quot;&amp;gt;&amp;lt;font style=&amp;quot;&amp;quot;&amp;gt;within our payload we will&amp;amp;nbsp;&amp;lt;/font&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;&amp;lt;font style=&amp;quot;&amp;quot;&amp;gt;find the address of a&amp;lt;/font&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;&amp;lt;font style=&amp;quot;font-size: 20px;&amp;quot;&amp;gt;target syscall instruction residing within ntdll.dll&amp;amp;nbsp;&amp;lt;/font&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font style=&amp;quot;font-size: 20px;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;&amp;lt;font style=&amp;quot;&amp;quot;&amp;gt;and jump&amp;amp;nbsp;&amp;lt;/font&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;&amp;lt;font style=&amp;quot;&amp;quot;&amp;gt;to that instruction&amp;amp;nbsp;&amp;lt;/font&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&quot; style=&quot;text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;&quot; parent=&quot;sD_lDuidbchsZRyquxOI-34&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;35&quot; y=&quot;98.27999999999997&quot; width=&quot;450&quot; height=&quot;110&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-103&quot; value=&quot;&quot; style=&quot;verticalLabelPosition=bottom;verticalAlign=top;html=1;shape=mxgraph.basic.tick;fillColor=#d5e8d4;strokeColor=#82b366;&quot; parent=&quot;sD_lDuidbchsZRyquxOI-34&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;40&quot; y=&quot;228.27999999999997&quot; width=&quot;27.5&quot; height=&quot;32.5&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-104&quot; value=&quot;&amp;lt;b&amp;gt;&amp;lt;font style=&amp;quot;font-size: 16px;&amp;quot;&amp;gt;The return address will be in a normal and expected&amp;amp;nbsp;&amp;lt;/font&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;div style=&amp;quot;text-align: left;&amp;quot;&amp;gt;&amp;lt;b&amp;gt;&amp;lt;font style=&amp;quot;font-size: 16px;&amp;quot;&amp;gt;memory region.&amp;lt;/font&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&quot; style=&quot;text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;&quot; parent=&quot;sD_lDuidbchsZRyquxOI-34&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;68.13999999999999&quot; y=&quot;219.52999999999997&quot; width=&quot;420&quot; height=&quot;50&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-105&quot; value=&quot;&amp;lt;b&amp;gt;&amp;lt;font style=&amp;quot;font-size: 16px;&amp;quot;&amp;gt;Better in avoiding memory inspection and&amp;amp;nbsp;&amp;lt;/font&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;b style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;&amp;lt;font style=&amp;quot;font-size: 16px;&amp;quot;&amp;gt;call stack&amp;amp;nbsp;&amp;lt;/font&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;div&amp;gt;&amp;lt;b style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;&amp;lt;font style=&amp;quot;font-size: 16px;&amp;quot;&amp;gt;red flags.&amp;lt;/font&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;&quot; style=&quot;text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;&quot; parent=&quot;sD_lDuidbchsZRyquxOI-34&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;80&quot; y=&quot;269.53&quot; width=&quot;420&quot; height=&quot;50&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-106&quot; value=&quot;&quot; style=&quot;verticalLabelPosition=bottom;verticalAlign=top;html=1;shape=mxgraph.basic.tick;fillColor=#d5e8d4;strokeColor=#82b366;&quot; parent=&quot;sD_lDuidbchsZRyquxOI-34&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;40&quot; y=&quot;278.28&quot; width=&quot;27.5&quot; height=&quot;32.5&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-107&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 16px;&amp;quot;&amp;gt;&amp;lt;b style=&amp;quot;&amp;quot;&amp;gt;Isn&amp;#39;t that strong against ETW+ Kernel callbacks&amp;amp;nbsp;&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;div&amp;gt;&amp;lt;font style=&amp;quot;font-size: 16px;&amp;quot;&amp;gt;&amp;lt;b style=&amp;quot;&amp;quot;&amp;gt;protections.&amp;lt;/b&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&quot; style=&quot;text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;&quot; parent=&quot;sD_lDuidbchsZRyquxOI-34&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;80&quot; y=&quot;319.53&quot; width=&quot;390&quot; height=&quot;50&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;tEqawAXD5UkgbRX-SCwM-108&quot; value=&quot;&quot; style=&quot;shape=mxgraph.mockup.markup.redX;fillColor=#ff0000;html=1;shadow=0;whiteSpace=wrap;strokeColor=none;&quot; parent=&quot;sD_lDuidbchsZRyquxOI-34&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;40&quot; y=&quot;329.53&quot; width=&quot;33.6&quot; height=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sD_lDuidbchsZRyquxOI-36&quot; value=&quot;&amp;lt;font style=&amp;quot;font-size: 25px;&amp;quot;&amp;gt;The LSASS process is a critical Windows process since :&amp;amp;nbsp;&amp;lt;/font&amp;gt;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;font style=&amp;quot;font-size: 25px;&amp;quot;&amp;gt;- It caches passwords in memory.&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;font style=&amp;quot;font-size: 25px;&amp;quot;&amp;gt;- Creates access tokens.&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;font style=&amp;quot;font-size: 25px;&amp;quot;&amp;gt;- Enforces security policy.&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;font style=&amp;quot;font-size: 25px;&amp;quot;&amp;gt;- Writes to windows logs.&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;font-size: 25px;&amp;quot;&amp;gt;Dumping its memory could lead to obtaining very sensitive&amp;amp;nbsp;&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;font-size: 25px;&amp;quot;&amp;gt;data to be used later with offline tools like mimikataz.&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&quot; style=&quot;text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;&quot; vertex=&quot;1&quot; parent=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;110&quot; y=&quot;1840&quot; width=&quot;680&quot; height=&quot;220&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;      &lt;/root&gt;&#10;    &lt;/mxGraphModel&gt;&#10;  &lt;/diagram&gt;&#10;&lt;/mxfile&gt;&#10;"><defs/><g><g data-cell-id="0"><g data-cell-id="1"><g data-cell-id="sD_lDuidbchsZRyquxOI-37"><g><rect x="0" y="0" width="1400" height="2560" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="sD_lDuidbchsZRyquxOI-35"><g><rect x="60" y="1813.73" width="790" height="716.27" rx="107.44" ry="107.44" fill="#f8cecc" stroke="#b85450" pointer-events="all" style="fill: light-dark(rgb(248, 206, 204), rgb(81, 45, 43)); stroke: light-dark(rgb(184, 84, 80), rgb(215, 129, 126));"/></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-1"><g><rect x="143.75" y="160" width="126.25" height="870" fill="none" stroke="none" pointer-events="all"/><path d="M 143.75 160 M 270 160 L 270 1030 L 143.75 1030" fill="none" stroke="#000000" stroke-linecap="square" stroke-miterlimit="10" stroke-dasharray="8 8" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-2"><g><ellipse cx="479.18" cy="737.41" rx="140" ry="135.41" fill="#dae8fc" stroke="#6c8ebf" transform="rotate(-90,479.18,737.41)" pointer-events="all" style="fill: light-dark(rgb(218, 232, 252), rgb(29, 41, 59)); stroke: light-dark(rgb(108, 142, 191), rgb(92, 121, 163));"/></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-3"><g><rect x="116.61" y="490" width="110" height="30" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 108px; height: 1px; padding-top: 505px; margin-left: 118px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font style="font-size: 18px;">shell.exe</font></div></div></div></foreignObject><text x="172" y="509" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">shell.exe</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-4"><g><rect x="116.61" y="560" width="110" height="30" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 108px; height: 1px; padding-top: 575px; margin-left: 118px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font style="font-size: 18px;">kernel32.dll</font></div></div></div></foreignObject><text x="172" y="579" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">kernel32.dll</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-5"><g><rect x="116.61" y="630" width="110" height="30" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 108px; height: 1px; padding-top: 645px; margin-left: 118px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font style="font-size: 18px;">ntdll.dll</font></div></div></div></foreignObject><text x="172" y="649" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">ntdll.dll</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-6"><g><path d="M 171.61 520 L 171.61 553.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 171.61 558.88 L 168.11 551.88 L 171.61 553.63 L 175.11 551.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-7"><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 538px; margin-left: 173px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; background-color: #ffffff; "><div style="display: inline-block; font-size: 11px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; background-color: light-dark(#ffffff, var(--ge-dark-color, #121212)); white-space: nowrap; "><b>ReadProcessMemory</b></div></div></div></foreignObject><text x="173" y="541" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="11px" text-anchor="middle">ReadProcessMemory</text></switch></g></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-8"><g><path d="M 171.61 590 L 171.61 623.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 171.61 628.88 L 168.11 621.88 L 171.61 623.63 L 175.11 621.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-9"><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 612px; margin-left: 172px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; background-color: #ffffff; "><div style="display: inline-block; font-size: 11px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; background-color: light-dark(#ffffff, var(--ge-dark-color, #121212)); white-space: nowrap; "><b>NtReadVirtualMemory</b></div></div></div></foreignObject><text x="172" y="615" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="11px" text-anchor="middle">NtReadVirtualMemory</text></switch></g></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-10"><g><rect x="116.61" y="840" width="110" height="110" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 116.61 860 L 226.61 860" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 136.61 840 L 136.61 950" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-11"><g><path d="M 171.61 660 L 171.61 833.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 171.61 838.88 L 168.11 831.88 L 171.61 833.63 L 175.11 831.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-12"><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 800px; margin-left: 174px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; background-color: #ffffff; "><div style="display: inline-block; font-size: 11px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; background-color: light-dark(#ffffff, var(--ge-dark-color, #121212)); white-space: nowrap; "><b>Syscall</b></div></div></div></foreignObject><text x="174" y="803" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="11px" text-anchor="middle">Syscall</text></switch></g></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-13"><g><rect x="126.61" y="860" width="102.5" height="90" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 101px; height: 1px; padding-top: 905px; margin-left: 128px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Pointers <br />to the <br />corresponding <br />kernel<br />function</div></div></div></foreignObject><text x="178" y="909" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Pointers...</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-14"><g><rect x="84.92" y="980" width="173.39" height="30" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 171px; height: 1px; padding-top: 995px; margin-left: 86px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><b><font style="font-size: 14px;">Nt!NtReadVirtualMemory</font></b></div></div></div></foreignObject><text x="172" y="999" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Nt!NtReadVirtualMemory</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-15"><g><path d="M 171.61 950 L 171.61 973.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 171.61 978.88 L 168.11 971.88 L 171.61 973.63 L 175.11 971.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-16"><g><path d="M 38.33 1060 L 38 290" fill="none" stroke="#000000" stroke-width="2" stroke-miterlimit="10" stroke-dasharray="2 6" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-17"><g><path d="M 10 820 L 270 820" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-18"><g><rect x="-48.12" y="508.12" width="132.5" height="26.25" rx="3.94" ry="3.94" fill="#d5e8d4" stroke="#82b366" transform="rotate(-90,18.13,521.24)" pointer-events="all" style="fill: light-dark(rgb(213, 232, 212), rgb(31, 47, 30)); stroke: light-dark(rgb(130, 179, 102), rgb(68, 110, 44));"/></g><g><g transform="translate(-0.5 -0.5)rotate(-90 18.13000000000011 521.2449999999999)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 131px; height: 1px; padding-top: 521px; margin-left: -47px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font style="font-size: 14px;"><b>User-Mode</b></font></div></div></div></foreignObject><text x="18" y="525" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">User-Mode</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-19"><g><rect x="-41.87" y="901.88" width="116.25" height="22.5" rx="3.38" ry="3.38" fill="#f8cecc" stroke="#b85450" transform="rotate(-90,16.26,913.13)" pointer-events="all" style="fill: light-dark(rgb(248, 206, 204), rgb(81, 45, 43)); stroke: light-dark(rgb(184, 84, 80), rgb(215, 129, 126));"/></g><g><g transform="translate(-0.5 -0.5)rotate(-90 16.25500000000011 913.1300000000001)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 114px; height: 1px; padding-top: 913px; margin-left: -41px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font style="font-size: 14px;"><b>Kernel-mode</b></font></div></div></div></foreignObject><text x="16" y="917" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Kernel-mode</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-20"><g><rect x="139.11" y="840" width="90" height="20" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 88px; height: 1px; padding-top: 850px; margin-left: 140px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><b>Syscall Table</b></div></div></div></foreignObject><text x="184" y="854" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Syscall Table</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-21"><g><image x="59.68" y="729.5" width="83.57" height="60" xlink:href="data:image/png;base64,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" preserveAspectRatio="none"/></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-22"><g><rect x="43.75" y="700" width="110" height="30" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 715px; margin-left: 99px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: nowrap; "><b><u><font style="font-size: 14px;">Syscall stub</font></u></b></div></div></div></foreignObject><text x="99" y="719" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Syscall stub</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-23"><g><ellipse cx="75" cy="575" rx="35" ry="10" fill="#dae8fc" stroke="#6c8ebf" pointer-events="all" style="fill: light-dark(rgb(218, 232, 252), rgb(29, 41, 59)); stroke: light-dark(rgb(108, 142, 191), rgb(92, 121, 163));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 68px; height: 1px; padding-top: 575px; margin-left: 41px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><b>Win32 API</b></div></div></div></foreignObject><text x="75" y="579" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Win32 API</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-24"><g><ellipse cx="75" cy="640" rx="35" ry="10" fill="#dae8fc" stroke="#6c8ebf" pointer-events="all" style="fill: light-dark(rgb(218, 232, 252), rgb(29, 41, 59)); stroke: light-dark(rgb(108, 142, 191), rgb(92, 121, 163));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 68px; height: 1px; padding-top: 640px; margin-left: 41px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><b>NT API</b></div></div></div></foreignObject><text x="75" y="644" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">NT API</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-25"><g><rect x="40" y="670" width="98.76" height="10" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 97px; height: 1px; padding-top: 675px; margin-left: 41px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><b>Functions start with Nt or Zw</b></div></div></div></foreignObject><text x="89" y="679" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Functions start...</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-26"><g><rect x="126.61" y="460" width="90" height="30" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 475px; margin-left: 172px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: nowrap; "><font style="font-size: 15px;">User App</font></div></div></div></foreignObject><text x="172" y="479" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">User App</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-27"><g><rect x="419.18" y="680" width="120" height="40" rx="20" ry="20" fill="#dae8fc" stroke="#6c8ebf" pointer-events="all" style="fill: light-dark(rgb(218, 232, 252), rgb(29, 41, 59)); stroke: light-dark(rgb(108, 142, 191), rgb(92, 121, 163));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 114px; height: 1px; padding-top: 700px; margin-left: 422px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><span style="font-size: 18px;">EDR / AV</span></div></div></div></foreignObject><text x="479" y="704" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">EDR / AV</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-28"><g><path d="M 226.61 645 Q 236.61 645 322.89 672.5 Q 409.18 700 419.18 700" fill="none" stroke="#6c8ebf" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(108, 142, 191), rgb(92, 121, 163));"/></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-29"><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 673px; margin-left: 311px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; background-color: #ffffff; "><div style="display: inline-block; font-size: 11px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; background-color: light-dark(#ffffff, var(--ge-dark-color, #121212)); white-space: nowrap; "><font style="font-size: 17px;">Often Hooked<br />(inline hooking)</font></div></div></div></foreignObject><text x="311" y="676" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="11px" text-anchor="middle">Often Hooked...</text></switch></g></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-30"><g><rect x="427.45" y="760" width="90" height="90" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><rect x="429.45" y="762" width="86" height="86" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 84px; height: 1px; padding-top: 805px; margin-left: 430px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font style="font-size: 15px;">mov ...</font><div><font style="font-size: 15px;">.</font></div><div><font style="font-size: 15px;">.</font></div><div><font style="font-size: 15px;">.</font></div><div><font style="font-size: 15px;">ret</font></div></div></div></div></foreignObject><text x="472" y="809" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">mov ......</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-31"><g><rect x="387.45" y="730" width="170" height="30" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 745px; margin-left: 472px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: nowrap; "><font style="font-size: 16px;">Custom syscall stub</font></div></div></div></foreignObject><text x="472" y="749" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Custom syscall stub</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-32"><g><rect x="245" y="623.5" width="120" height="25" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><rect x="247" y="625.5" width="116" height="21" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 114px; height: 1px; padding-top: 636px; margin-left: 248px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font style="font-size: 16px;"><b>jmp edrFunc</b></font></div></div></div></foreignObject><text x="305" y="640" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">jmp edrFunc</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-33"><g><image x="450.36" y="601.5" width="56.64" height="68" xlink:href="https://app.diagrams.net/img/lib/azure2/other/Resource_Guard.svg"/></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-34"><g><image x="328.22" y="956.5" width="36.28" height="36.28" xlink:href="https://cdn1.iconfinder.com/data/icons/ninja-things-1/720/ninja-background-128.png" preserveAspectRatio="none"/></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-35"><g><path d="M 475.58 855.52 L 485.58 855.48 L 485.82 909.29 L 489.18 909.28 L 481 948.5 L 472.47 909.35 L 475.82 909.34 Z" fill="#f8cecc" stroke="#b85450" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(248, 206, 204), rgb(81, 45, 43)); stroke: light-dark(rgb(184, 84, 80), rgb(215, 129, 126));"/></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-36"><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 891px; margin-left: 488px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; background-color: #ffffff; "><div style="display: inline-block; font-size: 11px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; background-color: light-dark(#ffffff, var(--ge-dark-color, #121212)); white-space: nowrap; "><font style="font-size: 18px;">Solution</font></div></div></div></foreignObject><text x="488" y="894" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="11px" text-anchor="middle">Solution</text></switch></g></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-37"><g><rect x="375.46" y="950" width="302.55" height="50.28" rx="7.54" ry="7.54" fill="#f8cecc" stroke="#b85450" pointer-events="all" style="fill: light-dark(rgb(248, 206, 204), rgb(81, 45, 43)); stroke: light-dark(rgb(184, 84, 80), rgb(215, 129, 126));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 301px; height: 1px; padding-top: 975px; margin-left: 376px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font style="font-size: 21px;">Unhooking ntdll.dll by restoring the .text section </font></div></div></div></foreignObject><text x="527" y="979" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Unhooking ntdll.dll by restoring the .text section </text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-38"><g><rect x="300" y="1010" width="460" height="360" rx="54" ry="54" fill="#f8cecc" stroke="#b85450" pointer-events="all" style="fill: light-dark(rgb(248, 206, 204), rgb(81, 45, 43)); stroke: light-dark(rgb(184, 84, 80), rgb(215, 129, 126));"/></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-39"><g><rect x="313.65" y="1062" width="35.23" height="50" fill="none" stroke="none" pointer-events="all"/><path d="M 313.65 1063.26 C 313.75 1062.61 314.24 1062.1 314.87 1062 L 347.74 1062 C 348.42 1062.17 348.88 1062.8 348.86 1063.51 L 348.86 1092.58 C 346.61 1091.31 344.07 1090.69 341.51 1090.76 C 345.3 1086.42 346.19 1080.13 343.75 1074.85 C 341.31 1069.56 336.03 1066.32 330.37 1066.64 C 324.72 1066.96 319.81 1070.77 317.94 1076.3 C 316.07 1081.83 317.61 1087.98 321.83 1091.87 L 324.95 1088.55 C 326.01 1087.62 327.52 1087.49 328.71 1088.21 C 329.9 1088.94 330.52 1090.36 330.26 1091.77 L 328.65 1095.45 C 329.99 1095.66 331.35 1095.68 332.7 1095.5 L 332.7 1107.94 L 314.85 1107.94 C 314.3 1107.87 313.83 1107.48 313.65 1106.93 Z M 315.11 1064.52 C 315.25 1064.96 315.64 1065.25 316.09 1065.25 C 316.53 1065.25 316.93 1064.96 317.06 1064.52 C 317.2 1064.08 317.05 1063.61 316.69 1063.34 C 316.33 1063.07 315.85 1063.07 315.49 1063.34 C 315.13 1063.61 314.98 1064.08 315.11 1064.52 Z M 345.31 1064.52 C 345.44 1064.96 345.84 1065.25 346.28 1065.25 C 346.73 1065.25 347.12 1064.96 347.26 1064.52 C 347.39 1064.08 347.24 1063.61 346.88 1063.34 C 346.53 1063.07 346.04 1063.07 345.68 1063.34 C 345.33 1063.61 345.17 1064.08 345.31 1064.52 Z M 324.66 1082.25 C 324.21 1079.56 325.34 1076.85 327.55 1075.35 C 329.76 1073.85 332.61 1073.85 334.82 1075.35 C 337.03 1076.85 338.16 1079.56 337.71 1082.25 C 337.16 1085.53 334.41 1087.93 331.19 1087.93 C 327.96 1087.93 325.21 1085.53 324.66 1082.25 Z M 326.12 1082.2 C 326.6 1084.75 328.77 1086.6 331.28 1086.6 C 333.8 1086.6 335.96 1084.75 336.45 1082.2 C 336.85 1080.04 335.97 1077.85 334.2 1076.63 C 332.43 1075.41 330.13 1075.41 328.37 1076.63 C 326.6 1077.85 325.71 1080.04 326.12 1082.2 Z M 327.05 1081.39 C 326.93 1081.08 327.03 1080.72 327.29 1080.52 C 327.55 1080.32 327.91 1080.32 328.17 1080.52 C 328.43 1080.72 328.53 1081.08 328.41 1081.39 C 328.3 1081.69 328.03 1081.88 327.73 1081.88 C 327.43 1081.88 327.15 1081.69 327.05 1081.39 Z M 328.17 1078.87 C 327.96 1078.56 328.02 1078.14 328.29 1077.89 C 328.57 1077.64 328.98 1077.64 329.26 1077.89 C 329.53 1078.14 329.59 1078.56 329.38 1078.87 C 329.25 1079.09 329.02 1079.21 328.77 1079.21 C 328.53 1079.21 328.3 1079.09 328.17 1078.87 Z M 330.6 1077.72 C 330.45 1077.4 330.54 1077.02 330.8 1076.8 C 331.07 1076.58 331.45 1076.58 331.71 1076.8 C 331.98 1077.02 332.06 1077.4 331.92 1077.72 C 331.79 1077.98 331.54 1078.14 331.26 1078.14 C 330.98 1078.14 330.72 1077.98 330.6 1077.72 Z M 333.13 1078.72 C 333.02 1078.41 333.12 1078.05 333.38 1077.85 C 333.64 1077.65 333.99 1077.65 334.26 1077.85 C 334.52 1078.05 334.61 1078.41 334.5 1078.72 C 334.39 1079.02 334.12 1079.21 333.82 1079.21 C 333.51 1079.21 333.24 1079.02 333.13 1078.72 Z M 334.16 1081.39 C 334.01 1081.08 334.09 1080.69 334.36 1080.47 C 334.62 1080.25 335 1080.25 335.27 1080.47 C 335.54 1080.69 335.62 1081.08 335.47 1081.39 C 335.35 1081.65 335.09 1081.82 334.81 1081.82 C 334.53 1081.82 334.28 1081.65 334.16 1081.39 Z M 333.08 1083.96 C 332.97 1083.65 333.07 1083.29 333.33 1083.09 C 333.59 1082.88 333.95 1082.88 334.21 1083.09 C 334.47 1083.29 334.57 1083.65 334.45 1083.96 C 334.34 1084.25 334.07 1084.45 333.77 1084.45 C 333.46 1084.45 333.19 1084.25 333.08 1083.96 Z M 330.65 1085.12 C 330.5 1084.8 330.58 1084.42 330.85 1084.2 C 331.12 1083.98 331.5 1083.98 331.76 1084.2 C 332.03 1084.42 332.11 1084.8 331.96 1085.12 C 331.84 1085.38 331.59 1085.55 331.31 1085.55 C 331.03 1085.55 330.77 1085.38 330.65 1085.12 Z M 328.07 1083.96 C 327.95 1083.65 328.05 1083.29 328.31 1083.09 C 328.57 1082.88 328.93 1082.88 329.19 1083.09 C 329.45 1083.29 329.55 1083.65 329.43 1083.96 C 329.32 1084.25 329.05 1084.45 328.75 1084.45 C 328.45 1084.45 328.18 1084.25 328.07 1083.96 Z M 329.24 1081.49 C 329.05 1080.63 329.4 1079.73 330.11 1079.24 C 330.82 1078.74 331.75 1078.74 332.46 1079.24 C 333.17 1079.73 333.51 1080.63 333.33 1081.49 C 333.12 1082.49 332.27 1083.2 331.28 1083.2 C 330.3 1083.2 329.45 1082.49 329.24 1081.49 Z M 316.77 1098.87 C 315.76 1100.05 315.49 1101.71 316.05 1103.17 C 316.61 1104.62 317.92 1105.63 319.43 1105.77 C 320.94 1105.9 322.4 1105.14 323.2 1103.81 L 329.09 1091.57 C 329.23 1090.65 328.79 1089.75 328 1089.31 C 327.21 1088.88 326.24 1089.02 325.58 1089.65 Z M 318.08 1102.15 C 317.83 1101.36 318.09 1100.48 318.74 1099.99 C 319.4 1099.5 320.28 1099.5 320.93 1099.99 C 321.58 1100.48 321.85 1101.36 321.59 1102.15 C 321.34 1102.92 320.63 1103.45 319.84 1103.45 C 319.04 1103.45 318.34 1102.92 318.08 1102.15 Z M 334.84 1095.3 C 335.56 1093.96 338.42 1093.01 341.73 1093.01 C 345.04 1093.01 347.9 1093.96 348.62 1095.3 L 348.62 1109.1 C 348.62 1110.7 345.54 1112 341.73 1112 C 337.92 1112 334.84 1110.7 334.84 1109.1 Z M 336.79 1095.55 C 336.79 1096.45 338.99 1097.18 341.71 1097.18 C 344.42 1097.18 346.62 1096.45 346.62 1095.55 C 346.62 1094.65 344.42 1093.92 341.71 1093.92 C 338.99 1093.92 336.79 1094.65 336.79 1095.55 Z" fill="#00bef2" stroke="none" pointer-events="all" style="fill: light-dark(rgb(0, 190, 242), rgb(0, 137, 182));"/></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-40"><g><rect x="322.28" y="1152" width="230" height="50" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 1177px; margin-left: 437px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: nowrap; "><font style="font-size: 17px;">1- Retreive a Clean ntdll.dll</font><div><font style="font-size: 17px;"> file from Disk</font></div></div></div></div></foreignObject><text x="437" y="1181" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">1- Retreive a Clean ntdll.dll...</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-41"><g><path d="M 348.88 1087 L 376.98 1087" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 382.23 1087 L 375.23 1090.5 L 376.98 1087 L 375.23 1083.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-42"><g><path d="M 476.34 1040.57 L 476.34 1152 L 383.34 1152 L 383.34 1022 L 463.06 1022 Z" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 463.06 1022 C 464.14 1026.35 462.36 1030.82 458.31 1033.94 L 476.34 1040.97" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-43"><g><path d="M 383.34 1112 L 477.29 1112" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-44"><g><rect x="402.13" y="1112" width="80" height="40" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 1132px; margin-left: 442px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: nowrap; "><b>clean .text</b><div><b> section</b></div></div></div></div></foreignObject><text x="442" y="1136" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">clean .text...</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-45"><g><path d="M 388.1 1135.67 C 388.25 1135 388.63 1134.43 389.14 1134.12 C 389.65 1133.81 390.24 1133.78 390.77 1134.03 C 391.55 1134.49 392.14 1135.3 392.44 1136.29 C 393.82 1131.48 395.92 1127.03 398.62 1123.17 C 399.39 1122.31 400.46 1122 401.46 1122.35 C 401.71 1122.4 401.93 1122.6 402.03 1122.89 C 402.13 1123.19 402.11 1123.52 401.96 1123.78 C 398.28 1128.88 395.55 1134.9 393.95 1141.42 C 393 1142 391.89 1142 390.94 1141.42 C 390.23 1139.47 389.27 1137.67 388.1 1136.08 C 388.04 1135.96 388.04 1135.8 388.1 1135.67 Z" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-46"><g><path d="M 477.29 1092 Q 524.27 1092 514.87 1077 Q 505.48 1062 528.97 1067 Q 552.45 1072 557.15 1062 Q 561.85 1052 580.64 1067 Q 599.43 1082 613.52 1097 Q 627.61 1112 615.64 1145.99" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 613.89 1150.95 L 612.92 1143.18 L 615.64 1145.99 L 619.52 1145.51 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-47"><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 1106px; margin-left: 694px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; background-color: #ffffff; "><div style="display: inline-block; font-size: 11px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; background-color: light-dark(#ffffff, var(--ge-dark-color, #121212)); white-space: nowrap; "><div><div><br /></div></div></div></div></div></foreignObject><text x="694" y="1109" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="11px" text-anchor="middle">&#xa;</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-48"><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 1074px; margin-left: 626px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; background-color: #ffffff; "><div style="display: inline-block; font-size: 11px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; background-color: light-dark(#ffffff, var(--ge-dark-color, #121212)); white-space: nowrap; "><font style="font-size: 15px;"><b>2- Patch the .text section</b></font><div><span style="font-size: 15px;"><b>and <u>restore the modified protections</u><br /></b></span><div><br /></div></div></div></div></div></foreignObject><text x="626" y="1077" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="11px" text-anchor="middle">2- Patch the .text section...</text></switch></g></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-49"><g><rect x="561.85" y="1212" width="84.55" height="30" fill="none" stroke="none" pointer-events="all"/><path d="M 561.85 1212 L 561.85 1217.25 C 563.65 1217.43 565 1218.58 565 1219.94 C 565 1221.3 563.65 1222.44 561.85 1222.63 L 561.85 1235.61 L 567.54 1235.61 L 567.54 1242 L 601.15 1242 L 601.17 1241.41 C 601.17 1240.65 601.45 1240.08 601.9 1239.72 C 602.35 1239.34 603.01 1239.12 604.09 1239.12 C 605.2 1239.12 605.88 1239.39 606.37 1239.78 C 606.84 1240.19 607.1 1240.76 607.1 1241.4 L 607.1 1242 L 640.71 1242 L 640.71 1235.61 L 646.4 1235.61 L 646.4 1222.62 C 644.67 1222.37 643.42 1221.25 643.42 1219.94 C 643.42 1218.63 644.67 1217.51 646.4 1217.26 L 646.4 1212 Z" fill="#005f4b" stroke="none" pointer-events="all" style="fill: light-dark(rgb(0, 95, 75), rgb(110, 192, 174));"/><path d="M 569.13 1235.61 L 639.12 1235.61 L 639.12 1240.81 L 608.42 1240.81 C 608.29 1240.16 608.16 1239.51 607.57 1239 C 606.8 1238.34 605.58 1237.93 604.09 1237.93 C 602.69 1237.93 601.49 1238.28 600.73 1238.91 C 600.13 1239.4 599.98 1240.11 599.83 1240.81 L 569.13 1240.81 Z M 628.51 1220.59 L 628.51 1227.01 L 635.01 1227.01 L 635.01 1220.59 Z M 613.38 1220.59 L 613.38 1227.01 L 619.88 1227.01 L 619.88 1220.59 Z M 588.37 1220.59 L 588.37 1227.01 L 594.87 1227.01 L 594.87 1220.59 Z M 573.25 1220.59 L 573.25 1227.01 L 579.74 1227.01 L 579.74 1220.59 Z M 626.91 1219.4 L 636.6 1219.4 L 636.6 1228.2 L 626.91 1228.2 Z M 611.78 1219.4 L 621.48 1219.4 L 621.48 1228.2 L 611.78 1228.2 Z M 586.77 1219.4 L 596.47 1219.4 L 596.47 1228.2 L 586.77 1228.2 Z M 571.65 1219.4 L 581.34 1219.4 L 581.34 1228.2 L 571.65 1228.2 Z" fill="#ffffff" stroke="none" pointer-events="all" style="fill: light-dark(rgb(255, 255, 255), rgb(18, 18, 18));"/></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-50"><g><path d="M 627.33 1157.71 L 627.33 1192 L 599.43 1192 L 599.43 1152 L 623.34 1152 Z" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 623.34 1152 C 623.67 1153.34 623.13 1154.71 621.92 1155.67 L 627.33 1157.84" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-51"><g><rect x="514.87" y="1182" width="180" height="40" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 1202px; margin-left: 605px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: nowrap; "><font style="font-size: 18px;"><b>in-memory ntdll.dll</b></font></div></div></div></foreignObject><text x="605" y="1206" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">in-memory ntdll.dll</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-52"><g><image x="442.37" y="1261.5" width="48.26" height="57.94" xlink:href="https://app.diagrams.net/img/lib/azure2/other/Resource_Guard.svg"/></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-53"><g><rect x="418.53" y="1330" width="110" height="40" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 1350px; margin-left: 474px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: nowrap; "><font style="font-size: 20px;">EDR / AV</font></div></div></div></foreignObject><text x="474" y="1354" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">EDR / AV</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-54"><g><path d="M 497.71 1301.29 Q 580.64 1292 596.54 1247.99" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 492.5 1301.88 L 499.06 1297.62 L 497.71 1301.29 L 499.84 1304.57 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 598.33 1243.05 L 599.24 1250.82 L 596.54 1247.99 L 592.65 1248.45 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-55"><g><image x="471.37" y="196.78" width="43" height="43" xlink:href="https://cdn1.iconfinder.com/data/icons/ninja-things-1/720/ninja-background-128.png" preserveAspectRatio="none"/></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-56"><g><rect x="517.45" y="193.64" width="560" height="50.28" rx="7.54" ry="7.54" fill="#f8cecc" stroke="#b85450" pointer-events="all" style="fill: light-dark(rgb(248, 206, 204), rgb(81, 45, 43)); stroke: light-dark(rgb(184, 84, 80), rgb(215, 129, 126));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 558px; height: 1px; padding-top: 219px; margin-left: 518px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font style="font-size: 21px;">Detecting hooked syscalls within ntdll.dll</font></div></div></div></foreignObject><text x="797" y="222" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Detecting hooked syscalls within ntdll.dll</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-57"><g><path d="M 226.61 630 Q 279.11 630 284.56 460 Q 290 290 467.24 368.05" fill="none" stroke="#b85450" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(184, 84, 80), rgb(215, 129, 126));"/><path d="M 472.05 370.16 L 464.23 370.55 L 467.24 368.05 L 467.05 364.14 Z" fill="#b85450" stroke="#b85450" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(184, 84, 80), rgb(215, 129, 126)); stroke: light-dark(rgb(184, 84, 80), rgb(215, 129, 126));"/></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-58"><g><path d="M 610.5 705 L 610.5 695 L 703.91 695 L 703.91 691.64 L 743.1 700 L 703.91 708.36 L 703.91 705 Z" fill="#f8cecc" stroke="#b85450" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(248, 206, 204), rgb(81, 45, 43)); stroke: light-dark(rgb(184, 84, 80), rgb(215, 129, 126));"/></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-59"><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 702px; margin-left: 665px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; background-color: #ffffff; "><div style="display: inline-block; font-size: 11px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; background-color: light-dark(#ffffff, var(--ge-dark-color, #121212)); white-space: nowrap; "><font style="font-size: 18px;">Solution</font></div></div></div></foreignObject><text x="665" y="705" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="11px" text-anchor="middle">Solution</text></switch></g></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-60"><g/><g data-cell-id="tEqawAXD5UkgbRX-SCwM-61"><g><rect x="477.29" y="248.4" width="602.71" height="281.6" rx="42.24" ry="42.24" fill="#f8cecc" stroke="#b85450" pointer-events="all" style="fill: light-dark(rgb(248, 206, 204), rgb(81, 45, 43)); stroke: light-dark(rgb(184, 84, 80), rgb(215, 129, 126));"/></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-62"><g><rect x="487.45" y="310" width="70" height="30" fill="none" stroke="none" pointer-events="all"/><path d="M 487.45 310 L 487.45 315.25 C 488.94 315.43 490.06 316.58 490.06 317.94 C 490.06 319.3 488.94 320.44 487.45 320.63 L 487.45 333.61 L 492.16 333.61 L 492.16 340 L 519.99 340 L 520.01 339.41 C 520.01 338.65 520.24 338.08 520.61 337.72 C 520.98 337.34 521.52 337.12 522.42 337.12 C 523.34 337.12 523.91 337.39 524.31 337.78 C 524.7 338.19 524.91 338.76 524.91 339.4 L 524.91 340 L 552.74 340 L 552.74 333.61 L 557.45 333.61 L 557.45 320.62 C 556.02 320.37 554.98 319.25 554.98 317.94 C 554.98 316.63 556.02 315.51 557.45 315.26 L 557.45 310 Z" fill="#005f4b" stroke="none" pointer-events="all" style="fill: light-dark(rgb(0, 95, 75), rgb(110, 192, 174));"/><path d="M 493.48 333.61 L 551.42 333.61 L 551.42 338.81 L 526 338.81 C 525.9 338.16 525.79 337.51 525.3 337 C 524.66 336.34 523.66 335.93 522.42 335.93 C 521.26 335.93 520.27 336.28 519.64 336.91 C 519.14 337.4 519.02 338.11 518.9 338.81 L 493.48 338.81 Z M 542.64 318.59 L 542.64 325.01 L 548.01 325.01 L 548.01 318.59 Z M 530.11 318.59 L 530.11 325.01 L 535.49 325.01 L 535.49 318.59 Z M 509.41 318.59 L 509.41 325.01 L 514.79 325.01 L 514.79 318.59 Z M 496.89 318.59 L 496.89 325.01 L 502.26 325.01 L 502.26 318.59 Z M 541.31 317.4 L 549.34 317.4 L 549.34 326.2 L 541.31 326.2 Z M 528.79 317.4 L 536.82 317.4 L 536.82 326.2 L 528.79 326.2 Z M 508.08 317.4 L 516.11 317.4 L 516.11 326.2 L 508.08 326.2 Z M 495.56 317.4 L 503.59 317.4 L 503.59 326.2 L 495.56 326.2 Z" fill="#ffffff" stroke="none" pointer-events="all" style="fill: light-dark(rgb(255, 255, 255), rgb(18, 18, 18));"/></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-63"><g><rect x="690" y="278" width="160" height="114" fill="#ffffff" stroke="none" pointer-events="none" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212));"/><path d="M 690 278 L 850 278 L 850 392 L 690 392 L 690 278" fill="none" stroke="#000000" stroke-linecap="square" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 690 293 L 850 293" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 690 320 L 850 320" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 690 342 L 850 342" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 690 362 L 850 362" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 690 377 L 850 377" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-64"><g/><g data-cell-id="tEqawAXD5UkgbRX-SCwM-65"><g><rect x="690" y="278" width="160" height="15" fill="none" stroke="none" pointer-events="all"/><path d="M 690 278 M 850 278 M 850 293 M 690 293" fill="none" stroke="#000000" stroke-linecap="square" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 158px; height: 1px; padding-top: 286px; margin-left: 691px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; max-height: 11px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Nt*...</div></div></div></foreignObject><text x="770" y="289" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Nt*...</text></switch></g></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-66"><g/><g data-cell-id="tEqawAXD5UkgbRX-SCwM-67"><g><rect x="690" y="293" width="160" height="27" fill="none" stroke="none" pointer-events="all"/><path d="M 690 293 M 850 293 M 850 320 M 690 320" fill="none" stroke="#000000" stroke-linecap="square" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 158px; height: 1px; padding-top: 307px; margin-left: 691px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; max-height: 23px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Nt*...</div></div></div></foreignObject><text x="770" y="310" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Nt*...</text></switch></g></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-68"><g/><g data-cell-id="tEqawAXD5UkgbRX-SCwM-69"><g><rect x="690" y="320" width="160" height="22" fill="none" stroke="none" pointer-events="all"/><path d="M 690 320 M 850 320 M 850 342 M 690 342" fill="none" stroke="#000000" stroke-linecap="square" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 158px; height: 1px; padding-top: 331px; margin-left: 691px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; max-height: 18px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Zw*...</div></div></div></foreignObject><text x="770" y="335" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Zw*...</text></switch></g></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-70"><g/><g data-cell-id="tEqawAXD5UkgbRX-SCwM-71"><g><rect x="690" y="342" width="160" height="20" fill="none" stroke="none" pointer-events="all"/><path d="M 690 342 M 850 342 M 850 362 M 690 362" fill="none" stroke="#000000" stroke-linecap="square" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 158px; height: 1px; padding-top: 352px; margin-left: 691px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; max-height: 16px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Zw*...</div></div></div></foreignObject><text x="770" y="356" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Zw*...</text></switch></g></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-72"><g/><g data-cell-id="tEqawAXD5UkgbRX-SCwM-73"><g><rect x="690" y="362" width="160" height="15" fill="none" stroke="none" pointer-events="all"/><path d="M 690 362 M 850 362 M 850 377 M 690 377" fill="none" stroke="#000000" stroke-linecap="square" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 158px; height: 1px; padding-top: 370px; margin-left: 691px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; max-height: 11px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Nt*...</div></div></div></foreignObject><text x="770" y="373" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Nt*...</text></switch></g></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-74"><g/><g data-cell-id="tEqawAXD5UkgbRX-SCwM-75"><g><rect x="690" y="377" width="160" height="15" fill="none" stroke="none" pointer-events="all"/><path d="M 690 377 M 850 377 M 850 392 M 690 392" fill="none" stroke="#000000" stroke-linecap="square" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 158px; height: 1px; padding-top: 385px; margin-left: 691px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; max-height: 11px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">...</div></div></div></foreignObject><text x="770" y="388" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">...</text></switch></g></g></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-76"><g><path d="M 557.45 321.14 Q 557.45 321.14 683.67 307.2" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 688.89 306.62 L 682.32 310.87 L 683.67 307.2 L 681.55 303.91 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-77"><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 312px; margin-left: 622px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; background-color: #ffffff; "><div style="display: inline-block; font-size: 11px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; background-color: light-dark(#ffffff, var(--ge-dark-color, #121212)); white-space: nowrap; "><font style="font-size: 16px;">Load ntdll.dll </font><div><font style="font-size: 16px;">export table</font></div></div></div></div></foreignObject><text x="622" y="315" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="11px" text-anchor="middle">Load ntdll.dll...</text></switch></g></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-78"><g><path d="M 870 275 L 865 275 Q 860 275 860 285 L 860 325 Q 860 335 855 335 L 852.5 335 Q 850 335 855 335 L 857.5 335 Q 860 335 860 345 L 860 385 Q 860 395 865 395 L 870 395" fill="none" stroke="#000000" stroke-miterlimit="10" transform="translate(860,0)scale(-1,1)translate(-860,0)" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-79"><g><rect x="870" y="340" width="210" height="30" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 208px; height: 1px; padding-top: 355px; margin-left: 871px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font style="font-size: 16px;"><b>Loop through the Nt* and Zw* functions</b></font><div><font style="font-size: 16px;"><b>and check their syscalls stubs if they start with a redirection</b></font></div></div></div></div></foreignObject><text x="975" y="359" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Loop through the Nt* and Zw* functi...</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-80"><g><rect x="519.53" y="410" width="490.47" height="110" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 488px; height: 1px; padding-top: 465px; margin-left: 521px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><ul><li><font style="font-size: 17px;">Good before doing direct/indirect syscall.</font></li><li><font style="font-size: 17px;">Good to verify if an unhooking routine went correctly.</font></li><li><font style="font-size: 17px;">Not good against total API re-implementation.</font></li><li><font style="font-size: 17px;">Limited to inline hooking and not IAT and SSDT hooks.</font></li></ul></div></div></div></foreignObject><text x="765" y="469" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Good before doing direct/indirect syscall.Good to verify if an unhooking routine w...</text></switch></g></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-81"><g><image x="789.5" y="623.22" width="36.28" height="36.28" xlink:href="https://cdn1.iconfinder.com/data/icons/ninja-things-1/720/ninja-background-128.png" preserveAspectRatio="none"/></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-82"><g><rect x="830" y="619.72" width="440" height="50.28" rx="7.54" ry="7.54" fill="#f8cecc" stroke="#b85450" pointer-events="all" style="fill: light-dark(rgb(248, 206, 204), rgb(81, 45, 43)); stroke: light-dark(rgb(184, 84, 80), rgb(215, 129, 126));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 438px; height: 1px; padding-top: 645px; margin-left: 831px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font style="font-size: 21px;"><b>Direct Syscalls</b></font></div></div></div></foreignObject><text x="1050" y="648" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Direct Syscalls</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-83"><g><path d="M 1044 1050.51 L 1054 1050.49 L 1054.1 1110.31 L 1057.46 1110.3 L 1049.17 1149.5 L 1040.75 1110.33 L 1044.1 1110.32 Z" fill="#f8cecc" stroke="#b85450" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(248, 206, 204), rgb(81, 45, 43)); stroke: light-dark(rgb(184, 84, 80), rgb(215, 129, 126));"/></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-84"><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 1078px; margin-left: 1066px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; background-color: #ffffff; "><div style="display: inline-block; font-size: 11px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; background-color: light-dark(#ffffff, var(--ge-dark-color, #121212)); white-space: nowrap; "><font style="font-size: 18px;">Solution</font></div></div></div></foreignObject><text x="1066" y="1081" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="11px" text-anchor="middle">Solution</text></switch></g></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-85"><g/><g data-cell-id="tEqawAXD5UkgbRX-SCwM-86"><g><rect x="790" y="680" width="490" height="360" rx="54" ry="54" fill="#f8cecc" stroke="#b85450" pointer-events="all" style="fill: light-dark(rgb(248, 206, 204), rgb(81, 45, 43)); stroke: light-dark(rgb(184, 84, 80), rgb(215, 129, 126));"/></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-87"><g><path d="M 1209.49 781.79 L 1209.49 837.5 L 1160 837.5 L 1160 772.5 L 1202.42 772.5 Z" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1202.42 772.5 C 1203 774.67 1202.05 776.91 1199.9 778.47 L 1209.49 781.98" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 48px; height: 1px; padding-top: 805px; margin-left: 1161px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font style="font-size: 17px;"><b>*.cpp</b></font></div></div></div></foreignObject><text x="1185" y="809" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">*.cpp</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-88"><g><path d="M 1049.49 781.79 L 1049.49 837.5 L 1000 837.5 L 1000 772.5 L 1042.42 772.5 Z" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1042.42 772.5 C 1043 774.67 1042.05 776.91 1039.9 778.47 L 1049.49 781.98" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 48px; height: 1px; padding-top: 805px; margin-left: 1001px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font style="font-size: 18px;"><b>*.h</b></font></div></div></div></foreignObject><text x="1025" y="809" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">*.h</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-89"><g><path d="M 879.49 781.79 L 879.49 837.5 L 830 837.5 L 830 772.5 L 872.42 772.5 Z" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 872.42 772.5 C 873 774.67 872.05 776.91 869.9 778.47 L 879.49 781.98" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 48px; height: 1px; padding-top: 805px; margin-left: 831px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font style="font-size: 18px;"><b>*.asm</b></font></div></div></div></foreignObject><text x="855" y="809" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">*.asm</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-90"><g><rect x="860" y="700" width="340" height="50" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 725px; margin-left: 1030px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: nowrap; "><font style="font-size: 17px;"><b>Avoid the hooked ntdll.dll and call </b></font><div><font style="font-size: 17px;"><b>the target syscall</b></font><b style="font-size: 17px; background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"> directly with its SSN.</b></div></div></div></div></foreignObject><text x="1030" y="729" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Avoid the hooked ntdll.dll and call...</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-91"><g><rect x="780" y="830" width="160" height="90" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 875px; margin-left: 860px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: nowrap; "><b><font style="font-size: 15px;">Syscall stub that <br />prepares the </font></b><div><b style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><font style="font-size: 15px;"> parameters in the </font></b><div><b><font style="font-size: 15px;">correct registers</font></b></div></div></div></div></div></foreignObject><text x="860" y="879" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Syscall stub that...</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-92"><g><rect x="940" y="840" width="170" height="70" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 875px; margin-left: 1025px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: nowrap; "><b><font style="font-size: 15px;">Header file with the </font></b><div><div><b><font style="font-size: 15px;">external function </font></b></div><div><b><font style="font-size: 15px;">declarations</font></b></div></div></div></div></div></foreignObject><text x="1025" y="879" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Header file with the...</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-93"><g><rect x="1115" y="834.38" width="140" height="90" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 879px; margin-left: 1185px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: nowrap; "><b><font style="font-size: 15px;">The code that </font></b><div><b><font style="font-size: 15px;">retrieves  </font></b><div><b><font style="font-size: 15px;">the SSN and call</font></b></div><div><b><font style="font-size: 15px;">the syscalls</font></b></div></div></div></div></div></foreignObject><text x="1185" y="883" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">The code that...</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-94"><g><path d="M 832.62 730.97 C 832.91 729.87 833.65 728.95 834.64 728.45 C 835.64 727.94 836.8 727.89 837.83 728.31 C 839.34 729.05 840.5 730.37 841.09 731.97 C 843.78 724.16 847.87 716.93 853.14 710.65 C 854.64 709.25 856.74 708.75 858.68 709.31 C 859.18 709.39 859.6 709.73 859.8 710.2 C 860 710.68 859.95 711.22 859.66 711.65 C 852.49 719.93 847.15 729.71 844.02 740.3 C 842.18 741.25 840 741.25 838.16 740.3 C 836.76 737.14 834.89 734.21 832.62 731.64 C 832.5 731.43 832.5 731.18 832.62 730.97 Z" fill="#d5e8d4" stroke="#82b366" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(213, 232, 212), rgb(31, 47, 30)); stroke: light-dark(rgb(130, 179, 102), rgb(68, 110, 44));"/></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-95"><g><rect x="820" y="920" width="490" height="100" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 488px; height: 1px; padding-top: 927px; margin-left: 822px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 16px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">SSNs are version-dependant. Look for Hell's Gate method.<br />Atypical behaviour of the syscall instructions since they execute <br />outside of the ntdll.dll. <br />The return address after the syscall points back to non-standard<br />memory region.</div></div></div></foreignObject><text x="822" y="943" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="16px">SSNs are version-dependant. Look for Hell's Gate method....</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-96"><g><path d="M 801.37 983 L 806.86 989.8 L 812.35 983 L 813.72 984.7 L 808.23 991.5 L 813.72 998.3 L 812.35 1000 L 806.86 993.2 L 801.37 1000 L 800 998.3 L 805.49 991.5 L 800 984.7 Z" fill="#ff0000" stroke="none" pointer-events="all" style="fill: light-dark(rgb(255, 0, 0), rgb(255, 144, 144));"/></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-97"><g><path d="M 801.37 950 L 806.86 956.8 L 812.35 950 L 813.72 951.7 L 808.23 958.5 L 813.72 965.3 L 812.35 967 L 806.86 960.2 L 801.37 967 L 800 965.3 L 805.49 958.5 L 800 951.7 Z" fill="#ff0000" stroke="none" pointer-events="all" style="fill: light-dark(rgb(255, 0, 0), rgb(255, 144, 144));"/></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-98"><g><path d="M 801.37 924.38 L 806.86 931.18 L 812.35 924.38 L 813.72 926.08 L 808.23 932.88 L 813.72 939.68 L 812.35 941.38 L 806.86 934.58 L 801.37 941.38 L 800 939.68 L 805.49 932.88 L 800 926.08 Z" fill="#ff0000" stroke="none" pointer-events="all" style="fill: light-dark(rgb(255, 0, 0), rgb(255, 144, 144));"/></g></g></g><g data-cell-id="sD_lDuidbchsZRyquxOI-5"><g><rect x="210" y="1733.73" width="491.69" height="53.74" rx="8.06" ry="8.06" fill="#f8cecc" stroke="#b85450" pointer-events="all" style="fill: light-dark(rgb(248, 206, 204), rgb(81, 45, 43)); stroke: light-dark(rgb(184, 84, 80), rgb(215, 129, 126));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 490px; height: 1px; padding-top: 1761px; margin-left: 211px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font style="font-size: 21px;"><b>LSASS Dumping</b></font></div></div></div></foreignObject><text x="456" y="1764" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">LSASS Dumping</text></switch></g></g></g><g data-cell-id="sD_lDuidbchsZRyquxOI-6"><g><image x="129.5" y="1731.36" width="57.47" height="57.47" xlink:href="https://cdn1.iconfinder.com/data/icons/ninja-things-1/720/ninja-background-128.png" preserveAspectRatio="none"/></g></g><g data-cell-id="sD_lDuidbchsZRyquxOI-21"><g/><g data-cell-id="sD_lDuidbchsZRyquxOI-15"><g><path d="M 403.77 1888.94 L 403.77 1833.79 C 403.77 1826.17 417.42 1820 434.26 1820 C 451.11 1820 464.76 1826.17 464.76 1833.79 L 464.76 1888.94 C 464.76 1896.55 451.11 1902.73 434.26 1902.73 C 417.42 1902.73 403.77 1896.55 403.77 1888.94 Z" fill="#ffffff" stroke="#000000" stroke-width="2" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 403.77 1833.79 C 403.77 1841.4 417.42 1847.58 434.26 1847.58 C 451.11 1847.58 464.76 1841.4 464.76 1833.79" fill="none" stroke="#000000" stroke-width="2" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="sD_lDuidbchsZRyquxOI-16"><g><rect x="340" y="1902.73" width="170" height="40" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 1923px; margin-left: 425px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: nowrap; "><font style="font-size: 20px;"><b style="">LSASS Process</b></font></div></div></div></foreignObject><text x="425" y="1926" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">LSASS Process</text></switch></g></g></g></g><g data-cell-id="sD_lDuidbchsZRyquxOI-10"><g><path d="M 340 1926.99 Q 280 1930 220 1920 Q 160 1910 198.36 2053.85" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 199.71 2058.92 L 194.53 2053.06 L 198.36 2053.85 L 201.29 2051.25 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="sD_lDuidbchsZRyquxOI-24"><g><path d="M 507.28 1928.01 Q 610 1928 655 1919 Q 700 1910 700 1940 Q 700 1970 671.83 2063.9" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 670.32 2068.93 L 668.98 2061.22 L 671.83 2063.9 L 675.69 2063.23 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g data-cell-id="sD_lDuidbchsZRyquxOI-26"><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 1982px; margin-left: 209px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; background-color: #ffffff; "><div style="display: inline-block; font-size: 11px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; background-color: light-dark(#ffffff, var(--ge-dark-color, #121212)); white-space: nowrap; "><font style="font-size: 26px;">MiniDumpWriteDump</font><div><font style="font-size: 26px;">+</font></div><div><font style="font-size: 26px;">SeDebugPrivilege</font></div></div></div></div></foreignObject><text x="209" y="1985" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="11px" text-anchor="middle">MiniDumpWriteDump...</text></switch></g></g></g><g data-cell-id="sD_lDuidbchsZRyquxOI-31"><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 1982px; margin-left: 682px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; background-color: #ffffff; "><div style="display: inline-block; font-size: 11px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; background-color: light-dark(#ffffff, var(--ge-dark-color, #121212)); white-space: nowrap; "><font style="font-size: 26px;">PssCaptureSnapshot</font><div><font style="font-size: 26px;">+</font></div><div><font style="font-size: 26px;">MiniDumpWriteDump</font></div></div></div></div></foreignObject><text x="682" y="1986" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="11px" text-anchor="middle">PssCaptureSnapshot...</text></switch></g></g></g></g><g data-cell-id="sD_lDuidbchsZRyquxOI-29"><g><path d="M 229.36 2091.43 L 229.36 2160 L 166.61 2160 L 166.61 2080 L 220.4 2080 Z" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 220.4 2080 C 221.13 2082.67 219.92 2085.43 217.19 2087.35 L 229.36 2091.67" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="sD_lDuidbchsZRyquxOI-30"><g><rect x="60.18" y="2160" width="320" height="100" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 2210px; margin-left: 220px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: nowrap; "><font style="font-size: 23px;"> Directly create a *.dmp file</font><div><font style="font-size: 23px;">saved on the disk containing </font></div><div><font style="font-size: 23px;">its content.</font></div></div></div></div></foreignObject><text x="220" y="2214" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Directly create a *.dmp file...</text></switch></g></g></g><g data-cell-id="sD_lDuidbchsZRyquxOI-32"><g><path d="M 630 2090 C 630 2076.67 694.87 2076.67 694.87 2090 L 694.87 2150 C 694.87 2163.33 630 2163.33 630 2150 Z" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 630 2090 C 630 2100 694.87 2100 694.87 2090 M 630 2095 C 630 2105 694.87 2105 694.87 2095 M 630 2100 C 630 2110 694.87 2110 694.87 2100" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="sD_lDuidbchsZRyquxOI-33"><g><rect x="498.67" y="2170" width="340" height="120" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 2230px; margin-left: 669px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: nowrap; "><font style="font-size: 23px;">Create a read-only clone of the</font><div><font style="font-size: 23px;"> lsass.exe and only then</font><div><font style="font-size: 23px;">dump its memory usinng </font></div><div><font style="font-size: 23px;">MiniDumpWriteDump</font></div></div></div></div></div></foreignObject><text x="669" y="2234" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Create a read-only clone of the...</text></switch></g></g></g><g data-cell-id="sD_lDuidbchsZRyquxOI-34"><g/><g data-cell-id="tEqawAXD5UkgbRX-SCwM-99"><g><rect x="850" y="1170" width="440" height="50.28" rx="7.54" ry="7.54" fill="#f8cecc" stroke="#b85450" pointer-events="all" style="fill: light-dark(rgb(248, 206, 204), rgb(81, 45, 43)); stroke: light-dark(rgb(184, 84, 80), rgb(215, 129, 126));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 438px; height: 1px; padding-top: 1195px; margin-left: 851px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font style="font-size: 21px;"><b>Indirect Syscalls</b></font></div></div></div></foreignObject><text x="1070" y="1199" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Indirect Syscalls</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-100"><g><image x="809.5" y="1176.5" width="36.28" height="36.28" xlink:href="https://cdn1.iconfinder.com/data/icons/ninja-things-1/720/ninja-background-128.png" preserveAspectRatio="none"/></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-101"><g><rect x="844.42" y="1240.28" width="453.72" height="328" rx="49.2" ry="49.2" fill="#f8cecc" stroke="#b85450" pointer-events="all" style="fill: light-dark(rgb(248, 206, 204), rgb(81, 45, 43)); stroke: light-dark(rgb(184, 84, 80), rgb(215, 129, 126));"/></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-102"><g><rect x="845" y="1268.28" width="450" height="110" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 1323px; margin-left: 1070px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: nowrap; "><div style="text-align: left;"><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><font style="font-size: 20px;">Instead of manually calling a syscall by its SSN </font></span></div><div><font style="font-size: 20px;"><font style="">within our payload we will </font><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><font style="">find the address of a</font></span></font></div><div><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><font style="font-size: 20px;">target syscall instruction residing within ntdll.dll </font></span></div><div><font style="font-size: 20px;"><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><font style="">and jump </font></span><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><font style="">to that instruction </font></span></font></div></div></div></div></foreignObject><text x="1070" y="1327" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Instead of manually calling a syscall by its SSN...</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-103"><g><path d="M 850.12 1420.5 C 850.41 1419.4 851.15 1418.48 852.14 1417.98 C 853.14 1417.47 854.3 1417.42 855.33 1417.84 C 856.84 1418.58 858 1419.9 858.59 1421.5 C 861.28 1413.69 865.37 1406.46 870.64 1400.18 C 872.14 1398.78 874.24 1398.28 876.18 1398.84 C 876.68 1398.92 877.1 1399.26 877.3 1399.73 C 877.5 1400.21 877.45 1400.75 877.16 1401.18 C 869.99 1409.46 864.65 1419.24 861.52 1429.83 C 859.68 1430.78 857.5 1430.78 855.66 1429.83 C 854.26 1426.67 852.39 1423.74 850.12 1421.17 C 850 1420.96 850 1420.71 850.12 1420.5 Z" fill="#d5e8d4" stroke="#82b366" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(213, 232, 212), rgb(31, 47, 30)); stroke: light-dark(rgb(130, 179, 102), rgb(68, 110, 44));"/></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-104"><g><rect x="878.14" y="1389.53" width="420" height="50" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 1415px; margin-left: 1088px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: nowrap; "><b><font style="font-size: 16px;">The return address will be in a normal and expected </font></b><div style="text-align: left;"><b><font style="font-size: 16px;">memory region.</font></b></div></div></div></div></foreignObject><text x="1088" y="1418" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">The return address will be in a normal and expected...</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-105"><g><rect x="890" y="1439.53" width="420" height="50" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 1465px; margin-left: 892px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: nowrap; "><b><font style="font-size: 16px;">Better in avoiding memory inspection and </font></b><b style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><font style="font-size: 16px;">call stack </font></b><div><b style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><font style="font-size: 16px;">red flags.</font></b></div></div></div></div></foreignObject><text x="892" y="1468" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px">Better in avoiding memory inspection and call stack...</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-106"><g><path d="M 850.12 1470.5 C 850.41 1469.4 851.15 1468.48 852.14 1467.98 C 853.14 1467.47 854.3 1467.42 855.33 1467.84 C 856.84 1468.58 858 1469.9 858.59 1471.5 C 861.28 1463.69 865.37 1456.46 870.64 1450.18 C 872.14 1448.78 874.24 1448.28 876.18 1448.84 C 876.68 1448.92 877.1 1449.26 877.3 1449.73 C 877.5 1450.21 877.45 1450.75 877.16 1451.18 C 869.99 1459.46 864.65 1469.24 861.52 1479.83 C 859.68 1480.78 857.5 1480.78 855.66 1479.83 C 854.26 1476.67 852.39 1473.74 850.12 1471.17 C 850 1470.96 850 1470.71 850.12 1470.5 Z" fill="#d5e8d4" stroke="#82b366" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(213, 232, 212), rgb(31, 47, 30)); stroke: light-dark(rgb(130, 179, 102), rgb(68, 110, 44));"/></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-107"><g><rect x="890" y="1489.53" width="390" height="50" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 1515px; margin-left: 892px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: nowrap; "><font style="font-size: 16px;"><b style="">Isn't that strong against ETW+ Kernel callbacks </b></font><div><font style="font-size: 16px;"><b style="">protections.</b></font></div></div></div></div></foreignObject><text x="892" y="1518" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px">Isn't that strong against ETW+ Kernel callbacks...</text></switch></g></g></g><g data-cell-id="tEqawAXD5UkgbRX-SCwM-108"><g><path d="M 853.36 1499.53 L 866.8 1511.53 L 880.24 1499.53 L 883.6 1502.53 L 870.16 1514.53 L 883.6 1526.53 L 880.24 1529.53 L 866.8 1517.53 L 853.36 1529.53 L 850 1526.53 L 863.44 1514.53 L 850 1502.53 Z" fill="#ff0000" stroke="none" pointer-events="all" style="fill: light-dark(rgb(255, 0, 0), rgb(255, 144, 144));"/></g></g></g><g data-cell-id="sD_lDuidbchsZRyquxOI-36"><g><rect x="110" y="2290" width="680" height="220" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 2400px; margin-left: 112px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: nowrap; "><font style="font-size: 25px;">The LSASS process is a critical Windows process since : </font><div style=""><font style="font-size: 25px;">- It caches passwords in memory.</font></div><div style=""><font style="font-size: 25px;">- Creates access tokens.</font></div><div style=""><font style="font-size: 25px;">- Enforces security policy.</font></div><div style=""><font style="font-size: 25px;">- Writes to windows logs.</font></div><div style=""><span style="font-size: 25px;">Dumping its memory could lead to obtaining very sensitive </span></div><div style=""><span style="font-size: 25px;">data to be used later with offline tools like mimikataz.</span></div></div></div></div></foreignObject><text x="112" y="2404" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px">The LSASS process is a critical Windows process since :...</text></switch></g></g></g></g></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://www.drawio.com/doc/faq/svg-export-text-problems" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Text is not SVG - cannot display</text></a></switch></svg>